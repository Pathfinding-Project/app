{"version":3,"sources":["client/theme.tsx","components/generic/Flex.tsx","components/generic/Space.tsx","components/generic/Snackbar.tsx","slices/createSlice.tsx","client/RPCClient.ts","client/getClient.ts","slices/info.tsx","slices/specimen.tsx","components/script-editor/makeTemplate.tsx","components/script-editor/templates.tsx","slices/UIState.tsx","hooks/usePlaybackState.tsx","components/script-editor/call.tsx","components/specimen-renderer/default-renderer/DefaultRenderer.tsx","components/specimen-renderer/default-renderer/getDefaults.tsx","components/specimen-renderer/grid-renderer/parseMap.tsx","components/specimen-renderer/grid-renderer/getDefaults.tsx","components/specimen-renderer/grid-renderer/colors.tsx","components/specimen-renderer/grid-renderer/config.tsx","components/specimen-renderer/grid-renderer/makeGraphic.tsx","components/specimen-renderer/grid-renderer/Guides.tsx","components/specimen-renderer/grid-renderer/Node.tsx","components/specimen-renderer/grid-renderer/NodeList.tsx","components/specimen-renderer/grid-renderer/Overlay.tsx","components/specimen-renderer/grid-renderer/Path.tsx","components/specimen-renderer/grid-renderer/Selection.tsx","components/specimen-renderer/grid-renderer/selectionInfo.tsx","components/specimen-renderer/grid-renderer/PixiViewport.tsx","components/specimen-renderer/grid-renderer/Viewport.tsx","components/specimen-renderer/grid-renderer/GridRenderer.tsx","components/specimen-renderer/getRenderer.tsx","slices/loading.tsx","services/SpecimenService.tsx","slices/features.tsx","slices/SliceProvider.tsx","hooks/useSmallDisplay.tsx","components/generic/Select.tsx","components/control-bar/FeaturePicker.tsx","components/control-bar/InputControls.tsx","components/generic/IconButtonWithTooltip.tsx","components/control-bar/PlaybackControls.tsx","components/generic/Switch.tsx","components/generic/ListEditor.tsx","components/breakpoint-editor/comparators.tsx","components/breakpoint-editor/intrinsicProperties.tsx","components/breakpoint-editor/eventTypes.tsx","components/breakpoint-editor/BreakpointEditor.tsx","components/breakpoint-editor/propertyPaths.tsx","components/breakpoint-editor/BreakpointListEditor.tsx","components/script-editor/ScriptEditor.tsx","components/DebugOptionsEditor.tsx","components/generic/ScrollPanel.tsx","components/generic/Modal.tsx","hooks/useScrollState.tsx","components/control-bar/UtilityControls.tsx","components/control-bar/Controls.tsx","components/generic/LazyList.tsx","components/generic/Overline.tsx","components/generic/Property.tsx","components/specimen-inspector/EventInspector.tsx","components/specimen-inspector/EventListInspector.tsx","components/specimen-inspector/SelectionMenu.tsx","components/specimen-inspector/SpecimenInspector.tsx","components/Title.tsx","App.tsx","reportWebVitals.ts","index.tsx","services/ConnectionStateService.tsx","services/PlaybackService.tsx","hooks/useBreakpoints.tsx"],"names":["theme","createTheme","palette","primary","colors","shadows","times","Flex","vertical","props","Box","position","height","width","display","flexDirection","Space","px","SnackbarContext","createContext","noop","useSnackbar","useContext","SnackbarProvider","children","useState","snackPack","setSnackPack","open","setOpen","undefined","current","setCurrent","useEffect","length","prev","slice","handleMessage","useCallback","message","key","Date","getTime","handleClose","_","reason","Provider","value","Snackbar","autoHideDuration","onClose","TransitionProps","onExited","action","IconButton","color","sx","p","onClick","SnackbarLabel","secondary","opacity","defaultReducer","next","createSlice","initialState","initializer","reducer","Store","useReducer","dispatch","useMemo","then","RPCClient","options","rpc","socket","this","io","url","JSONRPCClient","request","a","listener","response","id","off","receive","emit","on","connect","disconnect","name","params","window","location","hostname","protocol","isLocalHost","getClient","once","fetch","json","servers","client","call","useInfo","InfoProvider","useSpecimen","SpecimenProvider","makeTypeString","returnType","join","map","type","makeComment","method","chunks","chunk","split","description","c","makeBody","defaultReturnValue","JSON","stringify","methods","templates","shouldRender","shouldBreak","code","values","m","useUIState","UIStateProvider","usePlaybackState","specimen","playback","step","setUIState","ready","playing","end","eventList","state","start","canPlay","canPause","canStop","canStepForward","canStepBackward","stepBy","n","clamp","callbacks","play","pause","stop","stepForward","stepBackward","tick","fn","memo","script","Function","DefaultRenderer","justifyContent","alignItems","mb","fontSize","getDefaults","parseMap","wall","h","w","d","last","grid","x","y","filter","flat","row","tile","variables","valid","node","find","range","i","floor","convert","hex","parseInt","replace","colorsHex","source","teal","destination","pink","expanding","deepOrange","tint","generating","yellow","closing","blueGrey","mapValues","getColor","orange","getColorHex","scale","devicePixelRatio","makeGraphic","draw","g","Grid","alpha","clear","lineStyle","forEach","moveTo","WEIGHT","lineTo","Guides","ceil","box","left","top","resolution","r","beginFill","drawRect","endFill","radius","drawCircle","f","Node","Square","defaultCondition","constant","NodeList","nodes","variant","condition","chain","keyBy","v","LazyNodeList","size","threshold","down","memoize","Overlay","Path","path","s","obj","out","push","pId","isUndefined","isNull","entries","Selected","animateScale","animateAlpha","t","useTween","Selection","hover","highlight","point","between","min","max","events","prop","event","PixiViewport","handler","e","global","data","input","clickedAvailable","world","toWorld","PixiViewportBase","applyProps","equal","apply","register","resize","Component","PixiComponent","create","viewport","interaction","app","renderer","plugins","ticker","stopPropagation","passiveWheel","drag","pinch","wheel","decelerate","friction","clampZoom","maxScale","minScale","Viewport","useApp","getPoint","renderers","onSelect","selection","ref","setRef","active","setActive","setHover","merge","bgNodes","bgNodeColor","handleClick","info","take","findLastIndex","entry","findIndex","index","selectionInfo","getBoundingClientRect","handleMouseEvent","timeout","clearTimeout","delay","cursor","backgroundColor","onMouseDown","onMouseOver","getGridDefaults","getRenderer","get","useLoading","LoadingProvider","getMap","content","solve","hash","encodeURIComponent","mapURI","algorithms","maps","useFeatures","FeaturesProvider","SliceProvider","slices","services","reduce","createElement","cloneElement","useSmallDisplay","useTheme","useMediaQuery","breakpoints","itemHeight","sm","Select","trigger","items","onChange","placeholder","Tooltip","title","bindTrigger","Menu","bindMenu","anchorOrigin","horizontal","transformOrigin","label","MenuItem","selected","close","SelectField","TextField","minWidth","select","target","item","FeaturePicker","startCase","Button","disabled","mapDefaults","InputControls","algorithm","IconButtonWithTooltip","icon","rest","PlaybackControls","Switch","FormControlLabel","control","defaultChecked","DefaultListEditorInput","forwardRef","InputBase","fullWidth","inputRef","ListEditorField","useSwitch","useDelete","useEdit","useEditButton","onChangeItem","onDeleteItem","enabled","element","extrasPlacement","autoFocus","style","cardStyle","field","setField","marginRight","spacing","marginTop","marginBottom","flexGrow","marginLeft","onDelete","onValueChange","edge","checked","focus","Card","borderColor","paddingRight","transition","transitions","Editor","addItemLabel","text","onAddItem","placeholderText","getCategory","getOrder","isInitialRender","useRef","useInitialRender","intermediateItems","setIntermediateItems","newIndex","setNewIndex","setTimeout","duration","standard","uniqBy","c2","render","Collapse","in","unmountOnExit","appear","mountOnEnter","sorted","sortBy","List","subheader","ListSubheader","disableSticky","Typography","gutterBottom","mt","arr","isNewCategory","some","pl","pb","pt","ml","disableElevation","startIcon","Add","ListEditor","editor","setState","handleChange","k","b","comparators","intrinsicProperties","eventTypes","BreakpointEditor","properties","Divider","flexItem","orientation","mx","textOverflow","whiteSpace","component","property","reference","inputProps","inputMode","pattern","propertyPaths","BreakpointListEditor","uniq","paths","nodeStructure","keys","overflow","debounce","ScriptEditor","loading","CircularProgress","language","defaultValue","minimap","DebugOptionsEditor","monotonicF","monotonicG","tab","setTab","renderHeading","TabContext","TabList","Tab","TabPanel","ScrollPanel","onTarget","onScroll","setTarget","addEventListener","passive","removeEventListener","PanelContext","AppBarTitle","ModalAppBar","elevatedStyle","transitionProperties","elevatedChildren","simple","panel","showControls","setShowControls","isAbsoluteTop","setIsAbsoluteTop","isTop","setIsTop","lastTop","newIsTop","scrollTop","Math","abs","useScrollState","styles","background","paper","boxShadow","AppBar","elevation","Toolbar","ArrowBack","gridColumn","gridRow","flex","Fade","Modal","actions","scrollable","setContent","contentRef","setContentRef","hasOverflowingChildren","setHasOverflowingChildren","childHeight","setChildHeight","callback","doesOverflow","innerHeight","offsetHeight","ob","ResizeSensor","detach","useVariant","Dialog","fullScreen","paddingTop","PaperProps","borderRadius","shape","default","maxWidth","ManagedModal","ModalProps","ModalAppBarProps","appBar","isOpen","UtilityControls","divider","Controls","LazyList","renderItem","listOptions","totalCount","itemContent","OverlineDot","transform","Overline","my","Property","mr","EventInspector","cardStyles","bgcolor","hidden","CardActionArea","flexWrap","EventListInspector","scrollToIndex","align","behavior","offset","SelectionMenu","notify","anchorReference","anchorPosition","ListItem","ListItemText","ListItemIcon","SpecimenInspector","mapType","setSelection","LinearProgress","zIndex","right","Title","App","reportWebVitals","onPerfEntry","getCLS","getFID","getFCP","getLCP","getTTFB","version","useRaf","result","isType","match","lower","error","useBreakpoints","renderLabel","cancelled","requestAnimationFrame","cancellable","trimEnd","setLoading","setSpecimen","useAsync","signal","defaults","solution","aborted","CssBaseline","ThemeProvider","document","getElementById"],"mappings":"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","file":"static/js/main.4297da45.chunk.js","sourcesContent":["import { colors, createTheme } from \"@material-ui/core\";\r\nimport { times } from \"lodash\";\r\n\r\nconst shadow = `\r\n    0px 8px 18px -1px rgb(0 0 0 / 8%), \r\n    0px 10px 48px 0px rgb(0 0 0 / 1%), \r\n    0px 20px 96px 0px rgb(0 0 0 / 0.5%)\r\n`;\r\n\r\nexport const theme = createTheme({\r\n  palette: {\r\n    primary: colors[\"blueGrey\"],\r\n  },\r\n  shadows: [\"\", ...times(24, () => shadow)] as any,\r\n});\r\n","import { Box, BoxProps } from \"@material-ui/core\";\r\n\r\nexport type FlexProps = {\r\n  vertical?: boolean;\r\n} & BoxProps;\r\n\r\nexport function Flex({ vertical, ...props }: FlexProps) {\r\n  return (\r\n    <Box\r\n      position=\"relative\"\r\n      height=\"100%\"\r\n      width=\"100%\"\r\n      display=\"flex\"\r\n      flexDirection={vertical ? \"column\" : \"row\"}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n","import { Box } from \"@material-ui/core\";\r\nimport { BoxProps } from \"@material-ui/system\";\r\n\r\nexport function Space(props: BoxProps) {\r\n  return <Box px={0.5} display=\"inline-block\" {...props} />;\r\n}\r\n","import { Box, IconButton, Snackbar } from \"@material-ui/core\";\r\nimport { CloseOutlined as CloseIcon } from \"@material-ui/icons\";\r\nimport { noop } from \"lodash\";\r\nimport {\r\n  createContext,\r\n  ReactNode,\r\n  useCallback,\r\n  useContext,\r\n  useEffect,\r\n  useState,\r\n} from \"react\";\r\nimport { Flex } from \"./Flex\";\r\nimport { Space } from \"./Space\";\r\n\r\nconst SnackbarContext = createContext<(message?: ReactNode) => void>(noop);\r\n\r\nexport interface SnackbarMessage {\r\n  message?: ReactNode;\r\n  key: number;\r\n}\r\n\r\nexport interface State {\r\n  open: boolean;\r\n  snackPack: readonly SnackbarMessage[];\r\n  messageInfo?: SnackbarMessage;\r\n}\r\n\r\nexport function useSnackbar() {\r\n  return useContext(SnackbarContext);\r\n}\r\n\r\nexport function SnackbarProvider({ children }: { children?: ReactNode }) {\r\n  const [snackPack, setSnackPack] = useState<readonly SnackbarMessage[]>([]);\r\n  const [open, setOpen] = useState(false);\r\n  const [current, setCurrent] = useState<SnackbarMessage | undefined>(\r\n    undefined\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (snackPack.length && !current) {\r\n      setCurrent({ ...snackPack[0] });\r\n      setSnackPack((prev) => prev.slice(1));\r\n      setOpen(true);\r\n    } else if (snackPack.length && current && open) {\r\n      setOpen(false);\r\n    }\r\n  }, [snackPack, current, open]);\r\n\r\n  const handleMessage = useCallback(\r\n    (message: ReactNode) => {\r\n      setSnackPack((prev) => [...prev, { message, key: new Date().getTime() }]);\r\n    },\r\n    [setSnackPack]\r\n  );\r\n\r\n  const handleClose = (_: any, reason?: string) => {\r\n    reason !== \"clickaway\" && setOpen(false);\r\n  };\r\n\r\n  const handleExited = () => setCurrent(undefined);\r\n\r\n  return (\r\n    <>\r\n      <SnackbarContext.Provider value={handleMessage}>\r\n        {children}\r\n      </SnackbarContext.Provider>\r\n      <Snackbar\r\n        key={current?.key}\r\n        open={open}\r\n        autoHideDuration={6000}\r\n        onClose={handleClose}\r\n        TransitionProps={{ onExited: handleExited }}\r\n        message={current?.message}\r\n        action={\r\n          <>\r\n            <IconButton\r\n              aria-label=\"close\"\r\n              color=\"inherit\"\r\n              sx={{ p: 0.5 }}\r\n              onClick={handleClose}\r\n            >\r\n              <CloseIcon />\r\n            </IconButton>\r\n          </>\r\n        }\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\ntype SnackbarLabelProps = {\r\n  primary?: ReactNode;\r\n  secondary?: ReactNode;\r\n};\r\n\r\nexport function SnackbarLabel({ primary, secondary }: SnackbarLabelProps) {\r\n  return (\r\n    <Flex>\r\n      <Box>{primary}</Box>\r\n      <Space />\r\n      <Box sx={{ opacity: 0.56 }}>{secondary}</Box>\r\n    </Flex>\r\n  );\r\n}\r\n","import { noop } from \"lodash\";\r\nimport {\r\n  createContext,\r\n  ReactNode,\r\n  useContext,\r\n  useEffect,\r\n  useMemo,\r\n  useReducer,\r\n} from \"react\";\r\n\r\ntype Slice<T, U = T> = [T, (next: U) => void];\r\n\r\ntype Reducer<T, U> = (prev: T, next: U) => T;\r\n\r\nconst defaultReducer = (_: any, next: any) => next;\r\n\r\nexport function createSlice<T, U = T>(\r\n  initialState: T,\r\n  initializer?: () => Promise<U>,\r\n  reducer: Reducer<T, U> = defaultReducer\r\n) {\r\n  const Store = createContext<Slice<T, U>>([initialState, noop]);\r\n  return [\r\n    // Hook\r\n    () => useContext(Store),\r\n    // Context\r\n    ({ children }: { children?: ReactNode }) => {\r\n      const [value, dispatch] = useReducer(reducer, initialState);\r\n      const slice = useMemo<Slice<T, U>>(\r\n        () => [value, dispatch],\r\n        [value, dispatch]\r\n      );\r\n      useEffect(() => void initializer?.().then?.(dispatch), [dispatch]);\r\n      return <Store.Provider value={slice}>{children}</Store.Provider>;\r\n    },\r\n  ] as const;\r\n}\r\n","import { JSONRPCClient, JSONRPCResponse as Response } from \"json-rpc-2.0\";\r\nimport { NameMethodMap } from \"protocol\";\r\nimport { Request, RequestOf, ResponseOf } from \"protocol/Message\";\r\nimport { io, Socket } from \"socket.io-client\";\r\n\r\nexport interface RPCClientOptions {\r\n  url: string;\r\n}\r\n\r\nexport class RPCClient {\r\n  rpc: JSONRPCClient;\r\n  socket: Socket;\r\n\r\n  constructor(readonly options: RPCClientOptions) {\r\n    this.socket = io(options.url);\r\n    this.rpc = new JSONRPCClient(async (request: Request) => {\r\n      const listener = (response: Response) => {\r\n        if (response.id === request.id) {\r\n          this.socket.off(\"response\", listener);\r\n          this.rpc.receive(response);\r\n        }\r\n      };\r\n      this.socket.emit(\"request\", request);\r\n      this.socket.on(\"response\", listener);\r\n    });\r\n  }\r\n\r\n  async connect() {\r\n    this.socket.connect();\r\n  }\r\n\r\n  async disconnect() {\r\n    this.socket.disconnect();\r\n  }\r\n\r\n  async call<T extends keyof NameMethodMap>(\r\n    name: T,\r\n    params?: RequestOf<NameMethodMap[T]>[\"params\"]\r\n  ): Promise<ResponseOf<NameMethodMap[T]>[\"result\"]> {\r\n    return await this.rpc.request(name, params);\r\n  }\r\n}\r\n","import { once } from \"lodash\";\r\nimport { RPCClient } from \"./RPCClient\";\r\n\r\nconst DEV_PORT = 8001;\r\n\r\nconst { hostname, protocol } = window.location;\r\nconst isLocalHost = hostname === \"localhost\";\r\n\r\nconst registry =\r\n  \"https://raw.githubusercontent.com/Pathfinding-Project/registry/master/index.json\";\r\n\r\ntype Registry = string[];\r\n\r\nexport const getClient = once(async () => {\r\n  if (isLocalHost) {\r\n    return new RPCClient({\r\n      url: `${protocol}//${hostname}:${DEV_PORT}/`,\r\n    });\r\n  } else {\r\n    const response = await fetch(registry);\r\n    const servers = (await response.json()) as Registry;\r\n    return new RPCClient({\r\n      url: servers[0],\r\n    });\r\n  }\r\n});\r\n","import { createSlice } from \"./createSlice\";\r\nimport { CheckConnectionResponse } from \"protocol/CheckConnection\";\r\nimport { getClient } from \"client/getClient\";\r\n\r\ntype Info = CheckConnectionResponse[\"result\"];\r\n\r\nexport const [useInfo, InfoProvider] = createSlice<Info | undefined>(\r\n  undefined,\r\n  async () => {\r\n    const client = await getClient();\r\n    return await client.call(\"about\");\r\n  }\r\n);\r\n","import { createSlice } from \"./createSlice\";\r\nimport { Trace } from \"protocol/Trace\";\r\nimport { PathfindingTask } from \"protocol/SolveTask\";\r\nimport { ParamsOf } from \"protocol/Message\";\r\n\r\ntype Specimen = {\r\n  specimen?: Trace;\r\n  map?: string;\r\n} & Partial<ParamsOf<PathfindingTask>>;\r\n\r\nexport const [useSpecimen, SpecimenProvider] = createSlice<Specimen>({});\r\n","import { chunk, join, map, split } from \"lodash\";\r\nimport { FunctionTemplate } from \"./FunctionTemplate\";\r\n\r\ntype GenericFunctionTemplate = FunctionTemplate<[...any], any>;\r\n\r\nfunction makeTypeString({ returnType, params }: GenericFunctionTemplate) {\r\n  return `@type {(${join(\r\n    map(params, (p) => `${p.name}: ${p.type}`),\r\n    \", \"\r\n  )}) => ${returnType}}`;\r\n}\r\n\r\nfunction makeComment(method: GenericFunctionTemplate) {\r\n  const [open, prefix, close] = [\"/**\", \" * \", \" */\"];\r\n  const chunks = map(chunk(split(method.description, \" \"), 9), (c) =>\r\n    join(c, \" \")\r\n  );\r\n  return join(\r\n    [\r\n      open,\r\n      ...map(chunks, (c) => `${prefix}${c}`),\r\n      `${prefix}${makeTypeString(method)}`,\r\n      close,\r\n    ],\r\n    \"\\n\"\r\n  );\r\n}\r\n\r\nfunction makeBody({\r\n  name,\r\n  params,\r\n  defaultReturnValue,\r\n}: GenericFunctionTemplate) {\r\n  return join(\r\n    [\r\n      `function ${name}(${join(map(params, \"name\"), \", \")}) {`,\r\n      `    return ${JSON.stringify(defaultReturnValue)};`,\r\n      `}`,\r\n    ],\r\n    \"\\n\"\r\n  );\r\n}\r\n\r\nexport function makeTemplate(methods?: GenericFunctionTemplate[]) {\r\n  return join(\r\n    map(methods, (m) => join([makeComment(m), makeBody(m)], \"\\n\")),\r\n    \"\\n\\n\"\r\n  );\r\n}\r\n","import { TraceEvent } from \"protocol/Trace\";\r\nimport { FunctionTemplate } from \"./FunctionTemplate\";\r\n\r\nexport type ShouldBreak = FunctionTemplate<\r\n  [number, TraceEvent, TraceEvent[]],\r\n  boolean\r\n>;\r\n\r\nexport const shouldBreak: ShouldBreak = {\r\n  name: \"shouldBreak\",\r\n  description:\r\n    \"Define in what situations the debugger should break, in addition to the conditions defined in the standard options.\",\r\n  params: [\r\n    { name: \"step\", type: \"number\" },\r\n    { name: \"event\", type: \"any\" },\r\n    { name: \"events\", type: \"any\" },\r\n  ],\r\n  defaultReturnValue: false,\r\n  returnType: \"boolean\",\r\n};\r\n\r\nexport type ShouldRender = FunctionTemplate<\r\n  [number, TraceEvent, TraceEvent[]],\r\n  boolean\r\n>;\r\n\r\nexport const shouldRender: ShouldRender = {\r\n  name: \"shouldRender\",\r\n  description: \"Define which objects the renderer should display.\",\r\n  params: [\r\n    { name: \"step\", type: \"number\" },\r\n    { name: \"event\", type: \"any\" },\r\n    { name: \"events\", type: \"any\" },\r\n  ],\r\n  defaultReturnValue: true,\r\n  returnType: \"boolean\",\r\n};\r\n\r\nexport const templates = {\r\n  shouldRender,\r\n  shouldBreak,\r\n};\r\n","import { makeTemplate } from \"components/script-editor/makeTemplate\";\r\nimport { templates } from \"components/script-editor/templates\";\r\nimport { values } from \"lodash\";\r\nimport { Feature } from \"protocol/FeatureQuery\";\r\nimport { TraceEventType } from \"protocol/Trace\";\r\nimport { createSlice } from \"./createSlice\";\r\n\r\nexport type PlaybackStateType = \"playing\" | \"paused\" | undefined;\r\n\r\ntype PlaybackState = { playback?: PlaybackStateType; step?: number };\r\n\r\ntype InputState = {\r\n  algorithm?: string;\r\n  map?: Partial<Feature & { type: string }>;\r\n};\r\n\r\nexport type Comparator = {\r\n  key: string;\r\n  apply: (value: number, reference: number) => boolean;\r\n};\r\n\r\nexport type Breakpoint = {\r\n  key: string;\r\n  property?: string;\r\n  reference?: number;\r\n  condition?: Comparator;\r\n  active?: boolean;\r\n  type?: TraceEventType;\r\n};\r\n\r\ntype DebugOptionsState = {\r\n  code?: string;\r\n  monotonicF?: boolean;\r\n  monotonicG?: boolean;\r\n  breakpoints?: Breakpoint[];\r\n};\r\n\r\ntype SpecimenState = {\r\n  start?: number;\r\n  end?: number;\r\n};\r\n\r\nexport type UIState = InputState &\r\n  PlaybackState &\r\n  DebugOptionsState &\r\n  SpecimenState;\r\n\r\nexport const [useUIState, UIStateProvider] = createSlice<\r\n  UIState,\r\n  Partial<UIState>\r\n>(\r\n  {\r\n    code: makeTemplate(values(templates)),\r\n  },\r\n  undefined,\r\n  (prev, next) => ({ ...prev, ...next })\r\n);\r\n","import { clamp } from \"lodash\";\r\nimport { useMemo } from \"react\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\n\r\nexport function usePlaybackState() {\r\n  const [{ specimen }] = useSpecimen();\r\n  const [{ playback, step = 0 }, setUIState] = useUIState();\r\n\r\n  const ready = !!specimen;\r\n  const playing = playback === \"playing\";\r\n  const [start, end] = [0, (specimen?.eventList?.length ?? 1) - 1];\r\n\r\n  return useMemo(() => {\r\n    const state = {\r\n      start,\r\n      end,\r\n      step,\r\n      canPlay: ready && !playing && step < end,\r\n      canPause: ready && playing,\r\n      canStop: ready,\r\n      canStepForward: ready && !playing && step < end,\r\n      canStepBackward: ready && !playing && step > 0,\r\n    };\r\n\r\n    const stepBy = (n: number) => clamp(step + n, start, end);\r\n\r\n    const callbacks = {\r\n      play: () => setUIState({ playback: \"playing\", step: stepBy(1) }),\r\n      pause: (n = 0) => setUIState({ playback: \"paused\", step: stepBy(n) }),\r\n      stop: () => setUIState({ step: start, playback: \"paused\" }),\r\n      stepForward: () => setUIState({ step: stepBy(1) }),\r\n      stepBackward: () => setUIState({ step: stepBy(-1) }),\r\n      tick: (n = 1) => setUIState({ playback: \"playing\", step: stepBy(n) }),\r\n    };\r\n\r\n    return {\r\n      playing: playback === \"playing\",\r\n      ...state,\r\n      ...callbacks,\r\n    };\r\n  }, [end, playback, playing, ready, setUIState, start, step]);\r\n}\r\n","import memo from \"memoizee\";\r\nimport { FunctionTemplate } from \"./FunctionTemplate\";\r\nimport { templates } from \"./templates\";\r\n\r\ntype TemplateMap = typeof templates;\r\n\r\ntype Key = keyof TemplateMap;\r\n\r\ntype ReturnTypeOf<T extends Key> = TemplateMap[T] extends FunctionTemplate<\r\n  [...any],\r\n  infer R\r\n>\r\n  ? R\r\n  : never;\r\n\r\ntype ParamsOf<T extends Key> = TemplateMap[T] extends FunctionTemplate<\r\n  infer R,\r\n  any\r\n>\r\n  ? R\r\n  : [];\r\n\r\nconst fn = memo(\r\n  (script: string, method: string) =>\r\n    new Function(\r\n      \"params\",\r\n      `${script}; return ${method}.apply(null, params);`\r\n    ) as (params: any[]) => any\r\n);\r\n\r\nexport function call<T extends Key>(\r\n  script: string,\r\n  method: T,\r\n  params: ParamsOf<T>\r\n): ReturnTypeOf<T> {\r\n  try {\r\n    return fn(script, method)(params);\r\n  } catch {\r\n    return templates[method].defaultReturnValue as ReturnTypeOf<T>;\r\n  }\r\n}\r\n","import { BlurOffOutlined as DisabledIcon } from \"@material-ui/icons\";\nimport { Flex } from \"components/generic/Flex\";\nimport { RendererProps } from \"components/specimen-renderer/Renderer\";\n\nexport function DefaultRenderer({ width, height }: RendererProps) {\n  return (\n    <Flex\n      {...{ width, height }}\n      justifyContent=\"center\"\n      alignItems=\"center\"\n      color=\"text.secondary\"\n      vertical\n    >\n      <DisabledIcon sx={{ mb: 2 }} fontSize=\"large\" />\n      No renderer is installed for the current map style.\n    </Flex>\n  );\n}\n","export const getDefaults = () => ({\n  start: 0,\n  end: 0,\n});\n","import { Point } from \"components/specimen-renderer/Renderer\";\nimport { filter, flatMap as flat, last, map, split } from \"lodash\";\nimport { TraceEvent } from \"protocol/Trace\";\n\nexport function parseMap(m: string = \"\", wall: string = \"@\") {\n  const [, h, w] = split(m, \"\\n\");\n  const [width, height] = map([w, h], (d) => +last(split(d, \" \"))!);\n  const grid = split(m, \"\\n\").slice(4);\n  return [\n    { x: width, y: height },\n    filter(\n      flat(grid, (row, y) =>\n        map(row, (tile, x) =>\n          tile === wall ? { variables: { x, y } } : undefined\n        )\n      )\n    ) as TraceEvent[],\n    ({ x, y }: Point) => grid[y]?.[x] !== wall,\n  ] as const;\n}\n","import { find, floor, range } from \"lodash\";\nimport { parseMap } from \"./parseMap\";\n\nexport function getDefaults(m: string = \"\", wall: string = \"@\") {\n  const [{ x: w, y: h }, , valid] = parseMap(m, wall);\n  const node =\n    find(range(w * h), (i) => valid({ x: i % w, y: floor(i / w) })) ?? 0;\n  return {\n    start: node,\n    end: node,\n  };\n}\n","import {\n  blueGrey,\n  deepOrange,\n  orange,\n  pink,\n  teal,\n  yellow,\n} from \"@material-ui/core/colors\";\nimport { mapValues } from \"lodash\";\nimport { TraceEventType } from \"protocol/Trace\";\n\nconst tint = \"500\";\n\nexport function convert(hex: string) {\n  return parseInt(hex.replace(\"#\", \"0x\"));\n}\n\nexport const colorsHex = {\n  source: teal[\"A400\"],\n  destination: pink[\"A400\"],\n  expanding: deepOrange[tint],\n  generating: yellow[tint],\n  closing: blueGrey[\"200\"],\n  end: pink[\"A400\"],\n};\n\nexport const colors: { [K in TraceEventType]: number } = mapValues(\n  colorsHex,\n  convert\n);\n\nexport function getColor(key?: TraceEventType) {\n  return (key && colors[key]) || convert(orange[tint]);\n}\n\nexport function getColorHex(key?: TraceEventType) {\n  return (key && colorsHex[key]) ?? orange[tint];\n}\n","export const scale = 10 * devicePixelRatio;\nexport const size = 1200;\n","import { Graphics } from \"@inlet/react-pixi\";\nimport { ComponentProps } from \"react\";\nimport { Graphics as PIXIGraphics } from \"@pixi/graphics\";\n\nexport function makeGraphic<T = any>(\n  draw: (g: PIXIGraphics, props: ComponentProps<typeof Graphics> & T) => void\n) {\n  return (props: ComponentProps<typeof Graphics> & T) => {\n    return <Graphics {...props} draw={(g) => draw(g, props)} />;\n  };\n}\n","import { ceil, forEach, range } from \"lodash\";\nimport { makeGraphic } from \"./makeGraphic\";\nimport { scale } from \"./config\";\nimport { ComponentProps } from \"react\";\n\nconst WEIGHT = 1;\n\nconst Grid = makeGraphic<{ alpha?: number; grid?: number }>(\n  (g, { width = 0, height = 0, alpha = 1, grid = 5 }) => {\n    g.clear();\n    g.lineStyle(WEIGHT, 0x000000, alpha);\n    forEach(range(scale * grid, height, scale * grid), (i) =>\n      g.moveTo(0, i + WEIGHT / 2).lineTo(width, i + WEIGHT / 2)\n    );\n    forEach(range(scale * grid, width, scale * grid), (i) =>\n      g.moveTo(i + WEIGHT / 2, 0).lineTo(i + WEIGHT / 2, height)\n    );\n  }\n);\n\ntype Props = ComponentProps<typeof Grid>;\n\nexport function Guides({\n  width = 0,\n  height = 0,\n  x = 0,\n  y = 0,\n  grid = 5,\n  ...params\n}: Props) {\n  return (\n    <Grid\n      width={ceil(width / grid) * grid * scale}\n      height={ceil(height / grid) * grid * scale}\n      grid={grid}\n      {...params}\n    />\n  );\n}\n","import { makeGraphic } from \"./makeGraphic\";\nimport { scale } from \"./config\";\nimport { Graphics } from \"@pixi/graphics\";\nimport { map } from \"lodash\";\n\nexport type NodeProps = {\n  color?: number;\n  left?: number;\n  top?: number;\n  radius?: number;\n  resolution?: number;\n};\n\nexport const node = (\n  g: Graphics,\n  { color, left = 0, top = 0, radius = 0.25, resolution: r = 1 }: NodeProps\n) =>\n  g\n    .beginFill(color ?? 0x000000)\n    .drawCircle(\n      r * (1.5 * scale + left),\n      r * (1.5 * scale + top),\n      r * radius * scale\n    )\n    .endFill();\n\nexport const square = (\n  g: Graphics,\n  { color, left = 0, top = 0, radius = 0.5, resolution: r = 1 }: NodeProps\n) =>\n  g\n    .beginFill(color ?? 0x000000)\n    .drawRect(\n      r * (scale + (radius * scale) / 2 + left),\n      r * (scale + (radius * scale) / 2 + top),\n      r * (radius * scale),\n      r * (radius * scale)\n    )\n    .endFill();\n\nexport const box = (\n  g: Graphics,\n  { color, left = 0, top = 0, resolution: r = 1 }: NodeProps\n) =>\n  g\n    .beginFill(color ?? 0x000000)\n    .drawRect(\n      r * (scale + left),\n      r * (scale + top),\n      r * (1 * scale),\n      r * (1 * scale)\n    )\n    .endFill();\n\nexport const [Node, Box, Square] = map([node, box, square], (f) =>\n  makeGraphic<NodeProps>((g, p) => {\n    g.clear();\n    f(g, p);\n  })\n);\n","import { Graphics } from \"@inlet/react-pixi\";\nimport { chain, constant, floor, memoize, slice } from \"lodash\";\nimport * as PIXI from \"pixi.js\";\nimport { Trace, TraceEventType } from \"protocol/Trace\";\nimport { useCallback, useMemo } from \"react\";\nimport { scale } from \"./config\";\nimport { box, NodeProps } from \"./Node\";\n\ntype Props = {\n  nodes: Trace[\"eventList\"];\n  color?: (type?: TraceEventType) => number;\n  variant?: (g: PIXI.Graphics, options: NodeProps) => PIXI.Graphics;\n  resolution?: number;\n  condition?: (step: number) => boolean;\n};\n\nconst defaultCondition = constant(true);\n\nexport function NodeList({\n  nodes,\n  color,\n  variant = box,\n  resolution = 1 / scale,\n  condition = defaultCondition,\n}: Props) {\n  const memo = useMemo(\n    () =>\n      chain(nodes)\n        .filter((_, i) => condition(i))\n        .keyBy(({ variables: v }) => `${v?.x ?? 0}::${v?.y ?? 0}`)\n        .values()\n        .value(),\n    [nodes, condition]\n  );\n  const draw = useCallback(\n    (g: PIXI.Graphics) => {\n      g.clear();\n      for (const { variables: v, type } of memo) {\n        variant(g, {\n          color: color?.(type) ?? 0xf6f6f6,\n          left: (v?.x ?? 0) * scale,\n          top: (v?.y ?? 0) * scale,\n          radius: 0.25,\n          resolution,\n        });\n      }\n      return g;\n    },\n    [memo, color, resolution, variant]\n  );\n  return <Graphics draw={draw} scale={1 / resolution} />;\n}\n\nconst down = (n: number, a: number = 1) => floor(n / a) * a;\n\nexport function LazyNodeList({\n  nodes,\n  step = 0,\n  size = 2500,\n  condition,\n  ...props\n}: {\n  step?: number;\n  size?: number;\n} & Props) {\n  const threshold = down(step, size);\n\n  const chunk = useCallback(\n    memoize((n: number) => slice(nodes, 0, n)),\n    [nodes]\n  );\n\n  const c = useCallback(\n    (n: number) => condition?.(n + threshold) ?? true,\n    [condition, threshold]\n  );\n\n  return (\n    <>\n      <NodeList {...props} nodes={chunk(threshold)} condition={condition} />\n      <NodeList\n        {...props}\n        nodes={slice(nodes, threshold, step + 1)}\n        condition={c}\n      />\n    </>\n  );\n}\n","import { Point } from \"components/specimen-renderer/Renderer\";\nimport { floor, map } from \"lodash\";\nimport { getColor } from \"./colors\";\nimport { scale } from \"./config\";\nimport { Square } from \"./Node\";\n\ntype OverlayProps = {\n  start?: number;\n  end?: number;\n  size?: Point;\n};\nexport function Overlay({\n  start = 0,\n  end = 0,\n  size = { x: 0, y: 0 },\n}: OverlayProps) {\n  return (\n    <>\n      {map(\n        [\n          { color: getColor(\"destination\"), node: end },\n          { color: getColor(\"source\"), node: start },\n        ],\n        ({ color, node }, i) => (\n          <Square\n            key={i}\n            x={scale * (node % size.x)}\n            y={scale * floor(node / size.x)}\n            color={color}\n          />\n        )\n      )}\n    </>\n  );\n}\n","import { Graphics } from \"@inlet/react-pixi\";\nimport { Graphics as PixiGraphics } from \"@pixi/graphics\";\nimport { isNull, isUndefined, keyBy } from \"lodash\";\nimport { TraceEvent } from \"protocol/Trace\";\nimport { useMemo } from \"react\";\nimport { getColor } from \"./colors\";\nimport { scale } from \"./config\";\nimport { Square } from \"./Node\";\n\nfunction defined<T>(obj: T): obj is Exclude<T, undefined | null> {\n  return !isUndefined(obj) && !isNull(obj);\n}\n\ntype PathProps = {\n  nodes?: TraceEvent[];\n  step?: number;\n};\n\nexport function Path({ nodes = [], step = 0 }: PathProps) {\n  const path = useMemo(() => {\n    const memo = keyBy(nodes, \"id\");\n    return (s: number) => {\n      const out = [];\n      let next: TraceEvent | undefined = nodes[s];\n      while (next) {\n        out.push(next);\n        next = defined(next.pId) ? memo[`${next.pId}`] : undefined;\n      }\n      return out;\n    };\n  }, [nodes]);\n\n  const draw = useMemo(() => {\n    const p = path(step);\n    return (g: PixiGraphics) => {\n      g.clear();\n      for (const [i, node] of p.entries()) {\n        const { x = 0, y = 0 } = node?.variables ?? {};\n        g.lineTo((x + 1.5) * scale, (y + 1.5) * scale);\n        if (!i) g.lineStyle(3, getColor(\"source\"));\n      }\n    };\n  }, [path, step]);\n\n  return (\n    <>\n      <Graphics draw={draw} />\n      <Square\n        x={scale * (nodes?.[step]?.variables?.x ?? 0)}\n        y={scale * (nodes?.[step]?.variables?.y ?? 0)}\n        color={getColor(\"source\")}\n      />\n    </>\n  );\n}\n","import { map } from \"lodash\";\nimport { Point } from \"components/specimen-renderer/Renderer\";\nimport { scale } from \"./config\";\nimport { useTween } from \"react-use\";\nimport { ComponentProps as PropsOf } from \"react\";\nimport { Node } from \"./Node\";\n\ntype SelectedProps = {\n  animateScale?: boolean;\n  animateAlpha?: boolean;\n} & PropsOf<typeof Node>;\n\ntype Props = {\n  hover?: Point;\n  highlight?: Point;\n};\n\nexport function Selected({\n  x = 0,\n  y = 0,\n  animateScale,\n  animateAlpha,\n  ...props\n}: SelectedProps) {\n  const t = useTween(\"outCirc\", 300);\n  return (\n    <Node\n      {...props}\n      scale={animateScale ? t : 1}\n      x={x + (animateScale ? 1.5 * scale - 1.5 * scale * t : 0)}\n      y={y + (animateScale ? 1.5 * scale - 1.5 * scale * t : 0)}\n      radius={1}\n      alpha={animateAlpha ? t : 1}\n    />\n  );\n}\n\nexport function Selection({ hover, highlight }: Props) {\n  return (\n    <>\n      {map(\n        [\n          { point: hover, color: 0xf9f9f9, animateAlpha: true },\n          { point: highlight, color: 0xf1f1f1, animateScale: true },\n        ],\n        ({ point, ...props }, i) =>\n          point && (\n            <Selected\n              key={`${i}::${point.x}::${point.y}`}\n              x={point.x * scale}\n              y={point.y * scale}\n              {...props}\n            />\n          )\n      )}\n    </>\n  );\n}\n","import { Point, SelectionInfo } from \"components/specimen-renderer/Renderer\";\nimport { findIndex, findLastIndex, take } from \"lodash\";\nimport { Trace } from \"protocol/Trace\";\nimport { parseMap } from \"./parseMap\";\n\nfunction between(v: number, min: number, max: number) {\n  return v >= min && v < max;\n}\n\nexport function selectionInfo(map: string = \"\", specimen: Trace = {}) {\n  const [{ x: w, y: h }, , valid] = parseMap(map);\n  return ({ x, y }: Point, step: number = 0) => {\n    const nodes = take(specimen?.eventList, step);\n    const node = findLastIndex(\n      nodes,\n      ({ variables: v }) => (v?.x ?? 0) === x && (v?.y ?? 0) === y\n    );\n    const entry = findIndex(\n      specimen?.eventList,\n      ({ variables: v, type }) =>\n        type === \"expanding\" && (v?.x ?? 0) === x && (v?.y ?? 0) === y\n    );\n    return {\n      current: node !== -1 ? { index: node, event: nodes[node] } : undefined,\n      entry: entry !== -1 ? { index: entry, event: nodes[entry] } : undefined,\n      node:\n        between(x, 0, w) && between(y, 0, h) && valid({ x, y })\n          ? { key: y * w + x }\n          : undefined,\n    } as SelectionInfo;\n  };\n}\n","import { find } from \"lodash\";\nimport { Viewport as PixiViewportBase } from \"pixi-viewport\";\nimport * as PIXI from \"pixi.js\";\n\nexport type ViewportEvent = {\n  global: PIXI.Point;\n  world: PIXI.Point;\n  event: PointerEvent;\n};\n\nexport type ViewportEventHandler = (e: ViewportEvent) => void;\n\nexport type PointerEvent = \"onMouseOver\" | \"onClick\" | \"onMouseDown\";\n\nexport type PropEventPair = {\n  prop: PointerEvent;\n  event: string;\n  filter?: boolean;\n};\n\nexport const events = [\n  { prop: \"onMouseOver\", event: \"mousemove\" },\n  { prop: \"onClick\", event: \"click\", filter: true },\n  { prop: \"onClick\", event: \"tap\", filter: true },\n  { prop: \"onMouseDown\", event: \"pointerdown\", filter: true },\n] as PropEventPair[];\n\nexport class PixiViewport extends PixiViewportBase {\n  events: {\n    [K in string]?: () => void;\n  } = {};\n  register(prop: PointerEvent, handler?: ViewportEventHandler) {\n    const { event, filter } = find(events, (c) => c.prop === prop)!;\n    this.events?.[event]?.();\n    if (handler) {\n      const f = (e: PIXI.InteractionEvent) => {\n        const { global } = e.data;\n        if (!filter || this.input.clickedAvailable) {\n          handler?.({\n            global,\n            world: this.toWorld(global),\n            event: prop,\n          });\n        }\n      };\n      this.on(event, f);\n      this.events[event] = () => this.off(event, f);\n    }\n  }\n}\n","/**\n * Adapted from https://codesandbox.io/s/react-pixi-viewport-9ngfd\n * @author roxgarage\n */\n\nimport { PixiComponent, useApp } from \"@inlet/react-pixi\";\nimport { map } from \"lodash\";\nimport * as PIXI from \"pixi.js\";\nimport React from \"react\";\nimport {\n  PointerEvent,\n  PixiViewport,\n  events,\n  ViewportEventHandler,\n} from \"./PixiViewport\";\n\nexport type ViewportProps = {\n  width?: number;\n  height?: number;\n  children?: React.ReactNode;\n  event?: PIXI.InteractionEvent;\n} & { [K in PointerEvent]?: ViewportEventHandler };\n\nexport type Props = {\n  app: PIXI.Application;\n} & ViewportProps;\n\nfunction create(props: Props) {\n  const viewport = new PixiViewport({\n    interaction: props.app.renderer.plugins.interaction,\n    ticker: props.app.ticker,\n    stopPropagation: true,\n    passiveWheel: false,\n  })\n    .drag()\n    .pinch()\n    .wheel()\n    .decelerate({ friction: 0.98 })\n    .clampZoom({ maxScale: 10, minScale: 0.02 });\n  return viewport as PixiViewport;\n}\n\nfunction applyProps(\n  v: PixiViewport,\n  prev: Props,\n  { width, height, ...next }: Props\n) {\n  for (const { equal, apply } of [\n    ...map(events, ({ prop }) => ({\n      equal: prev[prop] === next[prop],\n      apply: () => v.register(prop, next[prop]),\n    })),\n    {\n      prop: prev.width === width && prev.height === height,\n      apply: () => v.resize(width, height, (width ?? 0) * 2, (height ?? 0) * 2),\n    },\n  ]) {\n    !equal && apply();\n  }\n}\n\nconst Component = PixiComponent<Props, PixiViewport>(\"Viewport\", {\n  create: (props) => {\n    const viewport = create(props);\n    applyProps(viewport, props, props);\n    return viewport;\n  },\n  applyProps,\n});\n\nexport const Viewport = (props: ViewportProps) => {\n  const app = useApp();\n  return <Component app={app} {...props} />;\n};\n","import { Stage } from \"@inlet/react-pixi\";\nimport { Box } from \"@material-ui/core\";\nimport { blueGrey } from \"@material-ui/core/colors\";\nimport { call } from \"components/script-editor/call\";\nimport { Point, RendererProps } from \"components/specimen-renderer/Renderer\";\nimport { constant, delay, floor, memoize, merge, once } from \"lodash\";\nimport { ComponentProps, useMemo, useState } from \"react\";\nimport { useSpecimen } from \"slices/specimen\";\nimport { useUIState } from \"slices/UIState\";\nimport { convert, getColor } from \"./colors\";\nimport { scale } from \"./config\";\nimport { getDefaults } from \"./getDefaults\";\nimport { Guides } from \"./Guides\";\nimport { LazyNodeList as LazyNodes, NodeList as Nodes } from \"./NodeList\";\nimport { Overlay } from \"./Overlay\";\nimport { parseMap } from \"./parseMap\";\nimport { Path } from \"./Path\";\nimport { ViewportEvent } from \"./PixiViewport\";\nimport { Selection } from \"./Selection\";\nimport { selectionInfo } from \"./selectionInfo\";\nimport { Viewport } from \"./Viewport\";\n\ntype GridRendererProps = RendererProps &\n  Omit<ComponentProps<typeof Stage>, \"onSelect\">;\n\nfunction getPoint({ x, y }: Point) {\n  return { x: floor(x / scale) - 1, y: floor(y / scale) - 1 };\n}\n\nexport function GridRenderer({\n  onSelect,\n  selection,\n  ...props\n}: GridRendererProps) {\n  const [ref, setRef] = useState<HTMLDivElement | null>(null);\n  const { width = 0, height = 0 } = props;\n  const [{ specimen, map: m }] = useSpecimen();\n  const [{ step = 0, code, ...state }] = useUIState();\n\n  const [active, setActive] = useState<Point | undefined>(undefined);\n  const [hover, setHover] = useState<Point | undefined>(undefined);\n\n  const [[size, bgNodes], bgNodeColor, { start, end }] = useMemo(\n    () =>\n      [\n        parseMap(m),\n        once(() => convert(blueGrey[\"500\"])),\n        merge(getDefaults(m), { start: state.start, end: state.end }),\n      ] as const,\n    [m, state.start, state.end]\n  );\n\n  const handleClick = useMemo(() => {\n    const info = selectionInfo(m, specimen);\n    return ({ global, world }: ViewportEvent, step: number = 0) => {\n      if (ref && specimen) {\n        const { top, left } = ref.getBoundingClientRect();\n        const point = getPoint(world);\n        onSelect?.({\n          global: { x: left + global.x, y: top + global.y },\n          world: point,\n          info: info(point),\n        });\n      }\n    };\n  }, [ref, onSelect, specimen, m]);\n\n  const handleMouseEvent = useMemo(() => {\n    let timeout = 0;\n    return ({ world, event }: ViewportEvent) => {\n      switch (event) {\n        case \"onMouseOver\":\n          setHover(getPoint(world));\n          setActive(undefined);\n          clearTimeout(timeout);\n          break;\n        case \"onMouseDown\":\n          timeout = delay(() => setActive(getPoint(world)), 100);\n          break;\n      }\n    };\n  }, [setHover]);\n\n  const condition = useMemo(() => {\n    if (code && specimen?.eventList) {\n      return memoize((n: number) =>\n        code && specimen?.eventList\n          ? call(code ?? \"\", \"shouldRender\", [\n              n,\n              specimen.eventList[n],\n              specimen.eventList,\n            ])\n          : true\n      );\n    } else return constant(true);\n  }, [code, specimen?.eventList]);\n\n  return (\n    <Box sx={{ cursor: \"pointer\" }} ref={setRef}>\n      <Stage options={{ backgroundColor: 0xffffff }} {...props}>\n        <Viewport\n          width={width}\n          height={height}\n          onClick={(e) => handleClick(e, step)}\n          onMouseDown={handleMouseEvent}\n          onMouseOver={handleMouseEvent}\n        >\n          <Selection hover={hover} highlight={selection || active} />\n          <Nodes nodes={specimen?.eventList} />\n          <Nodes nodes={bgNodes} color={bgNodeColor} />\n          <LazyNodes\n            nodes={specimen?.eventList}\n            step={step}\n            color={getColor}\n            condition={condition}\n          />\n          <Overlay start={start} end={end} size={size} />\n          <Path nodes={specimen?.eventList} step={step} />\n          <Guides width={size.x} height={size.y} alpha={0.24} grid={1} />\n        </Viewport>\n      </Stage>\n    </Box>\n  );\n}\n","import { get } from \"lodash\";\nimport { DefaultRenderer } from \"./default-renderer/DefaultRenderer\";\nimport { getDefaults } from \"./default-renderer/getDefaults\";\nimport { getDefaults as getGridDefaults } from \"./grid-renderer/getDefaults\";\nimport { GridRenderer } from \"./grid-renderer/GridRenderer\";\nimport { RendererEntry, RendererMap } from \"./Renderer\";\n\nconst renderers: RendererMap = {\n  grid: [GridRenderer, getGridDefaults],\n};\n\nexport function getRenderer(key = \"\") {\n  return get(renderers, key, [DefaultRenderer, getDefaults] as RendererEntry);\n}\n","import { createSlice } from \"./createSlice\";\r\n\r\ntype Loading = {\r\n  specimen?: boolean;\r\n  map?: boolean;\r\n};\r\n\r\nexport const [useLoading, LoadingProvider] = createSlice<Loading>(\r\n  {},\r\n  undefined,\r\n  (prev, next) => ({\r\n    ...prev,\r\n    ...next,\r\n  })\r\n);\r\n","import { getClient } from \"client/getClient\";\r\nimport {\r\n  SnackbarLabel as Label,\r\n  useSnackbar,\r\n} from \"components/generic/Snackbar\";\r\nimport { getRenderer } from \"components/specimen-renderer/getRenderer\";\r\nimport { memoize as memo } from \"lodash\";\r\nimport { ParamsOf } from \"protocol/Message\";\r\nimport { PathfindingTask } from \"protocol/SolveTask\";\r\nimport { useAsyncAbortable as useAsync } from \"react-async-hook\";\r\nimport { useLoading } from \"slices/loading\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport hash from \"md5\";\r\n\r\nconst getMap = memo(async (map: string) => {\r\n  const client = await getClient();\r\n  return (await client.call(\"features/map\", { id: map }))?.content;\r\n});\r\n\r\nasync function solve(\r\n  map: string,\r\n  params: Omit<ParamsOf<PathfindingTask>, \"mapURI\">\r\n) {\r\n  const client = await getClient();\r\n  if (map) {\r\n    for (const mapURI of [\r\n      `hash:${hash(map)}`,\r\n      `map:${encodeURIComponent(map)}`,\r\n    ] as const) {\r\n      const p = { ...params, mapURI };\r\n      const specimen = await client.call(\"solve/pathfinding\", p);\r\n      if (specimen) return { ...p, specimen, map };\r\n    }\r\n  }\r\n}\r\n\r\nexport function SpecimenService() {\r\n  const notify = useSnackbar();\r\n  const [, setLoading] = useLoading();\r\n  const [, setSpecimen] = useSpecimen();\r\n  const [{ algorithm, map, start, end }, setUIState] = useUIState();\r\n\r\n  useAsync(\r\n    async (signal) => {\r\n      setLoading({ specimen: true });\r\n      if (algorithm && map?.id && map?.type) {\r\n        const m = await getMap(map.id);\r\n        if (m) {\r\n          const [, defaults] = getRenderer(map.type);\r\n          try {\r\n            const solution = await solve(m, {\r\n              algorithm,\r\n              end: end ?? defaults(m)?.end,\r\n              start: start ?? defaults(m)?.start,\r\n              mapType: map?.type,\r\n            });\r\n            if (solution && !signal.aborted) {\r\n              setSpecimen(solution);\r\n              setUIState({ step: 0, playback: \"paused\", breakpoints: [] });\r\n              notify(\r\n                <Label\r\n                  primary=\"Solution generated.\"\r\n                  secondary={`${solution.specimen.eventList?.length} steps`}\r\n                />\r\n              );\r\n            }\r\n          } catch (e) {\r\n            notify(`${e}`);\r\n          }\r\n        }\r\n      }\r\n      setLoading({ specimen: false });\r\n    },\r\n    [algorithm, start, end, map?.id, map?.type, getClient, setLoading, notify]\r\n  );\r\n\r\n  return <></>;\r\n}\r\n","import { getClient } from \"client/getClient\";\r\nimport { FeatureDescriptor } from \"protocol/FeatureQuery\";\r\nimport { createSlice } from \"./createSlice\";\r\n\r\ntype Features = {\r\n  algorithms: FeatureDescriptor[];\r\n  maps: (FeatureDescriptor & { type: string })[];\r\n};\r\n\r\nexport const [useFeatures, FeaturesProvider] = createSlice<Features>(\r\n  { algorithms: [], maps: [] },\r\n  async () => {\r\n    const client = await getClient();\r\n    return {\r\n      algorithms: (await client.call(\"features/algorithm\")) ?? [],\r\n      maps: (await client.call(\"features/maps\")) ?? [],\r\n    };\r\n  }\r\n);\r\n","import { map, reduce } from \"lodash\";\r\nimport {\r\n  cloneElement,\r\n  createElement,\r\n  FunctionComponent,\r\n  ReactNode,\r\n} from \"react\";\r\n\r\ntype SliceProviderProps = {\r\n  slices?: FunctionComponent[];\r\n  services?: FunctionComponent[];\r\n  children?: ReactNode;\r\n};\r\n\r\nexport function SliceProvider({\r\n  slices,\r\n  children,\r\n  services,\r\n}: SliceProviderProps) {\r\n  return (\r\n    <>\r\n      {reduce(\r\n        map(slices, (s) => createElement(s)),\r\n        (prev, next) => cloneElement(next, {}, prev),\r\n        <>\r\n          {children}\r\n          {map(services, (s, i) => createElement(s, { key: i }))}\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n","import { useMediaQuery, useTheme } from \"@material-ui/core\";\r\n\r\nexport function useSmallDisplay() {\r\n  const theme = useTheme();\r\n  return useMediaQuery(theme.breakpoints.down(\"sm\"));\r\n}\r\n","import {\r\n  Menu,\r\n  MenuItem,\r\n  TextField,\r\n  TextFieldProps,\r\n  Tooltip,\r\n} from \"@material-ui/core\";\r\nimport { useSmallDisplay } from \"hooks/useSmallDisplay\";\r\nimport { findIndex, map, max } from \"lodash\";\r\nimport State, { bindMenu, bindTrigger } from \"material-ui-popup-state\";\r\nimport { ReactElement, ReactNode } from \"react\";\r\n\r\ntype Key = string | number;\r\n\r\nexport type SelectProps<T extends Key> = {\r\n  trigger?: (props: ReturnType<typeof bindTrigger>) => ReactElement;\r\n  items?: { value: T; label?: ReactNode }[];\r\n  value?: T;\r\n  onChange?: (value: T) => void;\r\n  placeholder?: string;\r\n};\r\n\r\nconst itemHeight = (sm: boolean) => (sm ? 48 : 36);\r\nconst padding = 8;\r\n\r\nexport function Select<T extends string>({\r\n  trigger,\r\n  items,\r\n  value,\r\n  onChange,\r\n  placeholder = \"Select Option\",\r\n}: SelectProps<T>) {\r\n  const sm = useSmallDisplay();\r\n  const index = max([findIndex(items, { value: value as any }), 0]) ?? 0;\r\n  return (\r\n    <State variant=\"popover\">\r\n      {(state) => (\r\n        <>\r\n          <Tooltip title={placeholder}>\r\n            <span>{trigger?.(bindTrigger(state))}</span>\r\n          </Tooltip>\r\n          <Menu\r\n            {...bindMenu(state)}\r\n            anchorOrigin={{\r\n              horizontal: \"center\",\r\n              vertical: -itemHeight(sm) * index - padding,\r\n            }}\r\n            transformOrigin={{\r\n              vertical: \"top\",\r\n              horizontal: \"center\",\r\n            }}\r\n          >\r\n            {map(items, ({ value: v, label }) => (\r\n              <MenuItem\r\n                key={v}\r\n                value={v}\r\n                selected={v === value}\r\n                onClick={() => {\r\n                  state.close();\r\n                  onChange?.(v);\r\n                }}\r\n              >\r\n                {label}\r\n              </MenuItem>\r\n            ))}\r\n          </Menu>\r\n        </>\r\n      )}\r\n    </State>\r\n  );\r\n}\r\n\r\nexport type SelectFieldProps<T extends string> = Pick<\r\n  SelectProps<T>,\r\n  \"items\" | \"onChange\"\r\n> &\r\n  Omit<TextFieldProps, \"onChange\">;\r\n\r\nexport function SelectField<T extends string>(props: SelectFieldProps<T>) {\r\n  const { placeholder, value, items = [], onChange } = props;\r\n  return (\r\n    <TextField\r\n      sx={{ minWidth: 120 }}\r\n      select\r\n      label={placeholder}\r\n      value={value}\r\n      variant=\"filled\"\r\n      {...props}\r\n      onChange={(e) => onChange?.(e.target.value as T)}\r\n    >\r\n      {map(items, (item) => (\r\n        <MenuItem key={item.value} value={item.value}>\r\n          {item.label}\r\n        </MenuItem>\r\n      ))}\r\n    </TextField>\r\n  );\r\n}\r\n","import { Button, Typography as Type } from \"@material-ui/core\";\r\nimport { Select } from \"components/generic/Select\";\r\nimport { Space } from \"components/generic/Space\";\r\nimport { find, map, startCase } from \"lodash\";\r\nimport { FeatureDescriptor } from \"protocol/FeatureQuery\";\r\n\r\ntype Props = {\r\n  label?: string;\r\n  value?: string;\r\n  onChange?: (key: string) => void;\r\n  items?: FeatureDescriptor[];\r\n};\r\n\r\nexport function FeaturePicker({ label, value, onChange, items }: Props) {\r\n  const selected = find(items, { id: value });\r\n  return (\r\n    <Select\r\n      placeholder={startCase(label)}\r\n      trigger={(props) => (\r\n        <Button {...props} disabled={!items?.length}>\r\n          {selected?.name ?? label}\r\n        </Button>\r\n      )}\r\n      items={map(items, ({ id, name }) => ({\r\n        value: id,\r\n        label: (\r\n          <>\r\n            <Type>{name}</Type>\r\n            <Space />\r\n            <Type variant=\"body2\" color=\"textSecondary\">\r\n              {id}\r\n            </Type>\r\n          </>\r\n        ),\r\n      }))}\r\n      value={selected?.id}\r\n      onChange={onChange}\r\n    />\r\n  );\r\n}\r\n","import { find } from \"lodash\";\r\nimport { useFeatures } from \"slices/features\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { FeaturePicker } from \"./FeaturePicker\";\r\n\r\nconst mapDefaults = { start: undefined, end: undefined };\r\n\r\nexport function InputControls() {\r\n  const [{ algorithms, maps }] = useFeatures();\r\n  const [{ algorithm, map }, setUIState] = useUIState();\r\n  return (\r\n    <>\r\n      <FeaturePicker\r\n        label=\"map\"\r\n        value={map?.id}\r\n        items={maps}\r\n        onChange={(v) =>\r\n          setUIState({ ...mapDefaults, map: find(maps, { id: v }) })\r\n        }\r\n      />\r\n      <FeaturePicker\r\n        label=\"algorithm\"\r\n        value={algorithm}\r\n        items={algorithms}\r\n        onChange={(v) => setUIState({ algorithm: v })}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { IconButton, IconButtonProps, Tooltip } from \"@material-ui/core\";\r\nimport { startCase } from \"lodash\";\r\nimport { ReactNode } from \"react\";\r\n\r\ntype IconButtonWithTooltipProps = {\r\n  label: string;\r\n  icon: ReactNode;\r\n} & IconButtonProps;\r\n\r\nexport function IconButtonWithTooltip({\r\n  label,\r\n  icon,\r\n  ...rest\r\n}: IconButtonWithTooltipProps) {\r\n  return (\r\n    <Tooltip title={startCase(label)} key={label}>\r\n      <span>\r\n        <IconButton {...rest}>{icon}</IconButton>\r\n      </span>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import {\r\n  PauseOutlined as PauseIcon,\r\n  PlayArrowOutlined as PlayIcon,\r\n  SkipNextOutlined as ForwardIcon,\r\n  SkipPreviousOutlined as PreviousIcon,\r\n  StopOutlined as StopIcon,\r\n} from \"@material-ui/icons\";\r\nimport { IconButtonWithTooltip as Button } from \"components/generic/IconButtonWithTooltip\";\r\nimport { usePlaybackState } from \"hooks/usePlaybackState\";\r\n\r\nexport function PlaybackControls() {\r\n  const {\r\n    playing,\r\n    canPause,\r\n    canPlay,\r\n    canStepBackward,\r\n    canStepForward,\r\n    canStop,\r\n    pause,\r\n    play,\r\n    stepBackward,\r\n    stepForward,\r\n    stop,\r\n  } = usePlaybackState();\r\n  return (\r\n    <>\r\n      <Button\r\n        label=\"step-backward\"\r\n        icon={<PreviousIcon />}\r\n        onClick={stepBackward}\r\n        disabled={!canStepBackward}\r\n      />\r\n      <Button\r\n        {...(playing\r\n          ? {\r\n              label: \"pause\",\r\n              icon: <PauseIcon />,\r\n              onClick: () => pause(),\r\n              disabled: !canPause,\r\n            }\r\n          : {\r\n              label: \"play\",\r\n              icon: <PlayIcon />,\r\n              onClick: () => play(),\r\n              disabled: !canPlay,\r\n              color: \"primary\",\r\n            })}\r\n      />\r\n      <Button\r\n        label=\"step-forward\"\r\n        icon={<ForwardIcon />}\r\n        onClick={stepForward}\r\n        disabled={!canStepForward}\r\n      />\r\n      <Button\r\n        label=\"stop\"\r\n        icon={<StopIcon />}\r\n        onClick={stop}\r\n        disabled={!canStop}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import {\r\n  FormControlLabel,\r\n  Switch as MuiSwitch,\r\n  SwitchProps as MuiSwitchProps,\r\n} from \"@material-ui/core\";\r\nimport { ReactNode } from \"react\";\r\n\r\ntype SwitchProps = { label?: ReactNode } & MuiSwitchProps;\r\n\r\nexport function Switch({ label = <></>, ...props }: SwitchProps) {\r\n  return (\r\n    <FormControlLabel\r\n      control={<MuiSwitch defaultChecked {...props} />}\r\n      {...{ label }}\r\n    />\r\n  );\r\n}\r\n","import {\r\n  Box,\r\n  Button,\r\n  Card,\r\n  Collapse,\r\n  IconButton,\r\n  InputBase,\r\n  List,\r\n  ListSubheader,\r\n  Switch,\r\n  Typography,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport {\r\n  Add,\r\n  DeleteOutlined as DeleteIcon,\r\n  EditOutlined as EditIcon,\r\n  LabelOutlined as LabelIcon,\r\n} from \"@material-ui/icons\";\r\nimport { filter, map, sortBy, uniqBy } from \"lodash\";\r\nimport { nanoid as id } from \"nanoid\";\r\nimport {\r\n  cloneElement,\r\n  ComponentProps,\r\n  CSSProperties,\r\n  forwardRef,\r\n  ReactElement,\r\n  ReactNode,\r\n  useEffect,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\n\r\nexport const DefaultListEditorInput = forwardRef(function StyledInputBase(\r\n  props: ComponentProps<typeof InputBase>,\r\n  ref\r\n) {\r\n  return (\r\n    <InputBase\r\n      fullWidth\r\n      {...props}\r\n      placeholder=\"Untitled item\"\r\n      inputRef={ref}\r\n    />\r\n  );\r\n});\r\n\r\ntype Key = string | number;\r\n\r\ntype Item<T = any> = {\r\n  element?: ReactElement;\r\n  enabled?: boolean;\r\n  value?: T;\r\n  id: Key;\r\n};\r\n\r\ntype Props<T = any> = {\r\n  addItemLabel?: ReactNode;\r\n  label?: ReactNode;\r\n  text?: ReactNode;\r\n  items?: Item<T>[];\r\n  useSwitch?: boolean;\r\n  useDelete?: boolean;\r\n  onChangeItem?: (key: Key, value: T, enabled: boolean) => void;\r\n  onAddItem?: () => void;\r\n  onDeleteItem?: (key: Key) => void;\r\n  icon?: ReactElement | null;\r\n  useEdit?: boolean;\r\n  variant?: \"outlined\" | \"default\";\r\n  extrasPlacement?: \"flex-start\" | \"center\" | \"flex-end\";\r\n  placeholderText?: ReactNode;\r\n  cardStyle?: CSSProperties;\r\n  autoFocus?: boolean;\r\n  getCategory?: (value?: T) => string;\r\n  getOrder?: (value?: T) => string | number;\r\n};\r\n\r\ntype ListEditorFieldProps = {\r\n  isPlaceholder?: boolean;\r\n  i?: number;\r\n};\r\n\r\nfunction useInitialRender() {\r\n  const ref = useRef(false);\r\n  const current = ref.current;\r\n  ref.current = true;\r\n  return !current;\r\n}\r\n\r\nexport function ListEditorField({\r\n  icon = <LabelIcon />,\r\n  useSwitch,\r\n  useDelete,\r\n  useEdit: useEditButton = true,\r\n  onChangeItem = () => {},\r\n  onDeleteItem = () => {},\r\n  enabled = false,\r\n  element = <DefaultListEditorInput />,\r\n  value,\r\n  id,\r\n  i = 0,\r\n  variant = \"default\",\r\n  extrasPlacement = \"center\",\r\n  autoFocus,\r\n  cardStyle: style,\r\n}: Props & ListEditorFieldProps & Item) {\r\n  const [field, setField] = useState<HTMLElement | null>(null);\r\n  const theme = useTheme();\r\n  const content = (\r\n    <Box display=\"flex\" alignItems={extrasPlacement}>\r\n      {icon !== null &&\r\n        cloneElement(icon, {\r\n          style: {\r\n            marginRight: theme.spacing(1),\r\n            marginTop: theme.spacing(0.5),\r\n            marginBottom: theme.spacing(0.5),\r\n          },\r\n          color: \"action\",\r\n        })}\r\n      <Box\r\n        flexGrow={1}\r\n        style={{\r\n          marginLeft: -theme.spacing(icon === null ? 2 : 0),\r\n        }}\r\n      >\r\n        {cloneElement(element, {\r\n          onDelete: () => onDeleteItem(id ?? i),\r\n          autoFocus,\r\n          value,\r\n          key: id ?? i,\r\n          onValueChange: (e: any) => onChangeItem(id ?? i, e, enabled),\r\n          onChange: (e: any) => onChangeItem(id ?? i, e.target.value, enabled),\r\n          ref: (e: HTMLElement | null) => setField(e),\r\n        })}\r\n      </Box>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        {useSwitch && (\r\n          <Switch\r\n            color=\"primary\"\r\n            edge=\"end\"\r\n            onChange={(_, v) => onChangeItem(id ?? i, value, v)}\r\n            checked={enabled}\r\n          />\r\n        )}\r\n        {useEditButton && (\r\n          <IconButton\r\n            edge=\"end\"\r\n            onClick={() => {\r\n              if (field?.focus) {\r\n                field.focus();\r\n              }\r\n            }}\r\n          >\r\n            <EditIcon />\r\n          </IconButton>\r\n        )}\r\n        {useDelete && (\r\n          <IconButton onClick={() => onDeleteItem(id ?? i)}>\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        )}\r\n      </Box>\r\n    </Box>\r\n  );\r\n  return (\r\n    <Box\r\n      style={{\r\n        marginBottom: theme.spacing(1),\r\n        marginLeft: theme.spacing(2),\r\n      }}\r\n    >\r\n      {variant === \"outlined\" ? (\r\n        <Card\r\n          variant=\"outlined\"\r\n          style={{\r\n            borderColor: \"transparent\",\r\n            paddingRight: theme.spacing(2),\r\n            transition: theme.transitions.create([\r\n              \"box-shadow\",\r\n              \"border-color\",\r\n            ]),\r\n            ...style,\r\n          }}\r\n        >\r\n          {content}\r\n        </Card>\r\n      ) : (\r\n        content\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default function Editor<T>(props: Props<T>) {\r\n  const {\r\n    addItemLabel = \"Add Item\",\r\n    label,\r\n    text,\r\n    onAddItem = () => {},\r\n    onDeleteItem = () => {},\r\n    items = [],\r\n    placeholderText,\r\n    autoFocus,\r\n    getCategory,\r\n    getOrder,\r\n  } = props;\r\n  const isInitialRender = useInitialRender();\r\n  const theme = useTheme();\r\n  const [intermediateItems, setIntermediateItems] = useState(items);\r\n  const [newIndex, setNewIndex] = useState(-1);\r\n  useEffect(() => {\r\n    const timeout = setTimeout(() => {\r\n      setIntermediateItems(items);\r\n    }, theme.transitions.duration.standard);\r\n    return () => {\r\n      clearTimeout(timeout);\r\n    };\r\n  }, [items, setIntermediateItems, theme.transitions.duration.standard]);\r\n  const children = uniqBy([...intermediateItems, ...items], (c) => c.id)\r\n    .map((c) => items.find((c2) => c.id === c2.id) ?? c)\r\n    .map((x, i) => {\r\n      const { enabled, element, value, id } = x ?? {};\r\n      return {\r\n        value,\r\n        render: (p?: ComponentProps<typeof ListEditorField>) => (\r\n          <Collapse\r\n            in={!!items.find((p) => p.id === x.id)}\r\n            unmountOnExit\r\n            appear={!isInitialRender}\r\n            mountOnEnter\r\n          >\r\n            <ListEditorField\r\n              {...props}\r\n              onDeleteItem={(e) => {\r\n                onDeleteItem(e);\r\n                setNewIndex(-1);\r\n              }}\r\n              enabled={enabled}\r\n              element={element}\r\n              value={value}\r\n              id={id}\r\n              i={i}\r\n              autoFocus={autoFocus || i === newIndex}\r\n              {...p}\r\n            />\r\n          </Collapse>\r\n        ),\r\n        key: id,\r\n        in: !!items.find((p) => p.id === x.id),\r\n      };\r\n    });\r\n  const sorted = sortBy(\r\n    children,\r\n    (c) => getCategory?.(c.value),\r\n    (c) => getOrder?.(c.value)\r\n  ).map((c) => ({\r\n    ...c,\r\n    render: (p?: ComponentProps<typeof ListEditorField>) => (\r\n      <Box key={c.key}>{c.render(p)}</Box>\r\n    ),\r\n  }));\r\n  return (\r\n    <List\r\n      subheader={\r\n        label || text ? (\r\n          <>\r\n            <ListSubheader disableSticky>\r\n              {label && (\r\n                <Typography variant=\"body1\" gutterBottom color=\"textPrimary\">\r\n                  {label}\r\n                </Typography>\r\n              )}\r\n              {text && (\r\n                <Typography\r\n                  variant=\"body2\"\r\n                  color=\"textSecondary\"\r\n                  gutterBottom\r\n                  style={{ marginBottom: theme.spacing(3) }}\r\n                >\r\n                  {text}\r\n                </Typography>\r\n              )}\r\n            </ListSubheader>\r\n          </>\r\n        ) : undefined\r\n      }\r\n    >\r\n      <Box mt={getCategory ? -1 : 0}>\r\n        {(() => {\r\n          const out: ReactNode[] = [];\r\n          sorted.forEach((c, i) => {\r\n            if (getCategory && isNewCategory(sorted, i, c)) {\r\n              out.push(\r\n                <Collapse\r\n                  in={items.some(\r\n                    (c2) => getCategory(c2.value) === getCategory(c.value)\r\n                  )}\r\n                  appear\r\n                  key={getCategory(c.value)}\r\n                >\r\n                  <Box pl={2} pb={2} pt={1}>\r\n                    <Typography variant=\"overline\" color=\"textSecondary\">\r\n                      {getCategory(c.value)}\r\n                    </Typography>\r\n                  </Box>\r\n                </Collapse>\r\n              );\r\n            }\r\n            out.push(c.render());\r\n          });\r\n          return out;\r\n        })()}\r\n      </Box>\r\n      <Collapse in={!items?.length}>\r\n        <Box ml={2} mb={1} pt={getCategory ? 1 : 0}>\r\n          <Typography color=\"textSecondary\">\r\n            {placeholderText ?? \"No items\"}\r\n          </Typography>\r\n        </Box>\r\n      </Collapse>\r\n      <Box p={2} mb={-3}>\r\n        <Button\r\n          disableElevation\r\n          variant=\"contained\"\r\n          startIcon={<Add />}\r\n          color=\"primary\"\r\n          onClick={() => {\r\n            onAddItem();\r\n            setNewIndex(items.length);\r\n          }}\r\n        >\r\n          {addItemLabel}\r\n        </Button>\r\n      </Box>\r\n    </List>\r\n  );\r\n\r\n  function isNewCategory(\r\n    arr: {\r\n      value: T | undefined;\r\n      render: (\r\n        p?: (Props<any> & ListEditorFieldProps & Item<any>) | undefined\r\n      ) => JSX.Element;\r\n      key: Key;\r\n    }[],\r\n    i: number,\r\n    c: {\r\n      value: T | undefined;\r\n      render: (\r\n        p?: (Props<any> & ListEditorFieldProps & Item<any>) | undefined\r\n      ) => JSX.Element;\r\n      key: Key;\r\n    }\r\n  ) {\r\n    return !!(\r\n      getCategory &&\r\n      (arr[i - 1] === undefined ||\r\n        getCategory(arr[i - 1].value) !== getCategory(c.value))\r\n    );\r\n  }\r\n}\r\n\r\nexport function ListEditor<T extends { key: string }>({\r\n  onChange,\r\n  value,\r\n  editor,\r\n  create,\r\n  ...props\r\n}: Omit<Props<T>, \"items\"> & {\r\n  items?: T[];\r\n  onChange?: (value: T[]) => void;\r\n  value?: T[];\r\n  editor?: (item: T) => ReactElement;\r\n  create?: () => Omit<T, \"key\">;\r\n}) {\r\n  const [state, setState] = useState(value ?? []);\r\n  function handleChange(next: T[]) {\r\n    setState(next);\r\n    onChange?.(next);\r\n  }\r\n  return (\r\n    <Box sx={{ ml: -2 }}>\r\n      <Editor\r\n        {...props}\r\n        items={state.map((c) => ({\r\n          id: c.key,\r\n          value: c,\r\n          element: editor?.(c),\r\n        }))}\r\n        useDelete\r\n        useEdit={false}\r\n        onAddItem={() =>\r\n          handleChange([...state, { key: id(), ...create?.() } as T])\r\n        }\r\n        onDeleteItem={(k) => {\r\n          return handleChange(filter(state, (b) => b.key !== k));\r\n        }}\r\n        onChangeItem={(k, v) =>\r\n          handleChange(map(state, (b) => (b.key === k ? v : b)))\r\n        }\r\n      />\r\n    </Box>\r\n  );\r\n}\r\n","import { Comparator } from \"slices/UIState\";\r\n\r\nexport const comparators: Comparator[] = [\r\n  {\r\n    key: \"equal\",\r\n    apply: (a, b) => a === b,\r\n  },\r\n  {\r\n    key: \"less-than\",\r\n    apply: (a, b) => a < b,\r\n  },\r\n  {\r\n    key: \"greater-than\",\r\n    apply: (a, b) => a > b,\r\n  },\r\n];\r\n","export const intrinsicProperties = [\"f\", \"g\"];\r\n","import { TraceEventType } from \"protocol/Trace\";\r\n\r\nexport const eventTypes: (TraceEventType | \"any\")[] = [\r\n  \"any\",\r\n  \"source\",\r\n  \"destination\",\r\n  \"expanding\",\r\n  \"generating\",\r\n  \"closing\",\r\n];\r\n","import { Divider, TextField, Typography as Type } from \"@material-ui/core\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { SelectField as Select } from \"components/generic/Select\";\r\nimport { Space } from \"components/generic/Space\";\r\nimport { Switch } from \"components/generic/Switch\";\r\nimport { find, last, map, startCase } from \"lodash\";\r\nimport { Breakpoint } from \"slices/UIState\";\r\nimport { comparators } from \"./comparators\";\r\nimport { eventTypes } from \"./eventTypes\";\r\n\r\ntype BreakpointEditorProps = {\r\n  value: Breakpoint;\r\n  onValueChange?: (v: Breakpoint) => void;\r\n  properties?: string[];\r\n};\r\n\r\nexport function BreakpointEditor({\r\n  value,\r\n  onValueChange: onChange,\r\n  properties,\r\n}: BreakpointEditorProps) {\r\n  function handleChange(next: Partial<Breakpoint>) {\r\n    onChange?.({ ...value, ...next });\r\n  }\r\n  return (\r\n    <Flex>\r\n      <Select\r\n        placeholder=\"Event\"\r\n        sx={{ minWidth: 160 }}\r\n        items={map(eventTypes, (c) => ({ value: c, label: startCase(c) }))}\r\n        onChange={(v) => handleChange({ type: v === \"any\" ? undefined : v })}\r\n        value={value.type ?? \"any\"}\r\n      />\r\n      <Divider flexItem orientation=\"vertical\" sx={{ mx: 2 }} />\r\n      <Select\r\n        placeholder=\"Property\"\r\n        sx={{\r\n          minWidth: 140,\r\n          textOverflow: \"ellipsis\",\r\n          whiteSpace: \"nowrap\",\r\n        }}\r\n        items={map(properties, (c) => ({\r\n          value: c,\r\n          label: (\r\n            <>\r\n              {last(c.split(\".\"))}\r\n              <Space />\r\n              <Type\r\n                color=\"textSecondary\"\r\n                variant=\"body2\"\r\n                component=\"span\"\r\n              >{`event.${c}`}</Type>\r\n            </>\r\n          ),\r\n        }))}\r\n        onChange={(v) => handleChange({ property: v })}\r\n        value={value.property}\r\n      />\r\n      <Space />\r\n      <Select\r\n        placeholder=\"Condition\"\r\n        items={comparators.map((c) => ({\r\n          value: c.key,\r\n          label: startCase(c.key),\r\n        }))}\r\n        value={value?.condition?.key ?? comparators?.[0]?.key}\r\n        onChange={(v) =>\r\n          handleChange({ condition: find(comparators, { key: v }) })\r\n        }\r\n      />\r\n      <Space />\r\n      <TextField\r\n        label=\"Reference\"\r\n        fullWidth\r\n        value={`${value.reference ?? 0}`}\r\n        variant=\"filled\"\r\n        inputProps={{ inputMode: \"numeric\", pattern: \"[0-9]*\" }}\r\n        onChange={(v) => handleChange({ reference: +v.target.value })}\r\n        type=\"number\"\r\n      />\r\n      <Space sx={{ px: 2 }} />\r\n      <Switch\r\n        checked={!!value.active}\r\n        onChange={(_, v) => handleChange({ active: v })}\r\n      />\r\n    </Flex>\r\n  );\r\n}\r\n","export const propertyPaths = [\"variables\"];\r\n","import { ListEditor } from \"components/generic/ListEditor\";\r\nimport { debounce, flatMap as flat, get, keys, map, uniq } from \"lodash\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { Breakpoint, useUIState } from \"slices/UIState\";\r\nimport { comparators } from \"./comparators\";\r\nimport { intrinsicProperties } from \"./intrinsicProperties\";\r\nimport { BreakpointEditor } from \"./BreakpointEditor\";\r\nimport { Box } from \"@material-ui/system\";\r\nimport { propertyPaths as paths } from \"./propertyPaths\";\r\n\r\nexport function BreakpointListEditor() {\r\n  const [{ breakpoints = [] }, setUIState] = useUIState();\r\n  const [{ specimen }] = useSpecimen();\r\n\r\n  const properties = uniq([\r\n    ...intrinsicProperties,\r\n    ...flat(paths, (p) =>\r\n      flat(specimen?.nodeStructure, (v) =>\r\n        map(keys(get(v, p)), (k) => `${p}.${k}`)\r\n      )\r\n    ),\r\n  ]);\r\n\r\n  return (\r\n    <Box sx={{ overflow: \"auto hidden\", width: \"100%\" }}>\r\n      <Box sx={{ minWidth: 720, mb: 2 }}>\r\n        <ListEditor<Breakpoint>\r\n          icon={null}\r\n          value={breakpoints}\r\n          useDelete\r\n          useEdit={false}\r\n          editor={(v) => <BreakpointEditor value={v} properties={properties} />}\r\n          create={() => ({\r\n            active: true,\r\n            property: properties?.[0],\r\n            condition: comparators?.[0],\r\n            type: undefined,\r\n            reference: 0,\r\n          })}\r\n          onChange={debounce((v) => setUIState({ breakpoints: v }), 1000)}\r\n          addItemLabel=\"Breakpoint\"\r\n          placeholderText=\"Click the button below to add a breakpoint.\"\r\n        />\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { CircularProgress } from \"@material-ui/core\";\r\nimport Editor from \"@monaco-editor/react\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { debounce } from \"lodash\";\r\nimport AutoSize from \"react-virtualized-auto-sizer\";\r\nimport { useUIState } from \"slices/UIState\";\r\n\r\nconst DELAY = 2500;\r\n\r\nexport function ScriptEditor() {\r\n  const [{ code }, setUIState] = useUIState();\r\n  return (\r\n    <Flex height=\"70vh\" overflow=\"hidden\">\r\n      <AutoSize>\r\n        {({ width, height }) => (\r\n          <Editor\r\n            width={width}\r\n            loading={<CircularProgress variant=\"indeterminate\" />}\r\n            height={height}\r\n            language=\"javascript\"\r\n            defaultValue={code}\r\n            onChange={debounce((v) => setUIState({ code: v }), DELAY)}\r\n            options={{\r\n              minimap: {\r\n                enabled: false,\r\n              },\r\n            }}\r\n          />\r\n        )}\r\n      </AutoSize>\r\n    </Flex>\r\n  );\r\n}\r\n","import { Box, Divider, Tab, Typography as Type } from \"@material-ui/core\";\r\nimport { TabContext, TabList, TabPanel } from \"@material-ui/lab\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { Space } from \"components/generic/Space\";\r\nimport { Switch } from \"components/generic/Switch\";\r\nimport { ReactNode, useState } from \"react\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { BreakpointListEditor } from \"./breakpoint-editor/BreakpointListEditor\";\r\nimport { ScriptEditor } from \"./script-editor/ScriptEditor\";\r\n\r\nexport function DebugOptionsEditor() {\r\n  const [{ monotonicF, monotonicG }, setUIState] = useUIState();\r\n  const [tab, setTab] = useState(\"standard\");\r\n  function renderHeading(label: ReactNode) {\r\n    return (\r\n      <Type variant=\"overline\" color=\"textSecondary\">\r\n        {label}\r\n      </Type>\r\n    );\r\n  }\r\n  return (\r\n    <TabContext value={tab}>\r\n      <TabList onChange={(_, v) => setTab(v)}>\r\n        <Tab label=\"Standard\" value=\"standard\" />\r\n        <Tab label=\"Advanced\" value=\"advanced\" />\r\n      </TabList>\r\n      <Divider />\r\n      <TabPanel value=\"standard\">\r\n        <Box>\r\n          {renderHeading(\"General\")}\r\n          <Flex>\r\n            <Switch\r\n              label=\"Monotonic f value\"\r\n              checked={!!monotonicF}\r\n              onChange={(_, v) => setUIState({ monotonicF: v })}\r\n            />\r\n            <Space />\r\n            <Switch\r\n              label=\"Monotonic g value\"\r\n              checked={!!monotonicG}\r\n              onChange={(_, v) => setUIState({ monotonicG: v })}\r\n            />\r\n          </Flex>\r\n        </Box>\r\n        <Space />\r\n        <Box>\r\n          {renderHeading(\"Breakpoints\")}\r\n          <BreakpointListEditor />\r\n        </Box>\r\n      </TabPanel>\r\n      <TabPanel value=\"advanced\" sx={{ p: 0 }}>\r\n        <ScriptEditor />\r\n      </TabPanel>\r\n    </TabContext>\r\n  );\r\n}\r\n","import { noop } from \"lodash\";\r\nimport {\r\n  ComponentProps,\r\n  createContext,\r\n  useContext,\r\n  useEffect,\r\n  useState,\r\n} from \"react\";\r\n\r\ntype ScrollPanelProps = {\r\n  onTarget?: (e: HTMLDivElement | null) => void;\r\n} & ComponentProps<\"div\">;\r\n\r\nexport function ScrollPanel({\r\n  onTarget = noop,\r\n  onScroll,\r\n  ...props\r\n}: ScrollPanelProps) {\r\n  const [target, setTarget] = useState<HTMLDivElement | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (target && onScroll) {\r\n      target.addEventListener(\"scroll\", onScroll as any, { passive: true });\r\n      return () => target.removeEventListener(\"scroll\", onScroll as any);\r\n    }\r\n  }, [target, onScroll]);\r\n\r\n  return (\r\n    <div\r\n      {...props}\r\n      style={{\r\n        height: \"100%\",\r\n        width: \"100%\",\r\n        overflow: \"hidden scroll\",\r\n        ...props.style,\r\n      }}\r\n      ref={(e) => {\r\n        setTarget(e);\r\n        onTarget?.(e);\r\n      }}\r\n    >\r\n      <PanelContext.Provider value={target}>\r\n        <div\r\n          style={{\r\n            width: \"100%\",\r\n          }}\r\n        >\r\n          {props.children}\r\n        </div>\r\n      </PanelContext.Provider>\r\n    </div>\r\n  );\r\n}\r\nconst PanelContext = createContext<HTMLDivElement | null>(null);\r\n\r\nexport function usePanel() {\r\n  return useContext(PanelContext);\r\n}\r\n","import {\r\n  AppBar,\r\n  Box,\r\n  Dialog,\r\n  Fade,\r\n  IconButton,\r\n  Toolbar,\r\n  Typography,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport { ArrowBack } from \"@material-ui/icons\";\r\nimport { ResizeSensor } from \"css-element-queries\";\r\nimport PopupState from \"material-ui-popup-state\";\r\nimport {\r\n  cloneElement,\r\n  ComponentProps,\r\n  CSSProperties,\r\n  ReactElement,\r\n  ReactNode,\r\n  SyntheticEvent,\r\n  useEffect,\r\n  useState,\r\n} from \"react\";\r\nimport { useScrollState } from \"hooks/useScrollState\";\r\nimport { useSmallDisplay } from \"hooks/useSmallDisplay\";\r\nimport { ScrollPanel, usePanel } from \"./ScrollPanel\";\r\n\r\nexport function AppBarTitle({ children }: { children?: ReactNode }) {\r\n  return <Typography variant=\"h6\">{children}</Typography>;\r\n}\r\n\r\nexport type Props = {\r\n  children?: ReactNode;\r\n  actions?: ReactNode;\r\n  width?: number;\r\n  height?: string | number;\r\n  onTarget?: (target: HTMLDivElement | null) => void;\r\n  variant?: \"default\" | \"submodal\";\r\n  scrollable?: boolean;\r\n};\r\n\r\ntype ModalAppBarProps = {\r\n  onClose?: () => void;\r\n  style?: CSSProperties;\r\n  elevatedStyle?: CSSProperties;\r\n  transitionProperties?: string[];\r\n  children?: ReactNode;\r\n  elevatedChildren?: ReactNode;\r\n  simple?: boolean;\r\n  position?: \"fixed\" | \"absolute\" | \"sticky\" | \"static\";\r\n};\r\n\r\nexport function ModalAppBar({\r\n  onClose = () => {},\r\n  style,\r\n  elevatedStyle,\r\n  children,\r\n  transitionProperties = [\"box-shadow\", \"background\", \"border-bottom\"],\r\n  elevatedChildren,\r\n  simple,\r\n  position = \"sticky\",\r\n}: ModalAppBarProps) {\r\n  const panel = usePanel();\r\n  const theme = useTheme();\r\n  const [, , isAbsoluteTop, , setTarget] = useScrollState();\r\n  useEffect(() => {\r\n    setTarget(panel);\r\n  }, [panel, setTarget]);\r\n\r\n  const styles = isAbsoluteTop\r\n    ? {\r\n        background: theme.palette.background.paper,\r\n        ...(!simple && {\r\n          boxShadow: theme.shadows[0],\r\n        }),\r\n        ...style,\r\n      }\r\n    : {\r\n        background: theme.palette.background.paper,\r\n        ...(!simple && {\r\n          boxShadow: theme.shadows[4],\r\n        }),\r\n        ...elevatedStyle,\r\n      };\r\n\r\n  return (\r\n    <AppBar\r\n      elevation={0}\r\n      position={position}\r\n      style={{\r\n        color: theme.palette.text.primary,\r\n        transition: theme.transitions.create(transitionProperties),\r\n        ...styles,\r\n      }}\r\n    >\r\n      <Toolbar>\r\n        <IconButton\r\n          style={{\r\n            marginRight: theme.spacing(1),\r\n          }}\r\n          aria-label=\"open drawer\"\r\n          edge=\"start\"\r\n          onClick={() => onClose()}\r\n        >\r\n          <ArrowBack />\r\n        </IconButton>\r\n\r\n        {children && (\r\n          <div\r\n            style={{\r\n              gridColumn: 1,\r\n              gridRow: 1,\r\n              flex: 1,\r\n              overflow: \"auto\",\r\n            }}\r\n          >\r\n            <Fade\r\n              in={!!(!elevatedChildren || isAbsoluteTop)}\r\n              mountOnEnter\r\n              unmountOnExit\r\n            >\r\n              <Box style={{ width: \"100%\" }}>{children}</Box>\r\n            </Fade>\r\n          </div>\r\n        )}\r\n        {elevatedChildren && (\r\n          <div\r\n            style={{\r\n              gridColumn: 1,\r\n              gridRow: 1,\r\n              flex: 1,\r\n              overflow: \"auto\",\r\n            }}\r\n          >\r\n            <Fade\r\n              in={!!(elevatedChildren && !isAbsoluteTop)}\r\n              mountOnEnter\r\n              unmountOnExit\r\n            >\r\n              <Box style={{ width: \"100%\" }}>{elevatedChildren}</Box>\r\n            </Fade>\r\n          </div>\r\n        )}\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n\r\nexport default function Modal({\r\n  children,\r\n  actions,\r\n  width = 480,\r\n  height,\r\n  onTarget,\r\n  variant = \"default\",\r\n  scrollable = true,\r\n  ...props\r\n}: Props & ComponentProps<typeof Dialog>) {\r\n  const [content, setContent] = useState<ReactNode | undefined>(undefined);\r\n  useEffect(() => {\r\n    if (children) setContent(children);\r\n  }, [children]);\r\n  const theme = useTheme();\r\n  const sm = useSmallDisplay();\r\n\r\n  const [target, setTarget] = useState<HTMLElement | null>(null);\r\n  const [contentRef, setContentRef] = useState<HTMLElement | null>(null);\r\n  const [hasOverflowingChildren, setHasOverflowingChildren] = useState(false);\r\n  const [childHeight, setChildHeight] = useState(0);\r\n\r\n  useEffect(() => {\r\n    if (target && contentRef && !sm && !height) {\r\n      const callback = () => {\r\n        const doesOverflow = window.innerHeight - 64 < contentRef.offsetHeight;\r\n        setHasOverflowingChildren(doesOverflow);\r\n        setChildHeight(\r\n          contentRef.offsetHeight <= 1 ? 0 : Math.ceil(contentRef.offsetHeight)\r\n        );\r\n      };\r\n      window.addEventListener(\"resize\", callback);\r\n      const ob = new ResizeSensor(contentRef, callback);\r\n      callback();\r\n      return () => {\r\n        window.removeEventListener(\"resize\", callback);\r\n        ob.detach();\r\n      };\r\n    }\r\n  }, [target, contentRef, sm, height]);\r\n\r\n  const useVariant = variant === \"submodal\" && sm;\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={sm}\r\n      {...props}\r\n      style={{\r\n        ...(useVariant && {\r\n          paddingTop: theme.spacing(8),\r\n        }),\r\n        ...props.style,\r\n      }}\r\n      PaperProps={{\r\n        ref: (e: HTMLElement | null) => setTarget(e),\r\n        style: {\r\n          ...(useVariant && {\r\n            borderRadius: `${theme.shape.borderRadius}px ${theme.shape.borderRadius}px 0 0`,\r\n          }),\r\n          background: theme.palette.background.default,\r\n          overflow: \"hidden\",\r\n          height:\r\n            height && !sm\r\n              ? height\r\n              : hasOverflowingChildren || sm\r\n              ? \"100%\"\r\n              : childHeight || \"fit-content\",\r\n          position: \"relative\",\r\n          maxWidth: \"none\",\r\n          ...props.PaperProps?.style,\r\n        },\r\n        ...props.PaperProps,\r\n      }}\r\n    >\r\n      <ScrollPanel\r\n        style={{\r\n          height: \"100%\",\r\n          width: sm ? undefined : width,\r\n          maxWidth: \"100%\",\r\n          overflow: scrollable ? undefined : \"hidden\",\r\n        }}\r\n        onTarget={onTarget}\r\n      >\r\n        <div\r\n          ref={(e) => setContentRef(e)}\r\n          style={{ width: \"100%\", height: \"100%\" }}\r\n        >\r\n          {content}\r\n        </div>\r\n      </ScrollPanel>\r\n      {actions}\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport function ManagedModal({\r\n  options: ModalProps,\r\n  appBar: ModalAppBarProps,\r\n  trigger = () => <></>,\r\n  children,\r\n}: {\r\n  options?: Props;\r\n  trigger?: (onClick: (e: SyntheticEvent<any, Event>) => void) => ReactElement;\r\n  appBar?: ModalAppBarProps;\r\n  children?: ReactNode;\r\n}) {\r\n  return (\r\n    <PopupState variant=\"popover\">\r\n      {({ open, close, isOpen }) => {\r\n        return (\r\n          <>\r\n            {cloneElement(trigger(open))}\r\n            <Modal open={isOpen} onClose={close} {...ModalProps}>\r\n              <ModalAppBar onClose={close} {...ModalAppBarProps} />\r\n              {children ?? ModalProps?.children}\r\n            </Modal>\r\n          </>\r\n        );\r\n      }}\r\n    </PopupState>\r\n  );\r\n}\r\n","import { useEffect, useRef, useState } from \"react\";\r\n\r\nexport function useScrollState(threshold: number = 128) {\r\n  const [showControls, setShowControls] = useState(true);\r\n  const [isAbsoluteTop, setIsAbsoluteTop] = useState(true);\r\n  const [isTop, setIsTop] = useState(true);\r\n  const [target, setTarget] = useState<HTMLElement | null>(null);\r\n  const lastTop = useRef(0);\r\n  useEffect(() => {\r\n    if (target) {\r\n      const listener = () => {\r\n        {\r\n          const newIsTop = target.scrollTop <= threshold;\r\n          if (newIsTop !== isTop) {\r\n            setIsTop(newIsTop);\r\n          }\r\n        }\r\n        {\r\n          const newIsTop = target.scrollTop <= 1;\r\n          if (newIsTop !== isAbsoluteTop) {\r\n            setIsAbsoluteTop(newIsTop);\r\n          }\r\n        }\r\n        if (lastTop.current - target.scrollTop) {\r\n          if (\r\n            Math.abs(lastTop.current - target.scrollTop) > 2 &&\r\n            lastTop.current >= 0\r\n          ) {\r\n            setShowControls(lastTop.current > target.scrollTop);\r\n          }\r\n          lastTop.current = target.scrollTop;\r\n        }\r\n      };\r\n      target.addEventListener(\"scroll\", listener, { passive: true });\r\n      return () => {\r\n        target.removeEventListener(\"scroll\", listener);\r\n      };\r\n    }\r\n  }, [target, isTop, isAbsoluteTop, lastTop, threshold]);\r\n  return [\r\n    showControls || isTop,\r\n    isTop,\r\n    isAbsoluteTop,\r\n    target,\r\n    setTarget,\r\n  ] as const;\r\n}\r\n","import { Button } from \"@material-ui/core\";\r\nimport { BugReport as BugIcon } from \"@material-ui/icons\";\r\nimport { DebugOptionsEditor } from \"components/DebugOptionsEditor\";\r\nimport {\r\n  AppBarTitle as Title,\r\n  ManagedModal as Dialog,\r\n} from \"components/generic/Modal\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\n\r\nexport function UtilityControls() {\r\n  const [{ specimen }] = useSpecimen();\r\n  // const INTEROP_compare = useCompatibilityLayer(\"#comparator button\");\r\n  // const INTEROP_timeTravel = useCompatibilityLayer(\"#time-travel button\");\r\n  return (\r\n    <>\r\n      <Dialog\r\n        trigger={(onClick) => (\r\n          <Button {...{ onClick }} disabled={!specimen} startIcon={<BugIcon />}>\r\n            Debug\r\n          </Button>\r\n        )}\r\n        options={{ width: 960, scrollable: false }}\r\n        appBar={{ children: <Title>Debug Options</Title> }}\r\n      >\r\n        <DebugOptionsEditor />\r\n      </Dialog>\r\n      {/* <Button disabled={!specimen} onClick={INTEROP_compare}>\r\n        Compare...\r\n      </Button> */}\r\n      {/* <Button disabled={!specimen} onClick={INTEROP_timeTravel}>\r\n        Jump...\r\n      </Button> */}\r\n    </>\r\n  );\r\n}\r\n","import { AppBar, Box, Divider, Toolbar } from \"@material-ui/core\";\r\nimport { InputControls } from \"./InputControls\";\r\nimport { PlaybackControls } from \"./PlaybackControls\";\r\nimport { UtilityControls } from \"./UtilityControls\";\r\n\r\nconst divider = <Divider orientation=\"vertical\" flexItem sx={{ m: 1 }} />;\r\n\r\nexport function Controls() {\r\n  return (\r\n    <AppBar position=\"static\" color=\"transparent\" elevation={0}>\r\n      <Toolbar>\r\n        <Box m={-1} display=\"flex\" alignItems=\"center\">\r\n          <InputControls />\r\n          {divider}\r\n          <PlaybackControls />\r\n          {divider}\r\n          <UtilityControls />\r\n        </Box>\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n","import { Box, BoxProps } from \"@material-ui/core\";\r\nimport { ReactElement } from \"react\";\r\nimport {\r\n  Virtuoso as List,\r\n  VirtuosoHandle as Handle,\r\n  VirtuosoProps as ListProps,\r\n} from \"react-virtuoso\";\r\n\r\nexport type LazyListHandle = Handle;\r\n\r\nexport type LazyListProps<T> = {\r\n  items?: T[];\r\n  renderItem?: (item: T, index: number) => ReactElement;\r\n  listOptions?: Partial<ListProps<T>>;\r\n} & BoxProps;\r\n\r\nexport function LazyList<T>({\r\n  items = [],\r\n  renderItem,\r\n  listOptions: options,\r\n  ...props\r\n}: LazyListProps<T>) {\r\n  return (\r\n    <Box {...props}>\r\n      <List\r\n        totalCount={items.length}\r\n        itemContent={(i) => renderItem?.(items[i], i)}\r\n        {...options}\r\n      />\r\n    </Box>\r\n  );\r\n}\r\n","import { Typography as Type } from \"@material-ui/core\";\r\nimport { FiberManualRecord as Dot } from \"@material-ui/icons\";\r\nimport { ComponentProps, ReactNode } from \"react\";\r\n\r\nexport function OverlineDot(props: ComponentProps<typeof Dot>) {\r\n  return (\r\n    <Dot\r\n      {...props}\r\n      sx={{\r\n        fontSize: 12,\r\n        transform: \"translateY(1.75px) translateX(-2px)\",\r\n        ...props.sx,\r\n      }}\r\n    />\r\n  );\r\n}\r\n\r\ntype Props = {\r\n  children?: ReactNode;\r\n};\r\n\r\nexport function Overline({ children }: Props) {\r\n  return (\r\n    <Type variant=\"overline\" sx={{ my: -0.75, display: \"block\" }}>\r\n      {children}\r\n    </Type>\r\n  );\r\n}\r\n","import { Flex } from \"./Flex\";\r\nimport {\r\n  Typography as Type,\r\n  TypographyProps as TypeProps,\r\n} from \"@material-ui/core\";\r\nimport { Space } from \"./Space\";\r\nimport { ReactNode } from \"react\";\r\n\r\ntype Props = {\r\n  label?: ReactNode;\r\n  value?: ReactNode;\r\n  type?: TypeProps;\r\n};\r\n\r\nexport function Property({ label, value, type }: Props) {\r\n  return (\r\n    <Flex width=\"auto\" mr={3} mt={0.5} key={`${label}::${value}`}>\r\n      <Type sx={{ opacity: 0.54 }} {...type}>\r\n        {label}\r\n      </Type>\r\n      <Space />\r\n      <Type {...type}>{value}</Type>\r\n    </Flex>\r\n  );\r\n}\r\n","import {\r\n  Box,\r\n  Card,\r\n  CardActionArea,\r\n  CardProps,\r\n  Divider,\r\n  Typography as Type,\r\n} from \"@material-ui/core\";\r\nimport { HideSourceOutlined as HiddenIcon } from \"@material-ui/icons\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { Overline, OverlineDot as Dot } from \"components/generic/Overline\";\r\nimport { Property } from \"components/generic/Property\";\r\nimport { call } from \"components/script-editor/call\";\r\nimport { getColorHex } from \"components/specimen-renderer/grid-renderer/colors\";\r\nimport { entries, filter, map } from \"lodash\";\r\nimport { TraceEvent } from \"protocol/Trace\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\n\r\ntype EventInspectorProps = {\r\n  event?: TraceEvent;\r\n  index?: number;\r\n  selected?: boolean;\r\n} & CardProps;\r\n\r\nexport function EventInspector({\r\n  event,\r\n  index,\r\n  selected,\r\n  ...props\r\n}: EventInspectorProps) {\r\n  const [{ specimen }] = useSpecimen();\r\n  const [{ code }, setUIState] = useUIState();\r\n\r\n  const cardStyles = selected\r\n    ? {\r\n        color: \"primary.contrastText\",\r\n        bgcolor: \"primary.main\",\r\n      }\r\n    : {};\r\n\r\n  const hidden = event\r\n    ? !call(code ?? \"\", \"shouldRender\", [\r\n        index ?? 0,\r\n        event,\r\n        specimen?.eventList ?? [],\r\n      ])\r\n    : false;\r\n\r\n  return (\r\n    <Card\r\n      {...props}\r\n      sx={{\r\n        ...cardStyles,\r\n        ...props.sx,\r\n      }}\r\n    >\r\n      <CardActionArea\r\n        sx={{ p: 2, height: \"100%\" }}\r\n        onClick={() => setUIState({ step: index })}\r\n      >\r\n        <Flex alignItems=\"center\">\r\n          <Type>{index}</Type>\r\n          <Divider sx={{ mx: 2 }} flexItem orientation=\"vertical\" />\r\n          <Box>\r\n            <Overline>\r\n              <Dot\r\n                sx={{\r\n                  color: getColorHex(event?.type),\r\n                  mr: 1,\r\n                }}\r\n              />\r\n              {`${event?.type ?? \"unsupported\"} #${event?.id ?? \"-\"}`}{\" \"}\r\n              {hidden && (\r\n                <HiddenIcon\r\n                  sx={{\r\n                    opacity: 0.56,\r\n                    fontSize: 12,\r\n                    ml: 1,\r\n                    transform: \"translateY(1.75px)\",\r\n                  }}\r\n                />\r\n              )}\r\n            </Overline>\r\n            <Flex flexWrap=\"wrap\">\r\n              {map(\r\n                filter(\r\n                  [\r\n                    [\"f\", event?.f],\r\n                    [\"g\", event?.g],\r\n                    ...entries(event?.variables),\r\n                  ],\r\n                  ([, v]) => v !== undefined\r\n                ),\r\n                ([k, v]) => (\r\n                  <Property label={k} value={v} type={{ variant: \"body2\" }} />\r\n                )\r\n              )}\r\n            </Flex>\r\n          </Box>\r\n        </Flex>\r\n      </CardActionArea>\r\n    </Card>\r\n  );\r\n}\r\n","import { Fade } from \"@material-ui/core\";\r\nimport { Box } from \"@material-ui/system\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport {\r\n  LazyList as List,\r\n  LazyListHandle as ListHandle,\r\n  LazyListProps as ListProps,\r\n} from \"components/generic/LazyList\";\r\nimport { delay } from \"lodash\";\r\nimport { TraceEvent } from \"protocol/Trace\";\r\nimport { useEffect, useRef } from \"react\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { EventInspector } from \"./EventInspector\";\r\n\r\nexport function EventListInspector(props: ListProps<TraceEvent>) {\r\n  const [{ step = 0, playback }] = useUIState();\r\n  const [{ specimen }] = useSpecimen();\r\n  const ref = useRef<ListHandle | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (playback === \"paused\") {\r\n      delay(\r\n        () =>\r\n          ref?.current?.scrollToIndex?.({\r\n            index: step,\r\n            align: \"start\",\r\n            behavior: \"smooth\",\r\n            offset: -16,\r\n          }),\r\n        150\r\n      );\r\n    }\r\n  }, [step, playback]);\r\n\r\n  return (\r\n    <Fade unmountOnExit mountOnEnter in={playback === \"paused\"}>\r\n      <Box>\r\n        <List\r\n          {...props}\r\n          items={specimen?.eventList}\r\n          listOptions={{ ref }}\r\n          renderItem={(item, i) => (\r\n            <Flex p={2} pt={i ? 0 : 2}>\r\n              <EventInspector\r\n                sx={{ flex: 1 }}\r\n                event={item}\r\n                index={i}\r\n                selected={i === step}\r\n              />\r\n            </Flex>\r\n          )}\r\n        />\r\n      </Box>\r\n    </Fade>\r\n  );\r\n}\r\n","import {\r\n  Divider,\r\n  ListItem,\r\n  ListItemIcon,\r\n  ListItemText,\r\n  Menu,\r\n  MenuItem,\r\n} from \"@material-ui/core\";\r\nimport {\r\n  PlaceOutlined as DestinationIcon,\r\n  TripOriginOutlined as StartIcon,\r\n} from \"@material-ui/icons\";\r\nimport { Overline } from \"components/generic/Overline\";\r\nimport { Property } from \"components/generic/Property\";\r\nimport { map } from \"lodash\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { SelectEvent as RendererSelectEvent } from \"components/specimen-renderer/Renderer\";\r\nimport { useSnackbar } from \"components/generic/Snackbar\";\r\n\r\ntype Props = {\r\n  selection?: RendererSelectEvent;\r\n  onClose?: () => void;\r\n};\r\n\r\nexport function SelectionMenu({ selection, onClose }: Props) {\r\n  const notify = useSnackbar();\r\n  const [, setUIState] = useUIState();\r\n  const { global, world, info } = selection ?? {};\r\n  const { current, entry, node } = info ?? {};\r\n\r\n  return (\r\n    <Menu\r\n      open={!!selection}\r\n      anchorReference=\"anchorPosition\"\r\n      anchorPosition={{\r\n        top: global?.y ?? 0,\r\n        left: global?.x ?? 0,\r\n      }}\r\n      onClose={onClose}\r\n    >\r\n      <ListItem>\r\n        <ListItemText>\r\n          <Overline>Point</Overline>\r\n          <Property label=\"x\" value={world?.x ?? \"-\"} />\r\n          <Property label=\"y\" value={world?.y ?? \"-\"} />\r\n        </ListItemText>\r\n      </ListItem>\r\n      <Divider sx={{ my: 1 }} />\r\n      {map(\r\n        [\r\n          {\r\n            label: \"Set Origin\",\r\n            icon: <StartIcon sx={{ transform: \"scale(0.5)\" }} />,\r\n            action: () => {\r\n              notify(\"Origin set.\");\r\n              setUIState({ start: node?.key });\r\n            },\r\n            disabled: !node,\r\n          },\r\n          {\r\n            label: \"Set Destination\",\r\n            icon: <DestinationIcon />,\r\n            action: () => {\r\n              notify(\"Destination set.\");\r\n              setUIState({ end: node?.key });\r\n            },\r\n            disabled: !node,\r\n          },\r\n          {\r\n            label: \"Go to Expansion Step\",\r\n            action: () =>\r\n              setUIState({ step: entry?.index ?? 0, playback: \"paused\" }),\r\n            disabled: !entry,\r\n          },\r\n          {\r\n            label: \"Rewind to This Step\",\r\n            action: () =>\r\n              setUIState({ step: current?.index ?? 0, playback: \"paused\" }),\r\n            disabled: !current,\r\n          },\r\n        ],\r\n        ({ label, icon, action, disabled }) => (\r\n          <MenuItem\r\n            disabled={disabled}\r\n            onClick={() => {\r\n              action();\r\n              onClose?.();\r\n            }}\r\n          >\r\n            <ListItemIcon>{icon}</ListItemIcon>\r\n            <ListItemText>{label}</ListItemText>\r\n          </MenuItem>\r\n        )\r\n      )}\r\n    </Menu>\r\n  );\r\n}\r\n","import { Fade, LinearProgress } from \"@material-ui/core\";\r\nimport { Flex, FlexProps } from \"components/generic/Flex\";\r\nimport { getRenderer } from \"components/specimen-renderer/getRenderer\";\r\nimport { SelectEvent as RendererSelectEvent } from \"components/specimen-renderer/Renderer\";\r\nimport { some, values } from \"lodash\";\r\nimport { createElement, useState } from \"react\";\r\nimport AutoSize from \"react-virtualized-auto-sizer\";\r\nimport { useLoading } from \"slices/loading\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { EventListInspector } from \"./EventListInspector\";\r\nimport { SelectionMenu } from \"./SelectionMenu\";\r\n\r\ntype SpecimenInspectorProps = {} & FlexProps;\r\n\r\nexport function SpecimenInspector(props: SpecimenInspectorProps) {\r\n  const [loading] = useLoading();\r\n  const [{ specimen, mapType }] = useSpecimen();\r\n  const [renderer] = getRenderer(mapType);\r\n  const [selection, setSelection] = useState<RendererSelectEvent | undefined>(\r\n    undefined\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <Fade in={some(values(loading))}>\r\n        <LinearProgress variant=\"indeterminate\" sx={{ mb: -0.5, zIndex: 1 }} />\r\n      </Fade>\r\n      <Flex {...props}>\r\n        {specimen ? (\r\n          <Flex>\r\n            <AutoSize>\r\n              {(size) =>\r\n                createElement(renderer, {\r\n                  ...size,\r\n                  onSelect: setSelection,\r\n                  selection: selection?.world,\r\n                })\r\n              }\r\n            </AutoSize>\r\n            <EventListInspector\r\n              position=\"absolute\"\r\n              right={0}\r\n              height=\"100%\"\r\n              maxWidth={480}\r\n              minWidth=\"30vw\"\r\n            />\r\n          </Flex>\r\n        ) : (\r\n          <Flex\r\n            justifyContent=\"center\"\r\n            alignItems=\"center\"\r\n            color=\"text.secondary\"\r\n          >\r\n            Select a map and an algorithm to get started.\r\n          </Flex>\r\n        )}\r\n      </Flex>\r\n      <SelectionMenu\r\n        selection={selection}\r\n        onClose={() => setSelection(undefined)}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { AppBar, Toolbar, Typography } from \"@material-ui/core\";\r\n\r\nexport function Title() {\r\n  return (\r\n    <AppBar position=\"static\" elevation={0}>\r\n      <Toolbar>\r\n        <Typography variant=\"h6\">Path Search Visualiser</Typography>\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n","import { Controls } from \"components/control-bar/Controls\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { SpecimenInspector } from \"components/specimen-inspector/SpecimenInspector\";\r\nimport { Title } from \"components/Title\";\r\n\r\nfunction App() {\r\n  return (\r\n    <Flex vertical>\r\n      <Flex vertical boxShadow={4} height=\"auto\" zIndex={1}>\r\n        <Title />\r\n        <Controls />\r\n      </Flex>\r\n      <SpecimenInspector flex={1} />\r\n    </Flex>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import { CssBaseline, ThemeProvider } from \"@material-ui/core\";\r\nimport { theme } from \"client/theme\";\r\nimport { SnackbarProvider } from \"components/generic/Snackbar\";\r\nimport { StrictMode } from \"react\";\r\nimport { render } from \"react-dom\";\r\nimport { ConnectionStateService } from \"services/ConnectionStateService\";\r\nimport { PlaybackService } from \"services/PlaybackService\";\r\nimport { SpecimenService } from \"services/SpecimenService\";\r\nimport { FeaturesProvider } from \"slices/features\";\r\nimport { InfoProvider } from \"slices/info\";\r\nimport { LoadingProvider } from \"slices/loading\";\r\nimport { SliceProvider as AppStateProvider } from \"slices/SliceProvider\";\r\nimport { SpecimenProvider } from \"slices/specimen\";\r\nimport { UIStateProvider } from \"slices/UIState\";\r\nimport App from \"./App\";\r\nimport \"./index.css\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\n\r\nconst slices = [\r\n  InfoProvider,\r\n  FeaturesProvider,\r\n  UIStateProvider,\r\n  SpecimenProvider,\r\n  LoadingProvider,\r\n];\r\n\r\nconst services = [ConnectionStateService, PlaybackService, SpecimenService];\r\n\r\nrender(\r\n  <StrictMode>\r\n    <CssBaseline>\r\n      <ThemeProvider theme={theme}>\r\n        <SnackbarProvider>\r\n          <AppStateProvider slices={slices} services={services}>\r\n            <App />\r\n          </AppStateProvider>\r\n        </SnackbarProvider>\r\n      </ThemeProvider>\r\n    </CssBaseline>\r\n  </StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","import { useSnackbar } from \"components/generic/Snackbar\";\r\nimport { useEffect } from \"react\";\r\nimport { useInfo } from \"slices/info\";\r\n\r\nexport function ConnectionStateService() {\r\n  const notify = useSnackbar();\r\n  const [info] = useInfo();\r\n\r\n  useEffect(\r\n    () =>\r\n      notify(\r\n        info\r\n          ? `Connected: ${info.name} ${info.version}`\r\n          : \"Connecting to the solver...\"\r\n      ),\r\n    [notify, info]\r\n  );\r\n\r\n  return <></>;\r\n}\r\n","import {\r\n  SnackbarLabel as Label,\r\n  useSnackbar,\r\n} from \"components/generic/Snackbar\";\r\nimport { usePlaybackState } from \"hooks/usePlaybackState\";\r\nimport { range, trimEnd } from \"lodash\";\r\nimport { ReactNode, useCallback, useEffect } from \"react\";\r\nimport { useRaf } from \"react-use\";\r\nimport { useBreakpoints } from \"../hooks/useBreakpoints\";\r\n\r\nconst RATE = 4;\r\n\r\nfunction cancellable<T = void>(f: () => Promise<T>, g: (result: T) => void) {\r\n  let cancelled = false;\r\n  requestAnimationFrame(async () => {\r\n    const result = await f();\r\n    if (!cancelled) g(result);\r\n  });\r\n  return () => {\r\n    cancelled = true;\r\n  };\r\n}\r\n\r\nexport function PlaybackService() {\r\n  useRaf();\r\n  const notify = useSnackbar();\r\n  const { playing, end, step, pause, tick } = usePlaybackState();\r\n  const shouldBreak = useBreakpoints();\r\n\r\n  const renderLabel = useCallback(\r\n    (label: ReactNode, offset: number) => (\r\n      <Label primary={label} secondary={`Step ${step + offset}`} />\r\n    ),\r\n    [step]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (playing) {\r\n      return step < end\r\n        ? cancellable(\r\n            async () => {\r\n              for (const i of range(RATE)) {\r\n                const r = shouldBreak(step + i);\r\n                if (r.result || r.error) return { ...r, offset: i };\r\n              }\r\n              return { result: \"\", offset: 0 };\r\n            },\r\n            ({ result, offset, error }) => {\r\n              if (!error) {\r\n                if (result) {\r\n                  notify(renderLabel(`Breakpoint hit: ${result}.`, offset));\r\n                  pause(offset);\r\n                } else tick(RATE);\r\n              } else {\r\n                notify(renderLabel(`${trimEnd(error, \".\")}.`, offset));\r\n                pause();\r\n              }\r\n            }\r\n          )\r\n        : pause();\r\n    }\r\n  }, [renderLabel, playing, end, step, pause, tick, notify, shouldBreak]);\r\n\r\n  return <></>;\r\n}\r\n","import { call } from \"components/script-editor/call\";\r\nimport { get, keyBy, lowerCase as lower, memoize, startCase } from \"lodash\";\r\nimport { useMemo } from \"react\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\n\r\nexport function useBreakpoints() {\r\n  const [{ specimen }] = useSpecimen();\r\n  const [{ code, breakpoints = [], monotonicF, monotonicG }] = useUIState();\r\n\r\n  return useMemo(() => {\r\n    const memo = keyBy(specimen?.eventList, \"id\");\r\n    return memoize((step: number) => {\r\n      const event = specimen?.eventList?.[step];\r\n      if (event) {\r\n        try {\r\n          // Check monotonic f or g values\r\n          if (step) {\r\n            for (const p of [monotonicF && \"f\", monotonicG && \"g\"]) {\r\n              if (p && get(memo[`${event.pId}`], p) > get(event, p)) {\r\n                return { result: `Monotonicity violation on ${p}` };\r\n              }\r\n            }\r\n          }\r\n          // Check breakpoints in the breakpoints section\r\n          for (const {\r\n            active,\r\n            condition,\r\n            type,\r\n            property = \"\",\r\n            reference = 0,\r\n          } of breakpoints) {\r\n            const isType = !type || type === event.type;\r\n            const match = condition?.apply?.(get(event, property), reference);\r\n            if (active && isType && match) {\r\n              return {\r\n                result: `${property} ${lower(\r\n                  startCase(condition?.key)\r\n                )} ${reference}`,\r\n              };\r\n            }\r\n          }\r\n          // Check breakpoints in the script editor section\r\n          if (\r\n            call(code ?? \"\", \"shouldBreak\", [\r\n              step,\r\n              event,\r\n              specimen?.eventList ?? [],\r\n            ])\r\n          ) {\r\n            return { result: \"Script editor\" };\r\n          }\r\n        } catch (e) {\r\n          return { error: `${e}` };\r\n        }\r\n      }\r\n      return { result: \"\" };\r\n    });\r\n  }, [code, specimen, breakpoints, monotonicF, monotonicG]);\r\n}\r\n"],"sourceRoot":""}
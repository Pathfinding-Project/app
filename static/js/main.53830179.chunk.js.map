{"version":3,"sources":["components/generic/Flex.tsx","theme.tsx","components/generic/Snackbar.tsx","components/generic/Space.tsx","slices/reducers.tsx","slices/createSlice.tsx","slices/connections.ts","slices/features.ts","components/script-editor/makeTemplate.tsx","components/script-editor/templates.tsx","slices/UIState.ts","hooks/useSmallDisplay.tsx","components/generic/Select.tsx","components/app-bar/FeaturePicker.tsx","components/app-bar/upload.tsx","components/app-bar/Input.tsx","components/generic/IconButtonWithTooltip.tsx","slices/specimen.ts","hooks/usePlaybackState.tsx","components/app-bar/Playback.tsx","hooks/useScrollState.tsx","components/generic/ScrollPanel.tsx","components/generic/Modal.tsx","slices/settings.ts","workers/hash.worker.ts","client/IPCTransport.ts","client/internal.ts","client/NativeTransport.ts","client/SocketIOTransport.ts","client/index.ts","components/generic/ListEditor.tsx","components/generic/Overline.tsx","hooks/useConnectionResolver.tsx","slices/loading.ts","hooks/useConnectionStatus.tsx","components/settings-editor/ServerEditor.tsx","components/settings-editor/ServerListEditor.tsx","components/settings-editor/SettingsEditor.tsx","components/app-bar/Settings.tsx","components/app-bar/Title.tsx","components/generic/Switch.tsx","components/breakpoint-editor/comparators.tsx","components/breakpoint-editor/intrinsicProperties.tsx","components/breakpoint-editor/eventTypes.tsx","components/breakpoint-editor/BreakpointEditor.tsx","components/breakpoint-editor/propertyPaths.tsx","components/breakpoint-editor/BreakpointListEditor.tsx","components/script-editor/ScriptEditor.tsx","components/debug-options-editor/saveJSON.tsx","components/debug-options-editor/DebugOptionsEditor.tsx","components/app-bar/Utility.tsx","components/app-bar/Controls.tsx","components/specimen-renderer/default-renderer/DefaultRenderer.tsx","components/specimen-renderer/default-renderer/getDefaults.tsx","components/specimen-renderer/grid-renderer/parseMap.tsx","components/specimen-renderer/grid-renderer/getDefaults.tsx","components/script-editor/call.tsx","components/specimen-renderer/colors.tsx","components/specimen-renderer/raster-renderer/config.tsx","components/specimen-renderer/raster-renderer/makeGraphic.tsx","components/specimen-renderer/raster-renderer/Guides.tsx","components/specimen-renderer/raster-renderer/Node.tsx","components/specimen-renderer/raster-renderer/NodeList.tsx","components/specimen-renderer/raster-renderer/Overlay.tsx","components/specimen-renderer/raster-renderer/Path.tsx","components/specimen-renderer/raster-renderer/PixiViewport.tsx","components/specimen-renderer/raster-renderer/Viewport.tsx","components/specimen-renderer/raster-renderer/RasterRenderer.tsx","components/specimen-renderer/grid-renderer/Selection.tsx","components/specimen-renderer/grid-renderer/selectionInfo.tsx","components/specimen-renderer/grid-renderer/GridRenderer.tsx","components/specimen-renderer/network-renderer/getDefaults.tsx","components/specimen-renderer/network-renderer/parseMap.tsx","components/specimen-renderer/network-renderer/Selection.tsx","components/specimen-renderer/network-renderer/selectionInfo.tsx","components/specimen-renderer/network-renderer/NetworkRenderer.tsx","components/specimen-renderer/getRenderer.tsx","components/generic/Toolbar.tsx","components/generic/LazyList.tsx","components/specimen-inspector/EventLabel.tsx","components/generic/Property.tsx","components/specimen-inspector/PropertyList.tsx","components/specimen-inspector/EventInspector.tsx","components/specimen-inspector/EventListInspector.tsx","components/specimen-inspector/InfoPanel.tsx","components/generic/Label.tsx","components/specimen-inspector/SelectionMenu.tsx","components/specimen-inspector/SpecimenInspector.tsx","App.tsx","reportWebVitals.ts","services/ConnectionsService.tsx","hooks/useBreakpoints.tsx","services/PlaybackService.tsx","services/FeaturesService.tsx","hooks/useMapContent.tsx","workers/usingWorker.ts","workers/async.ts","services/SpecimenService.tsx","slices/SliceProvider.tsx","index.tsx"],"names":["vertical","props","Box","position","height","width","display","flexDirection","shadow","constant","backdropFilter","SnackbarContext","createContext","noop","useContext","children","snackPack","setSnackPack","useState","open","setOpen","current","setCurrent","undefined","useEffect","length","prev","slice","handleMessage","useCallback","message","key","Date","getTime","handleClose","_","reason","handleExited","Provider","value","Snackbar","autoHideDuration","onClose","TransitionProps","onExited","action","IconButton","aria-label","color","sx","p","onClick","CloseIcon","px","replace","next","merge","initialState","init","effect","reduce","Store","set","useReducer","n","useMemo","useAsync","r","cache","localStorage","getItem","JSON","parse","setItem","stringify","useConnections","ConnectionsProvider","createSlice","useFeatures","FeaturesProvider","algorithms","maps","formats","returnType","params","join","map","name","type","method","prefix","close","chunks","chunk","split","description","c","makeTypeString","defaultReturnValue","methods","m","makeComment","makeBody","templates","shouldRender","shouldBreak","useUIState","UIStateProvider","code","makeTemplate","values","theme","useTheme","useMediaQuery","breakpoints","down","itemHeight","sm","padding","trigger","items","onChange","placeholder","useSmallDisplay","max","index","findIndex","State","variant","state","Tooltip","title","span","bindTrigger","Menu","bindMenu","anchorOrigin","horizontal","transformOrigin","v","label","MenuItem","selected","TextField","minWidth","select","e","target","item","icon","find","id","Select","startCase","Button","disabled","startIcon","Type","Space","s","pop","shift","customMapId","custom","upload","accept","f","file","strict","ext","format","content","text","Error","mapDefaults","start","end","notify","useSnackbar","connections","algorithm","setUIState","FeaturePicker","MapIcon","url","source","CodeIcon","rest","useSpecimen","SpecimenProvider","specimen","playback","step","ready","playing","eventList","canPlay","canPause","canStop","canStepForward","canStepBackward","stepBy","clamp","play","pause","stop","stepForward","stepBackward","tick","usePlaybackState","PreviousIcon","PauseIcon","PlayIcon","ForwardIcon","StopIcon","threshold","showControls","setShowControls","isAbsoluteTop","setIsAbsoluteTop","isTop","setIsTop","setTarget","lastTop","useRef","listener","newIsTop","scrollTop","Math","abs","addEventListener","passive","removeEventListener","onTarget","onScroll","div","style","overflow","ref","PanelContext","Typography","elevatedStyle","transitionProperties","elevatedChildren","simple","panel","usePanel","useScrollState","styles","background","palette","paper","boxShadow","shadows","AppBar","elevation","primary","transition","transitions","create","Toolbar","marginRight","spacing","edge","ArrowBack","gridColumn","gridRow","flex","Fade","in","mountOnEnter","unmountOnExit","actions","scrollable","setContent","contentRef","setContentRef","hasOverflowingChildren","setHasOverflowingChildren","childHeight","setChildHeight","callback","doesOverflow","window","innerHeight","offsetHeight","ceil","ob","ResizeSensor","detach","useVariant","Dialog","fullScreen","paddingTop","PaperProps","borderRadius","shape","default","maxWidth","ScrollPanel","options","ModalProps","appBar","ModalAppBarProps","PopupState","isOpen","cloneElement","Modal","ModalAppBar","defaultRemotes","transport","defaultPlaybackRate","useSettings","SettingsProvider","remote","playbackRate","withLocalStorage","connect","worker","postMessage","Promise","res","disconnect","terminate","call","rpc","request","IPCWorker","JSONRPCClient","data","receive","uri","protocol","pathname","scheme","decodeURIComponent","internal","trace","version","mapURI","parseURI","includes","handler","hostname","socket","io","response","off","emit","on","transports","socketio","constructor","SocketIOTransport","ipc","IPCTransport","native","NativeTransport","defaultTransport","first","keys","DefaultListEditorInput","forwardRef","InputBase","fullWidth","inputRef","LabelIcon","useSwitch","useDelete","useEdit","useEditButton","onChangeItem","onDeleteItem","enabled","element","i","extrasPlacement","autoFocus","cardStyle","field","setField","alignItems","marginTop","marginBottom","flexGrow","marginLeft","onDelete","onValueChange","Switch","checked","focus","EditIcon","DeleteIcon","Card","borderColor","paddingRight","addItemLabel","onAddItem","placeholderText","getCategory","getOrder","extras","isInitialRender","useInitialRender","intermediateItems","setIntermediateItems","newIndex","setNewIndex","timeout","setTimeout","duration","standard","clearTimeout","uniqBy","c2","x","render","Collapse","appear","ListEditorField","sorted","sortBy","List","subheader","ListSubheader","disableSticky","gutterBottom","mt","out","forEach","isNewCategory","push","some","pl","pb","pt","ml","mb","disableElevation","Add","arr","editor","setState","Editor","handleChange","k","filter","b","Dot","fontSize","transform","my","model","resolve","useLoading","LoadingProvider","setLoading","task","loading","useConnectionResolver","entry","statusColor","connected","connecting","error","connection","useConnection","status","useConnectionStatus","Flex","py","Title","entries","setSettings","ListEditor","ServerEditor","debounce","ResetIcon","formatLabel","tab","setTab","TabContext","TabList","Tab","Divider","TabPanel","renderHeading","renderLabel","Slider","marks","baseRate","min","valueLabelFormat","valueLabelDisplay","defaultValue","onChangeCommitted","ServerListEditor","IconButtonWithTooltip","SettingsIcon","SettingsEditor","bgcolor","whiteSpace","fontWeight","FormControlLabel","control","MuiSwitch","defaultChecked","comparators","apply","a","intrinsicProperties","eventTypes","properties","flexItem","orientation","mx","textOverflow","last","component","property","condition","reference","inputProps","inputMode","pattern","active","propertyPaths","uniq","flat","paths","nodeStructure","get","BreakpointEditor","DELAY","AutoSize","CircularProgress","language","minimap","filename","download","monotonicF","monotonicG","BreakpointListEditor","save","ScriptEditor","BugIcon","DebugOptionsEditor","divider","top","left","zIndex","acrylic","mr","Input","Playback","Utility","Settings","justifyContent","DisabledIcon","getDefaults","wall","h","w","d","grid","y","row","tile","variables","valid","parseMap","node","range","floor","fn","memo","script","Function","tint","parseInt","colorsHex","teal","destination","pink","expanding","deepOrange","generating","yellow","closing","blueGrey","colors","mapValues","hex","orange","scale","devicePixelRatio","size","draw","Graphics","g","WEIGHT","Grid","makeGraphic","alpha","clear","lineStyle","moveTo","lineTo","coerce","obj","x1","y1","radius","resolution","beginFill","drawCircle","endFill","square","drawRect","box","line","x2","y2","Node","Square","Line","defaultCondition","nodes","memoize","NodeList","getColor","isUndefined","isNull","path","keyBy","defined","pId","events","prop","event","PixiViewportBase","register","global","input","equals","world","toWorld","viewport","app","stopPropagation","passiveWheel","drag","pinch","wheel","friction","clampZoom","maxScale","minScale","zoomPercent","equal","Component","PixiComponent","applyProps","RasterRenderer","ViewportProps","StageProps","cursor","Stage","backgroundColor","Viewport","animateScale","animateAlpha","t","useTween","hover","highlight","point","Selected","take","findLastIndex","between","onSelect","selection","setRef","setActive","setHover","bgNodes","bgNodeColor","once","handleClick","info","selectionInfo","getBoundingClientRect","getPoint","handleMouseEvent","delay","onMouseDown","onMouseOver","Nodes","LazyNodes","Overlay","Path","Selection","Guides","vert","mag","log10","lines","verts","startsWith","edges","minX","minY","maxX","maxY","minAt","maxAt","Index","X","Y","minBy","maxBy","renderers","GridRenderer","getGridDefaults","json","xy","NetworkRenderer","getNetworkDefaults","DefaultRenderer","pointerEvents","Stack","direction","renderItem","listOptions","totalCount","itemContent","hidden","Overline","getColorHex","HiddenIcon","opacity","flexWrap","Property","cardStyles","CardActionArea","EventLabel","PropertyList","scrollToIndex","align","behavior","offset","EventInspector","StepsIcon","EventListInspector","secondary","anchorReference","anchorPosition","ListItem","ListItemText","StartIcon","DestinationIcon","Label","ListItemIcon","renderer","getRenderer","setSelection","LinearProgress","createElement","InfoPanel","right","SelectionMenu","Controls","SpecimenInspector","App","reportWebVitals","onPerfEntry","import","then","getCLS","getFID","getFCP","getLCP","getTTFB","ms","timed","from","now","result","any","wait","delta","setConnections","usingLoadingState","useLoadingState","aborted","cs","tp","getTransport","ping","bind","isType","match","lower","cancelled","requestAnimationFrame","useRaf","useBreakpoints","cancellable","trimEnd","withSource","setFeatures","signal","features","getMap","usingWorker","usingWorkerTask","inp","onmessage","hashAsync","HashWorker","solve","hash","encodeURIComponent","setSpecimen","useMapContent","defaults","solution","instances","console","log","slices","services","ConnectionsService","PlaybackService","SpecimenService","FeaturesService","StrictMode","CssBaseline","ThemeProvider","SnackbarProvider","EnvironmentProvider","document","getElementById"],"mappings":"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","file":"static/js/main.53830179.chunk.js","sourcesContent":["import { Box, BoxProps } from \"@material-ui/core\";\r\n\r\nexport type FlexProps = {\r\n  vertical?: boolean;\r\n} & BoxProps;\r\n\r\nexport function Flex({ vertical, ...props }: FlexProps) {\r\n  return (\r\n    <Box\r\n      position=\"relative\"\r\n      height=\"100%\"\r\n      width=\"100%\"\r\n      display=\"flex\"\r\n      flexDirection={vertical ? \"column\" : \"row\"}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n","import { colors, createTheme } from \"@material-ui/core\";\r\nimport { alpha, SxProps, Theme } from \"@material-ui/system\";\r\nimport { constant, times } from \"lodash\";\r\n\r\nconst shadow = `\r\n    0px 8px 18px -1px rgb(0 0 0 / 8%), \r\n    0px 10px 48px 0px rgb(0 0 0 / 1%), \r\n    0px 20px 96px 0px rgb(0 0 0 / 0.5%)\r\n`;\r\n\r\nexport const theme = createTheme({\r\n  palette: {\r\n    primary: colors[\"blueGrey\"],\r\n  },\r\n  shadows: [\"\", ...times(24, constant(shadow))] as any,\r\n});\r\n\r\nexport const acrylic: SxProps<Theme> = {\r\n  backdropFilter: \"blur(5px)\",\r\n  background: ({ palette }) => alpha(palette.background.paper, 0.84),\r\n};\r\n","import { IconButton, Snackbar } from \"@material-ui/core\";\r\nimport { CloseOutlined as CloseIcon } from \"@material-ui/icons\";\r\nimport { noop } from \"lodash\";\r\nimport {\r\n  createContext,\r\n  ReactNode,\r\n  useCallback,\r\n  useContext,\r\n  useEffect,\r\n  useState,\r\n} from \"react\";\r\n\r\nconst SnackbarContext = createContext<(message?: ReactNode) => void>(noop);\r\n\r\nexport interface SnackbarMessage {\r\n  message?: ReactNode;\r\n  key: number;\r\n}\r\n\r\nexport interface State {\r\n  open: boolean;\r\n  snackPack: readonly SnackbarMessage[];\r\n  messageInfo?: SnackbarMessage;\r\n}\r\n\r\nexport function useSnackbar() {\r\n  return useContext(SnackbarContext);\r\n}\r\n\r\nexport function SnackbarProvider({ children }: { children?: ReactNode }) {\r\n  const [snackPack, setSnackPack] = useState<readonly SnackbarMessage[]>([]);\r\n  const [open, setOpen] = useState(false);\r\n  const [current, setCurrent] = useState<SnackbarMessage | undefined>(\r\n    undefined\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (snackPack.length && !current) {\r\n      setCurrent({ ...snackPack[0] });\r\n      setSnackPack((prev) => prev.slice(1));\r\n      setOpen(true);\r\n    } else if (snackPack.length && current && open) {\r\n      setOpen(false);\r\n    }\r\n  }, [snackPack, current, open]);\r\n\r\n  const handleMessage = useCallback(\r\n    (message: ReactNode) => {\r\n      setSnackPack((prev) => [...prev, { message, key: new Date().getTime() }]);\r\n    },\r\n    [setSnackPack]\r\n  );\r\n\r\n  const handleClose = (_: any, reason?: string) => {\r\n    reason !== \"clickaway\" && setOpen(false);\r\n  };\r\n\r\n  const handleExited = () => setCurrent(undefined);\r\n\r\n  return (\r\n    <>\r\n      <SnackbarContext.Provider value={handleMessage}>\r\n        {children}\r\n      </SnackbarContext.Provider>\r\n      <Snackbar\r\n        key={current?.key}\r\n        open={open}\r\n        autoHideDuration={6000}\r\n        onClose={handleClose}\r\n        TransitionProps={{ onExited: handleExited }}\r\n        message={current?.message}\r\n        action={\r\n          <>\r\n            <IconButton\r\n              aria-label=\"close\"\r\n              color=\"inherit\"\r\n              sx={{ p: 0.5 }}\r\n              onClick={handleClose}\r\n            >\r\n              <CloseIcon />\r\n            </IconButton>\r\n          </>\r\n        }\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { Box } from \"@material-ui/core\";\r\nimport { BoxProps } from \"@material-ui/system\";\r\n\r\nexport function Space(props: BoxProps) {\r\n  return <Box px={0.5} display=\"inline-block\" {...props} />;\r\n}\r\n","export type Reducer<T, U = T> = (prev: T, next: U) => T;\n\nexport const replace = (_: any, next: any) => next;\n\nexport const merge = (prev: any, next: any) => ({ ...prev, ...next });\n","import { noop } from \"lodash\";\r\nimport {\r\n  createContext,\r\n  ReactNode,\r\n  useContext,\r\n  useMemo,\r\n  useReducer,\r\n} from \"react\";\r\nimport { useAsync } from \"react-use\";\r\nimport { Reducer, merge } from \"./reducers\";\r\n\r\ntype Slice<T, U = T> = [T, (next: U) => void];\r\n\r\ntype Options<T, U> = {\r\n  init?: () => Promise<U | undefined>;\r\n  effect?: (state: { prev: T; next: T }) => void;\r\n  reduce?: Reducer<T, U>;\r\n};\r\n\r\nexport function createSlice<T, U = T>(\r\n  initialState: T,\r\n  { init, effect, reduce = merge }: Options<T, U> = {}\r\n) {\r\n  const Store = createContext<Slice<T, U>>([initialState, noop]);\r\n  return [\r\n    // Hook\r\n    () => useContext(Store),\r\n    // Context\r\n    ({ children }: { children?: ReactNode }) => {\r\n      const [value, set] = useReducer((p: T, n: U) => {\r\n        const next = reduce(p, n);\r\n        effect?.({ prev: p, next });\r\n        return next;\r\n      }, initialState);\r\n      const slice = useMemo<Slice<T, U>>(() => [value, set], [value, set]);\r\n      useAsync(async () => {\r\n        const r = await init?.();\r\n        if (r) set(r);\r\n      });\r\n      return <Store.Provider value={slice}>{children}</Store.Provider>;\r\n    },\r\n  ] as const;\r\n}\r\n\r\nexport function withLocalStorage<T>(key: string) {\r\n  return {\r\n    init: () => {\r\n      const cache = localStorage.getItem(key);\r\n      if (cache) return JSON.parse(cache);\r\n    },\r\n    effect: ({ next }) => localStorage.setItem(key, JSON.stringify(next)),\r\n  } as Options<T, T>;\r\n}\r\n","import { Transport } from \"client/Transport\";\r\nimport { CheckConnectionResponse } from \"protocol/CheckConnection\";\r\nimport { createSlice } from \"./createSlice\";\r\nimport { replace } from \"./reducers\";\r\n\r\nexport type Connection = CheckConnectionResponse[\"result\"] & {\r\n  call: Transport[\"call\"];\r\n  disconnect: Transport[\"disconnect\"];\r\n  url: string;\r\n  ping: number;\r\n};\r\n\r\nexport const [useConnections, ConnectionsProvider] = createSlice<Connection[]>(\r\n  [],\r\n  { reduce: replace }\r\n);\r\n","import { FeatureDescriptor } from \"protocol/FeatureQuery\";\r\nimport { createSlice } from \"./createSlice\";\r\n\r\ntype FeatureDescriptorWithSource = FeatureDescriptor & {\r\n  source: string;\r\n};\r\n\r\nexport type Features = {\r\n  algorithms: FeatureDescriptorWithSource[];\r\n  maps: (FeatureDescriptorWithSource & { type: string })[];\r\n  formats: FeatureDescriptorWithSource[];\r\n};\r\n\r\nexport const [useFeatures, FeaturesProvider] = createSlice<Features>({\r\n  algorithms: [],\r\n  maps: [],\r\n  formats: [],\r\n});\r\n","import { chunk, join, map, split } from \"lodash\";\r\nimport { FunctionTemplate } from \"./FunctionTemplate\";\r\n\r\ntype GenericFunctionTemplate = FunctionTemplate<[...any], any>;\r\n\r\nfunction makeTypeString({ returnType, params }: GenericFunctionTemplate) {\r\n  return `@type {(${join(\r\n    map(params, (p) => `${p.name}: ${p.type}`),\r\n    \", \"\r\n  )}) => ${returnType}}`;\r\n}\r\n\r\nfunction makeComment(method: GenericFunctionTemplate) {\r\n  const [open, prefix, close] = [\"/**\", \" * \", \" */\"];\r\n  const chunks = map(chunk(split(method.description, \" \"), 9), (c) =>\r\n    join(c, \" \")\r\n  );\r\n  return join(\r\n    [\r\n      open,\r\n      ...map(chunks, (c) => `${prefix}${c}`),\r\n      `${prefix}${makeTypeString(method)}`,\r\n      close,\r\n    ],\r\n    \"\\n\"\r\n  );\r\n}\r\n\r\nfunction makeBody({\r\n  name,\r\n  params,\r\n  defaultReturnValue,\r\n}: GenericFunctionTemplate) {\r\n  return join(\r\n    [\r\n      `function ${name}(${join(map(params, \"name\"), \", \")}) {`,\r\n      `    return ${JSON.stringify(defaultReturnValue)};`,\r\n      `}`,\r\n    ],\r\n    \"\\n\"\r\n  );\r\n}\r\n\r\nexport function makeTemplate(methods?: GenericFunctionTemplate[]) {\r\n  return join(\r\n    map(methods, (m) => join([makeComment(m), makeBody(m)], \"\\n\")),\r\n    \"\\n\\n\"\r\n  );\r\n}\r\n","import { TraceEvent } from \"protocol/Trace\";\r\nimport { FunctionTemplate } from \"./FunctionTemplate\";\r\n\r\nexport type ShouldBreak = FunctionTemplate<\r\n  [number, TraceEvent, TraceEvent[]],\r\n  boolean\r\n>;\r\n\r\nexport const shouldBreak: ShouldBreak = {\r\n  name: \"shouldBreak\",\r\n  description:\r\n    \"Define in what situations the debugger should break, in addition to the conditions defined in the standard options.\",\r\n  params: [\r\n    { name: \"step\", type: \"number\" },\r\n    { name: \"event\", type: \"any\" },\r\n    { name: \"events\", type: \"any\" },\r\n  ],\r\n  defaultReturnValue: false,\r\n  returnType: \"boolean\",\r\n};\r\n\r\nexport type ShouldRender = FunctionTemplate<\r\n  [number, TraceEvent, TraceEvent[]],\r\n  boolean\r\n>;\r\n\r\nexport const shouldRender: ShouldRender = {\r\n  name: \"shouldRender\",\r\n  description: \"Define which objects the renderer should display.\",\r\n  params: [\r\n    { name: \"step\", type: \"number\" },\r\n    { name: \"event\", type: \"any\" },\r\n    { name: \"events\", type: \"any\" },\r\n  ],\r\n  defaultReturnValue: true,\r\n  returnType: \"boolean\",\r\n};\r\n\r\nexport const templates = {\r\n  shouldRender,\r\n  shouldBreak,\r\n};\r\n","import { makeTemplate } from \"components/script-editor/makeTemplate\";\r\nimport { templates } from \"components/script-editor/templates\";\r\nimport { values } from \"lodash\";\r\nimport { Feature } from \"protocol/FeatureQuery\";\r\nimport { TraceEventType } from \"protocol/Trace\";\r\nimport { createSlice } from \"./createSlice\";\r\n\r\nexport type PlaybackStateType = \"playing\" | \"paused\" | undefined;\r\n\r\ntype PlaybackState = { playback?: PlaybackStateType; step?: number };\r\n\r\nexport type Map = Partial<\r\n  Feature & {\r\n    format: string;\r\n    source?: string;\r\n  }\r\n>;\r\n\r\ntype InputState = {\r\n  algorithm?: string;\r\n  map?: Map;\r\n};\r\n\r\nexport type Comparator = {\r\n  key: string;\r\n  apply: (value: number, reference: number) => boolean;\r\n};\r\n\r\nexport type Breakpoint = {\r\n  key: string;\r\n  property?: string;\r\n  reference?: number;\r\n  condition?: Comparator;\r\n  active?: boolean;\r\n  type?: TraceEventType;\r\n};\r\n\r\ntype DebugOptionsState = {\r\n  code?: string;\r\n  monotonicF?: boolean;\r\n  monotonicG?: boolean;\r\n  breakpoints?: Breakpoint[];\r\n};\r\n\r\ntype SpecimenState = {\r\n  start?: number;\r\n  end?: number;\r\n};\r\n\r\nexport type UIState = InputState &\r\n  PlaybackState &\r\n  DebugOptionsState &\r\n  SpecimenState;\r\n\r\nexport const [useUIState, UIStateProvider] = createSlice<\r\n  UIState,\r\n  Partial<UIState>\r\n>({\r\n  code: makeTemplate(values(templates)),\r\n});\r\n","import { useMediaQuery, useTheme } from \"@material-ui/core\";\r\n\r\nexport function useSmallDisplay() {\r\n  const theme = useTheme();\r\n  return useMediaQuery(theme.breakpoints.down(\"sm\"));\r\n}\r\n","import {\r\n  Menu,\r\n  MenuItem,\r\n  TextField,\r\n  TextFieldProps,\r\n  Tooltip,\r\n} from \"@material-ui/core\";\r\nimport { useSmallDisplay } from \"hooks/useSmallDisplay\";\r\nimport { findIndex, map, max } from \"lodash\";\r\nimport State, { bindMenu, bindTrigger } from \"material-ui-popup-state\";\r\nimport { ReactElement, ReactNode } from \"react\";\r\n\r\ntype Key = string | number;\r\n\r\nexport type SelectProps<T extends Key> = {\r\n  trigger?: (props: ReturnType<typeof bindTrigger>) => ReactElement;\r\n  items?: { value: T; label?: ReactNode }[];\r\n  value?: T;\r\n  onChange?: (value: T) => void;\r\n  placeholder?: string;\r\n};\r\n\r\nconst itemHeight = (sm: boolean) => (sm ? 48 : 36);\r\nconst padding = 8;\r\n\r\nexport function Select<T extends string>({\r\n  trigger,\r\n  items,\r\n  value,\r\n  onChange,\r\n  placeholder = \"Select Option\",\r\n}: SelectProps<T>) {\r\n  const sm = useSmallDisplay();\r\n  const index = max([findIndex(items, { value: value as any }), 0]) ?? 0;\r\n  return (\r\n    <State variant=\"popover\">\r\n      {(state) => (\r\n        <>\r\n          <Tooltip title={placeholder}>\r\n            <span>{trigger?.(bindTrigger(state))}</span>\r\n          </Tooltip>\r\n          <Menu\r\n            {...bindMenu(state)}\r\n            anchorOrigin={{\r\n              horizontal: \"center\",\r\n              vertical: -itemHeight(sm) * index - padding,\r\n            }}\r\n            transformOrigin={{\r\n              vertical: \"top\",\r\n              horizontal: \"center\",\r\n            }}\r\n          >\r\n            {map(items, ({ value: v, label }) => (\r\n              <MenuItem\r\n                key={v}\r\n                value={v}\r\n                selected={v === value}\r\n                onClick={() => {\r\n                  state.close();\r\n                  onChange?.(v);\r\n                }}\r\n              >\r\n                {label}\r\n              </MenuItem>\r\n            ))}\r\n          </Menu>\r\n        </>\r\n      )}\r\n    </State>\r\n  );\r\n}\r\n\r\nexport type SelectFieldProps<T extends string> = Pick<\r\n  SelectProps<T>,\r\n  \"items\" | \"onChange\"\r\n> &\r\n  Omit<TextFieldProps, \"onChange\">;\r\n\r\nexport function SelectField<T extends string>(props: SelectFieldProps<T>) {\r\n  const { placeholder, value, items = [], onChange } = props;\r\n  return (\r\n    <TextField\r\n      sx={{ minWidth: 120 }}\r\n      select\r\n      label={placeholder}\r\n      value={value}\r\n      variant=\"filled\"\r\n      {...props}\r\n      onChange={(e) => onChange?.(e.target.value as T)}\r\n    >\r\n      {map(items, (item) => (\r\n        <MenuItem key={item.value} value={item.value}>\r\n          {item.label}\r\n        </MenuItem>\r\n      ))}\r\n    </TextField>\r\n  );\r\n}\r\n","import { Button, Typography as Type } from \"@material-ui/core\";\r\nimport { Select } from \"components/generic/Select\";\r\nimport { Space } from \"components/generic/Space\";\r\nimport { find, map, startCase } from \"lodash\";\r\nimport { FeatureDescriptor } from \"protocol/FeatureQuery\";\r\nimport { ReactNode } from \"react\";\r\n\r\ntype Props = {\r\n  label?: string;\r\n  value?: string;\r\n  onChange?: (key: string) => void;\r\n  items?: FeatureDescriptor[];\r\n  icon?: ReactNode;\r\n};\r\n\r\nexport function FeaturePicker({ label, value, onChange, items, icon }: Props) {\r\n  const selected = find(items, { id: value });\r\n  return (\r\n    <Select\r\n      placeholder={startCase(label)}\r\n      trigger={(props) => (\r\n        <Button {...props} disabled={!items?.length} startIcon={icon}>\r\n          {selected?.name ?? label}\r\n        </Button>\r\n      )}\r\n      items={map(items, ({ id, name, description }) => ({\r\n        value: id,\r\n        label: (\r\n          <>\r\n            <Type>{name}</Type>\r\n            <Space />\r\n            <Type variant=\"body2\" color=\"textSecondary\">\r\n              {description}\r\n            </Type>\r\n          </>\r\n        ),\r\n      }))}\r\n      value={selected?.id}\r\n      onChange={onChange}\r\n    />\r\n  );\r\n}\r\n","import { fileDialog as file } from \"file-select-dialog\";\nimport { find, startCase } from \"lodash\";\nimport { Feature, FeatureDescriptor } from \"protocol/FeatureQuery\";\n\nfunction ext(s: string) {\n  return s.split(\".\").pop();\n}\nfunction name(s: string) {\n  return s.split(\".\").shift();\n}\n\nconst customMapId = \"internal/custom\";\n\nexport const custom = (map?: Partial<Feature>) => ({\n  name: map?.id === customMapId ? `Custom - ${map?.name}` : \"Custom\",\n  description: \"Import Map\",\n  id: customMapId,\n});\n\nexport async function upload(accept: FeatureDescriptor[]) {\n  const f = await file({\n    accept: accept.map(({ id }) => `.${id}`),\n    strict: true,\n  });\n  if (f) {\n    if (find(accept, { id: ext(f.name) })) {\n      return {\n        ...custom(),\n        format: ext(f.name),\n        content: await f.text(),\n        name: startCase(name(f.name)),\n      } as Feature;\n    } else {\n      throw new Error(`The format (${ext(f.name)}) is unsupported.`);\n    }\n  }\n}\n","import { Code as CodeIcon, MapTwoTone as MapIcon } from \"@material-ui/icons\";\r\nimport { useSnackbar } from \"components/generic/Snackbar\";\r\nimport { Space } from \"components/generic/Space\";\r\nimport { find } from \"lodash\";\r\nimport { useConnections } from \"slices/connections\";\r\nimport { useFeatures } from \"slices/features\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { FeaturePicker } from \"./FeaturePicker\";\r\nimport { custom, upload } from \"./upload\";\r\n\r\nexport const mapDefaults = { start: undefined, end: undefined };\r\n\r\nexport function Input() {\r\n  const notify = useSnackbar();\r\n  const [connections] = useConnections();\r\n  const [{ algorithms, maps, formats }] = useFeatures();\r\n  const [{ algorithm, map }, setUIState] = useUIState();\r\n\r\n  return (\r\n    <>\r\n      <FeaturePicker\r\n        icon={<MapIcon />}\r\n        label=\"map\"\r\n        value={map?.id}\r\n        items={[\r\n          custom(map),\r\n          ...maps.map((c) => ({\r\n            ...c,\r\n            description: find(connections, { url: c.source })?.name,\r\n          })),\r\n        ]}\r\n        onChange={async (v) => {\r\n          switch (v) {\r\n            case custom().id:\r\n              try {\r\n                const f = await upload(formats);\r\n                if (f) setUIState({ ...mapDefaults, map: f });\r\n              } catch (e) {\r\n                notify(`${e}`);\r\n              }\r\n              break;\r\n            default:\r\n              setUIState({ ...mapDefaults, map: find(maps, { id: v }) });\r\n              break;\r\n          }\r\n        }}\r\n      />\r\n      <Space />\r\n      <FeaturePicker\r\n        icon={<CodeIcon />}\r\n        label=\"algorithm\"\r\n        value={algorithm}\r\n        items={algorithms.map((c) => ({\r\n          ...c,\r\n          description: find(connections, { url: c.source })?.name,\r\n        }))}\r\n        onChange={(v) => setUIState({ algorithm: v })}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { IconButton, IconButtonProps, Tooltip } from \"@material-ui/core\";\r\nimport { startCase } from \"lodash\";\r\nimport { ReactNode } from \"react\";\r\n\r\ntype IconButtonWithTooltipProps = {\r\n  label: string;\r\n  icon: ReactNode;\r\n} & IconButtonProps;\r\n\r\nexport function IconButtonWithTooltip({\r\n  label,\r\n  icon,\r\n  ...rest\r\n}: IconButtonWithTooltipProps) {\r\n  return (\r\n    <Tooltip title={startCase(label)} key={label}>\r\n      <span>\r\n        <IconButton {...rest}>{icon}</IconButton>\r\n      </span>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { createSlice } from \"./createSlice\";\r\nimport { Trace } from \"protocol/Trace\";\r\nimport { PathfindingTask } from \"protocol/SolveTask\";\r\nimport { ParamsOf } from \"protocol/Message\";\r\n\r\ntype Specimen = {\r\n  specimen?: Trace;\r\n  map?: string;\r\n} & Partial<ParamsOf<PathfindingTask>>;\r\n\r\nexport const [useSpecimen, SpecimenProvider] = createSlice<Specimen>({});\r\n","import { clamp } from \"lodash\";\r\nimport { useMemo } from \"react\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\n\r\nexport function usePlaybackState() {\r\n  const [{ specimen }] = useSpecimen();\r\n  const [{ playback, step = 0 }, setUIState] = useUIState();\r\n\r\n  const ready = !!specimen;\r\n  const playing = playback === \"playing\";\r\n  const [start, end] = [0, (specimen?.eventList?.length ?? 1) - 1];\r\n\r\n  return useMemo(() => {\r\n    const state = {\r\n      start,\r\n      end,\r\n      step,\r\n      canPlay: ready && !playing && step < end,\r\n      canPause: ready && playing,\r\n      canStop: ready,\r\n      canStepForward: ready && !playing && step < end,\r\n      canStepBackward: ready && !playing && step > 0,\r\n    };\r\n\r\n    const stepBy = (n: number) => clamp(step + n, start, end);\r\n\r\n    const callbacks = {\r\n      play: () => setUIState({ playback: \"playing\", step: stepBy(1) }),\r\n      pause: (n = 0) => setUIState({ playback: \"paused\", step: stepBy(n) }),\r\n      stop: () => setUIState({ step: start, playback: \"paused\" }),\r\n      stepForward: () => setUIState({ step: stepBy(1) }),\r\n      stepBackward: () => setUIState({ step: stepBy(-1) }),\r\n      tick: (n = 1) => setUIState({ playback: \"playing\", step: stepBy(n) }),\r\n    };\r\n\r\n    return {\r\n      playing: playback === \"playing\",\r\n      ...state,\r\n      ...callbacks,\r\n    };\r\n  }, [end, playback, playing, ready, setUIState, start, step]);\r\n}\r\n","import {\r\n  PauseOutlined as PauseIcon,\r\n  PlayArrowOutlined as PlayIcon,\r\n  SkipNextOutlined as ForwardIcon,\r\n  SkipPreviousOutlined as PreviousIcon,\r\n  StopOutlined as StopIcon,\r\n} from \"@material-ui/icons\";\r\nimport { IconButtonWithTooltip as Button } from \"components/generic/IconButtonWithTooltip\";\r\nimport { usePlaybackState } from \"hooks/usePlaybackState\";\r\n\r\nexport function Playback() {\r\n  const {\r\n    playing,\r\n    canPause,\r\n    canPlay,\r\n    canStepBackward,\r\n    canStepForward,\r\n    canStop,\r\n    pause,\r\n    play,\r\n    stepBackward,\r\n    stepForward,\r\n    stop,\r\n  } = usePlaybackState();\r\n  return (\r\n    <>\r\n      <Button\r\n        label=\"step-backward\"\r\n        icon={<PreviousIcon />}\r\n        onClick={stepBackward}\r\n        disabled={!canStepBackward}\r\n      />\r\n      <Button\r\n        {...(playing\r\n          ? {\r\n              label: \"pause\",\r\n              icon: <PauseIcon />,\r\n              onClick: () => pause(),\r\n              disabled: !canPause,\r\n            }\r\n          : {\r\n              label: \"play\",\r\n              icon: <PlayIcon />,\r\n              onClick: () => play(),\r\n              disabled: !canPlay,\r\n              color: \"primary\",\r\n            })}\r\n      />\r\n      <Button\r\n        label=\"step-forward\"\r\n        icon={<ForwardIcon />}\r\n        onClick={stepForward}\r\n        disabled={!canStepForward}\r\n      />\r\n      <Button\r\n        label=\"stop\"\r\n        icon={<StopIcon />}\r\n        onClick={stop}\r\n        disabled={!canStop}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { useEffect, useRef, useState } from \"react\";\r\n\r\nexport function useScrollState(threshold: number = 128) {\r\n  const [showControls, setShowControls] = useState(true);\r\n  const [isAbsoluteTop, setIsAbsoluteTop] = useState(true);\r\n  const [isTop, setIsTop] = useState(true);\r\n  const [target, setTarget] = useState<HTMLElement | null>(null);\r\n  const lastTop = useRef(0);\r\n  useEffect(() => {\r\n    if (target) {\r\n      const listener = () => {\r\n        {\r\n          const newIsTop = target.scrollTop <= threshold;\r\n          if (newIsTop !== isTop) {\r\n            setIsTop(newIsTop);\r\n          }\r\n        }\r\n        {\r\n          const newIsTop = target.scrollTop <= 1;\r\n          if (newIsTop !== isAbsoluteTop) {\r\n            setIsAbsoluteTop(newIsTop);\r\n          }\r\n        }\r\n        if (lastTop.current - target.scrollTop) {\r\n          if (\r\n            Math.abs(lastTop.current - target.scrollTop) > 2 &&\r\n            lastTop.current >= 0\r\n          ) {\r\n            setShowControls(lastTop.current > target.scrollTop);\r\n          }\r\n          lastTop.current = target.scrollTop;\r\n        }\r\n      };\r\n      target.addEventListener(\"scroll\", listener, { passive: true });\r\n      return () => {\r\n        target.removeEventListener(\"scroll\", listener);\r\n      };\r\n    }\r\n  }, [target, isTop, isAbsoluteTop, lastTop, threshold]);\r\n  return [\r\n    showControls || isTop,\r\n    isTop,\r\n    isAbsoluteTop,\r\n    target,\r\n    setTarget,\r\n  ] as const;\r\n}\r\n","import {\r\n  ComponentProps,\r\n  createContext,\r\n  useContext,\r\n  useEffect,\r\n  useState,\r\n} from \"react\";\r\n\r\ntype ScrollPanelProps = {\r\n  onTarget?: (e: HTMLDivElement | null) => void;\r\n} & ComponentProps<\"div\">;\r\n\r\nexport function ScrollPanel({\r\n  onTarget,\r\n  onScroll,\r\n  ...props\r\n}: ScrollPanelProps) {\r\n  const [target, setTarget] = useState<HTMLDivElement | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (target && onScroll) {\r\n      target.addEventListener(\"scroll\", onScroll as any, { passive: true });\r\n      return () => target.removeEventListener(\"scroll\", onScroll as any);\r\n    }\r\n  }, [target, onScroll]);\r\n\r\n  return (\r\n    <div\r\n      {...props}\r\n      style={{\r\n        height: \"100%\",\r\n        width: \"100%\",\r\n        overflow: \"hidden scroll\",\r\n        ...props.style,\r\n      }}\r\n      ref={(e) => {\r\n        setTarget(e);\r\n        onTarget?.(e);\r\n      }}\r\n    >\r\n      <PanelContext.Provider value={target}>\r\n        <div\r\n          style={{\r\n            width: \"100%\",\r\n          }}\r\n        >\r\n          {props.children}\r\n        </div>\r\n      </PanelContext.Provider>\r\n    </div>\r\n  );\r\n}\r\nconst PanelContext = createContext<HTMLDivElement | null>(null);\r\n\r\nexport function usePanel() {\r\n  return useContext(PanelContext);\r\n}\r\n","import {\r\n  AppBar,\r\n  Box,\r\n  Dialog,\r\n  Fade,\r\n  IconButton,\r\n  Toolbar,\r\n  Typography,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport { ArrowBack } from \"@material-ui/icons\";\r\nimport { ResizeSensor } from \"css-element-queries\";\r\nimport PopupState from \"material-ui-popup-state\";\r\nimport {\r\n  cloneElement,\r\n  ComponentProps,\r\n  CSSProperties,\r\n  ReactElement,\r\n  ReactNode,\r\n  SyntheticEvent,\r\n  useEffect,\r\n  useState,\r\n} from \"react\";\r\nimport { useScrollState } from \"hooks/useScrollState\";\r\nimport { useSmallDisplay } from \"hooks/useSmallDisplay\";\r\nimport { ScrollPanel, usePanel } from \"./ScrollPanel\";\r\n\r\nexport function AppBarTitle({ children }: { children?: ReactNode }) {\r\n  return <Typography variant=\"h6\">{children}</Typography>;\r\n}\r\n\r\nexport type Props = {\r\n  children?: ReactNode;\r\n  actions?: ReactNode;\r\n  width?: number;\r\n  height?: string | number;\r\n  onTarget?: (target: HTMLDivElement | null) => void;\r\n  variant?: \"default\" | \"submodal\";\r\n  scrollable?: boolean;\r\n};\r\n\r\ntype ModalAppBarProps = {\r\n  onClose?: () => void;\r\n  style?: CSSProperties;\r\n  elevatedStyle?: CSSProperties;\r\n  transitionProperties?: string[];\r\n  children?: ReactNode;\r\n  elevatedChildren?: ReactNode;\r\n  simple?: boolean;\r\n  position?: \"fixed\" | \"absolute\" | \"sticky\" | \"static\";\r\n};\r\n\r\nexport function ModalAppBar({\r\n  onClose = () => {},\r\n  style,\r\n  elevatedStyle,\r\n  children,\r\n  transitionProperties = [\"box-shadow\", \"background\", \"border-bottom\"],\r\n  elevatedChildren,\r\n  simple,\r\n  position = \"sticky\",\r\n}: ModalAppBarProps) {\r\n  const panel = usePanel();\r\n  const theme = useTheme();\r\n  const [, , isAbsoluteTop, , setTarget] = useScrollState();\r\n  useEffect(() => {\r\n    setTarget(panel);\r\n  }, [panel, setTarget]);\r\n\r\n  const styles = isAbsoluteTop\r\n    ? {\r\n        background: theme.palette.background.paper,\r\n        ...(!simple && {\r\n          boxShadow: theme.shadows[0],\r\n        }),\r\n        ...style,\r\n      }\r\n    : {\r\n        background: theme.palette.background.paper,\r\n        ...(!simple && {\r\n          boxShadow: theme.shadows[4],\r\n        }),\r\n        ...elevatedStyle,\r\n      };\r\n\r\n  return (\r\n    <AppBar\r\n      elevation={0}\r\n      position={position}\r\n      style={{\r\n        color: theme.palette.text.primary,\r\n        transition: theme.transitions.create(transitionProperties),\r\n        ...styles,\r\n      }}\r\n    >\r\n      <Toolbar>\r\n        <IconButton\r\n          style={{\r\n            marginRight: theme.spacing(1),\r\n          }}\r\n          aria-label=\"open drawer\"\r\n          edge=\"start\"\r\n          onClick={() => onClose()}\r\n        >\r\n          <ArrowBack />\r\n        </IconButton>\r\n\r\n        {children && (\r\n          <div\r\n            style={{\r\n              gridColumn: 1,\r\n              gridRow: 1,\r\n              flex: 1,\r\n              overflow: \"auto\",\r\n            }}\r\n          >\r\n            <Fade\r\n              in={!!(!elevatedChildren || isAbsoluteTop)}\r\n              mountOnEnter\r\n              unmountOnExit\r\n            >\r\n              <Box style={{ width: \"100%\" }}>{children}</Box>\r\n            </Fade>\r\n          </div>\r\n        )}\r\n        {elevatedChildren && (\r\n          <div\r\n            style={{\r\n              gridColumn: 1,\r\n              gridRow: 1,\r\n              flex: 1,\r\n              overflow: \"auto\",\r\n            }}\r\n          >\r\n            <Fade\r\n              in={!!(elevatedChildren && !isAbsoluteTop)}\r\n              mountOnEnter\r\n              unmountOnExit\r\n            >\r\n              <Box style={{ width: \"100%\" }}>{elevatedChildren}</Box>\r\n            </Fade>\r\n          </div>\r\n        )}\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n\r\nexport default function Modal({\r\n  children,\r\n  actions,\r\n  width = 480,\r\n  height,\r\n  onTarget,\r\n  variant = \"default\",\r\n  scrollable = true,\r\n  ...props\r\n}: Props & ComponentProps<typeof Dialog>) {\r\n  const [content, setContent] = useState<ReactNode | undefined>(undefined);\r\n  useEffect(() => {\r\n    if (children) setContent(children);\r\n  }, [children]);\r\n  const theme = useTheme();\r\n  const sm = useSmallDisplay();\r\n\r\n  const [target, setTarget] = useState<HTMLElement | null>(null);\r\n  const [contentRef, setContentRef] = useState<HTMLElement | null>(null);\r\n  const [hasOverflowingChildren, setHasOverflowingChildren] = useState(false);\r\n  const [childHeight, setChildHeight] = useState(0);\r\n\r\n  useEffect(() => {\r\n    if (target && contentRef && !sm && !height) {\r\n      const callback = () => {\r\n        const doesOverflow = window.innerHeight - 64 < contentRef.offsetHeight;\r\n        setHasOverflowingChildren(doesOverflow);\r\n        setChildHeight(\r\n          contentRef.offsetHeight <= 1 ? 0 : Math.ceil(contentRef.offsetHeight)\r\n        );\r\n      };\r\n      window.addEventListener(\"resize\", callback);\r\n      const ob = new ResizeSensor(contentRef, callback);\r\n      callback();\r\n      return () => {\r\n        window.removeEventListener(\"resize\", callback);\r\n        ob.detach();\r\n      };\r\n    }\r\n  }, [target, contentRef, sm, height]);\r\n\r\n  const useVariant = variant === \"submodal\" && sm;\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={sm}\r\n      {...props}\r\n      style={{\r\n        ...(useVariant && {\r\n          paddingTop: theme.spacing(8),\r\n        }),\r\n        ...props.style,\r\n      }}\r\n      PaperProps={{\r\n        ref: (e: HTMLElement | null) => setTarget(e),\r\n        style: {\r\n          ...(useVariant && {\r\n            borderRadius: `${theme.shape.borderRadius}px ${theme.shape.borderRadius}px 0 0`,\r\n          }),\r\n          background: theme.palette.background.default,\r\n          overflow: \"hidden\",\r\n          height:\r\n            height && !sm\r\n              ? height\r\n              : hasOverflowingChildren || sm\r\n              ? \"100%\"\r\n              : childHeight || \"fit-content\",\r\n          position: \"relative\",\r\n          maxWidth: \"none\",\r\n          ...props.PaperProps?.style,\r\n        },\r\n        ...props.PaperProps,\r\n      }}\r\n    >\r\n      <ScrollPanel\r\n        style={{\r\n          height: \"100%\",\r\n          width: sm ? undefined : width,\r\n          maxWidth: \"100%\",\r\n          overflow: scrollable ? undefined : \"hidden\",\r\n        }}\r\n        onTarget={onTarget}\r\n      >\r\n        <div\r\n          ref={(e) => setContentRef(e)}\r\n          style={{ width: \"100%\", height: \"100%\" }}\r\n        >\r\n          {content}\r\n        </div>\r\n      </ScrollPanel>\r\n      {actions}\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport function ManagedModal({\r\n  options: ModalProps,\r\n  appBar: ModalAppBarProps,\r\n  trigger = () => <></>,\r\n  children,\r\n}: {\r\n  options?: Props;\r\n  trigger?: (onClick: (e: SyntheticEvent<any, Event>) => void) => ReactElement;\r\n  appBar?: ModalAppBarProps;\r\n  children?: ReactNode;\r\n}) {\r\n  return (\r\n    <PopupState variant=\"popover\">\r\n      {({ open, close, isOpen }) => {\r\n        return (\r\n          <>\r\n            {cloneElement(trigger(open))}\r\n            <Modal open={isOpen} onClose={close} {...ModalProps}>\r\n              <ModalAppBar onClose={close} {...ModalAppBarProps} />\r\n              {children ?? ModalProps?.children}\r\n            </Modal>\r\n          </>\r\n        );\r\n      }}\r\n    </PopupState>\r\n  );\r\n}\r\n","import { createSlice, withLocalStorage } from \"./createSlice\";\r\n\r\nexport type Remote = {\r\n  url: string;\r\n  transport: string;\r\n  key: string;\r\n  disabled?: boolean;\r\n};\r\n\r\ntype Settings = {\r\n  remote?: Remote[];\r\n  playbackRate?: number;\r\n};\r\n\r\nconst DEV_PORT = 8001;\r\n\r\nexport const defaultRemotes = [\r\n  {\r\n    url: `internal://trace/`,\r\n    transport: \"native\",\r\n    key: \"trace-provider\",\r\n  },\r\n  {\r\n    url: `http://localhost:${DEV_PORT}/`,\r\n    transport: \"socketio\",\r\n    key: \"default-development-server\",\r\n  },\r\n  {\r\n    url: `https://rachmaninoff.duckdns.org/`,\r\n    transport: \"socketio\",\r\n    key: \"legacy-production-server\",\r\n  },\r\n];\r\n\r\nexport const defaultPlaybackRate = 4;\r\n\r\nexport const [useSettings, SettingsProvider] = createSlice<Settings>(\r\n  {\r\n    remote: defaultRemotes,\r\n    playbackRate: defaultPlaybackRate,\r\n  },\r\n  withLocalStorage(\"settings\")\r\n);\r\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/hash.worker.ac18d53b.worker.js\");\n}\n","import { JSONRPCClient, JSONRPCResponse as Response } from \"json-rpc-2.0\";\nimport { NameMethodMap } from \"protocol\";\nimport { Request, RequestOf, ResponseOf } from \"protocol/Message\";\nimport { IPCWorker } from \"workers\";\nimport { Transport, TransportOptions } from \"./Transport\";\n\nexport class IPCTransport implements Transport {\n  worker: IPCWorker;\n  rpc: JSONRPCClient;\n\n  constructor(readonly options: TransportOptions) {\n    this.worker = new IPCWorker();\n    this.rpc = new JSONRPCClient(async (request: Request) => {\n      const listener = ({ data }: MessageEvent<Response>) => {\n        if (data.id === request.id) {\n          this.worker.removeEventListener(\"message\", listener);\n          this.rpc.receive(data);\n        }\n      };\n      this.worker.postMessage(request);\n      this.worker.addEventListener(\"message\", listener);\n    });\n  }\n\n  connect() {\n    this.worker.postMessage(this.options.url);\n    return new Promise<void>((res) => {\n      const listener = () => {\n        res();\n        this.worker.removeEventListener(\"message\", listener);\n      };\n      this.worker.addEventListener(\"message\", listener);\n    });\n  }\n\n  async disconnect() {\n    this.worker.terminate();\n  }\n\n  async call<T extends keyof NameMethodMap>(\n    name: T,\n    params?: RequestOf<NameMethodMap[T]>[\"params\"]\n  ): Promise<ResponseOf<NameMethodMap[T]>[\"result\"]> {\n    return await this.rpc.request(name, params);\n  }\n}\n","import { PathfindingTask, Scheme } from \"protocol/SolveTask\";\nimport { Transport } from \"./Transport\";\nimport url from \"url-parse\";\nimport { Dictionary } from \"lodash\";\n\nexport function parseURI(uri: string) {\n  const { protocol, pathname } = url(uri);\n  return {\n    scheme: protocol as Scheme,\n    content: decodeURIComponent(pathname),\n  };\n}\n\nexport const internal: Dictionary<Transport[\"call\"]> = {\n  trace: async (name, params) => {\n    switch (name) {\n      case \"about\":\n        return {\n          name: \"Search Trace\",\n          description: \"Provides JSON Search Trace Support\",\n          version: \"1.0.2\",\n        };\n      case \"features/formats\":\n        return [\n          {\n            id: \"json\",\n            name: \"Search Trace\",\n          },\n        ];\n      case \"solve/pathfinding\":\n        const { mapURI } = (params as PathfindingTask[\"params\"])!;\n        const { scheme, content } = parseURI(mapURI);\n        if ([\"map:\", \"trace:\"].includes(scheme)) return JSON.parse(content);\n    }\n  },\n};\n","import { NameMethodMap } from \"protocol\";\nimport { RequestOf, ResponseOf } from \"protocol/Message\";\nimport { Transport, TransportOptions } from \"./Transport\";\nimport url from \"url-parse\";\nimport { internal } from \"./internal\";\n\nexport class NativeTransport implements Transport {\n  handler: Transport[\"call\"];\n  constructor(readonly options: TransportOptions) {\n    const { hostname } = url(options.url);\n    this.handler = internal[hostname];\n  }\n\n  async connect() {}\n\n  async disconnect() {}\n\n  async call<T extends keyof NameMethodMap>(\n    name: T,\n    params?: RequestOf<NameMethodMap[T]>[\"params\"]\n  ): Promise<ResponseOf<NameMethodMap[T]>[\"result\"]> {\n    return await this.handler(name, params);\n  }\n}\n","import { JSONRPCClient, JSONRPCResponse as Response } from \"json-rpc-2.0\";\r\nimport { NameMethodMap } from \"protocol\";\r\nimport { Request, RequestOf, ResponseOf } from \"protocol/Message\";\r\nimport { io, Socket } from \"socket.io-client\";\r\nimport { Transport, TransportOptions } from \"./Transport\";\r\n\r\nexport class SocketIOTransport implements Transport {\r\n  rpc: JSONRPCClient;\r\n  socket: Socket;\r\n\r\n  constructor(readonly options: TransportOptions) {\r\n    this.socket = io(options.url);\r\n    this.rpc = new JSONRPCClient(async (request: Request) => {\r\n      const listener = (response: Response) => {\r\n        if (response.id === request.id) {\r\n          this.socket.off(\"response\", listener);\r\n          this.rpc.receive(response);\r\n        }\r\n      };\r\n      this.socket.emit(\"request\", request);\r\n      this.socket.on(\"response\", listener);\r\n    });\r\n  }\r\n\r\n  async connect() {\r\n    this.socket.connect();\r\n  }\r\n\r\n  async disconnect() {\r\n    this.socket.disconnect();\r\n  }\r\n\r\n  async call<T extends keyof NameMethodMap>(\r\n    name: T,\r\n    params?: RequestOf<NameMethodMap[T]>[\"params\"]\r\n  ): Promise<ResponseOf<NameMethodMap[T]>[\"result\"]> {\r\n    return await this.rpc.request(name, params);\r\n  }\r\n}\r\n","import { Dictionary, first, keys } from \"lodash\";\nimport { IPCTransport } from \"./IPCTransport\";\nimport { NativeTransport } from \"./NativeTransport\";\nimport { SocketIOTransport } from \"./SocketIOTransport\";\nimport { TransportConstructor } from \"./Transport\";\n\ntype TransportEntry = {\n  name: string;\n  constructor: TransportConstructor;\n};\n\nexport const transports: Dictionary<TransportEntry> = {\n  socketio: { name: \"socket.io\", constructor: SocketIOTransport },\n  ipc: { name: \"Web Worker\", constructor: IPCTransport },\n  native: { name: \"Internal\", constructor: NativeTransport },\n};\n\nexport function getTransport(key: string) {\n  return transports[key].constructor;\n}\n\nexport const defaultTransport = first(keys(transports))!;\n","import {\r\n  Box,\r\n  Button,\r\n  Card,\r\n  Collapse,\r\n  IconButton,\r\n  InputBase,\r\n  List,\r\n  ListSubheader,\r\n  Switch,\r\n  Typography,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport {\r\n  Add,\r\n  DeleteOutlined as DeleteIcon,\r\n  EditOutlined as EditIcon,\r\n  LabelOutlined as LabelIcon,\r\n} from \"@material-ui/icons\";\r\nimport { filter, map, sortBy, uniqBy } from \"lodash\";\r\nimport { nanoid as id } from \"nanoid\";\r\nimport {\r\n  cloneElement,\r\n  ComponentProps,\r\n  CSSProperties,\r\n  forwardRef,\r\n  ReactElement,\r\n  ReactNode,\r\n  useEffect,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\n\r\nexport const DefaultListEditorInput = forwardRef(function StyledInputBase(\r\n  props: ComponentProps<typeof InputBase>,\r\n  ref\r\n) {\r\n  return (\r\n    <InputBase\r\n      fullWidth\r\n      {...props}\r\n      placeholder=\"Untitled item\"\r\n      inputRef={ref}\r\n    />\r\n  );\r\n});\r\n\r\ntype Key = string | number;\r\n\r\ntype Item<T = any> = {\r\n  element?: ReactElement;\r\n  enabled?: boolean;\r\n  value?: T;\r\n  id: Key;\r\n};\r\n\r\ntype Props<T = any> = {\r\n  extras?: ReactNode;\r\n  addItemLabel?: ReactNode;\r\n  label?: ReactNode;\r\n  text?: ReactNode;\r\n  items?: Item<T>[];\r\n  useSwitch?: boolean;\r\n  useDelete?: boolean;\r\n  onChangeItem?: (key: Key, value: T, enabled: boolean) => void;\r\n  onAddItem?: () => void;\r\n  onDeleteItem?: (key: Key) => void;\r\n  icon?: ReactElement | null;\r\n  useEdit?: boolean;\r\n  variant?: \"outlined\" | \"default\";\r\n  extrasPlacement?: \"flex-start\" | \"center\" | \"flex-end\";\r\n  placeholderText?: ReactNode;\r\n  cardStyle?: CSSProperties;\r\n  autoFocus?: boolean;\r\n  getCategory?: (value?: T) => string;\r\n  getOrder?: (value?: T) => string | number;\r\n};\r\n\r\ntype ListEditorFieldProps = {\r\n  isPlaceholder?: boolean;\r\n  i?: number;\r\n};\r\n\r\nfunction useInitialRender() {\r\n  const ref = useRef(false);\r\n  const current = ref.current;\r\n  ref.current = true;\r\n  return !current;\r\n}\r\n\r\nexport function ListEditorField({\r\n  icon = <LabelIcon />,\r\n  useSwitch,\r\n  useDelete,\r\n  useEdit: useEditButton = true,\r\n  onChangeItem = () => {},\r\n  onDeleteItem = () => {},\r\n  enabled = false,\r\n  element = <DefaultListEditorInput />,\r\n  value,\r\n  id,\r\n  i = 0,\r\n  variant = \"default\",\r\n  extrasPlacement = \"center\",\r\n  autoFocus,\r\n  cardStyle: style,\r\n}: Props & ListEditorFieldProps & Item) {\r\n  const [field, setField] = useState<HTMLElement | null>(null);\r\n  const theme = useTheme();\r\n  const content = (\r\n    <Box display=\"flex\" alignItems={extrasPlacement}>\r\n      {icon !== null &&\r\n        cloneElement(icon, {\r\n          style: {\r\n            marginRight: theme.spacing(1),\r\n            marginTop: theme.spacing(0.5),\r\n            marginBottom: theme.spacing(0.5),\r\n          },\r\n          color: \"action\",\r\n        })}\r\n      <Box\r\n        flexGrow={1}\r\n        style={{\r\n          marginLeft: -theme.spacing(icon === null ? 2 : 0),\r\n        }}\r\n      >\r\n        {cloneElement(element, {\r\n          onDelete: () => onDeleteItem(id ?? i),\r\n          autoFocus,\r\n          value,\r\n          key: id ?? i,\r\n          onValueChange: (e: any) => onChangeItem(id ?? i, e, enabled),\r\n          onChange: (e: any) => onChangeItem(id ?? i, e.target.value, enabled),\r\n          ref: (e: HTMLElement | null) => setField(e),\r\n        })}\r\n      </Box>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        {useSwitch && (\r\n          <Switch\r\n            color=\"primary\"\r\n            edge=\"end\"\r\n            onChange={(_, v) => onChangeItem(id ?? i, value, v)}\r\n            checked={enabled}\r\n          />\r\n        )}\r\n        {useEditButton && (\r\n          <IconButton\r\n            edge=\"end\"\r\n            onClick={() => {\r\n              if (field?.focus) {\r\n                field.focus();\r\n              }\r\n            }}\r\n          >\r\n            <EditIcon />\r\n          </IconButton>\r\n        )}\r\n        {useDelete && (\r\n          <IconButton onClick={() => onDeleteItem(id ?? i)}>\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        )}\r\n      </Box>\r\n    </Box>\r\n  );\r\n  return (\r\n    <Box\r\n      style={{\r\n        marginBottom: theme.spacing(1),\r\n        marginLeft: theme.spacing(2),\r\n      }}\r\n    >\r\n      {variant === \"outlined\" ? (\r\n        <Card\r\n          variant=\"outlined\"\r\n          style={{\r\n            borderColor: \"transparent\",\r\n            paddingRight: theme.spacing(2),\r\n            transition: theme.transitions.create([\r\n              \"box-shadow\",\r\n              \"border-color\",\r\n            ]),\r\n            ...style,\r\n          }}\r\n        >\r\n          {content}\r\n        </Card>\r\n      ) : (\r\n        content\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default function Editor<T>(props: Props<T>) {\r\n  const {\r\n    addItemLabel = \"Add Item\",\r\n    label,\r\n    text,\r\n    onAddItem = () => {},\r\n    onDeleteItem = () => {},\r\n    items = [],\r\n    placeholderText,\r\n    autoFocus,\r\n    getCategory,\r\n    getOrder,\r\n    extras,\r\n  } = props;\r\n  const isInitialRender = useInitialRender();\r\n  const theme = useTheme();\r\n  const [intermediateItems, setIntermediateItems] = useState(items);\r\n  const [newIndex, setNewIndex] = useState(-1);\r\n  useEffect(() => {\r\n    const timeout = setTimeout(() => {\r\n      setIntermediateItems(items);\r\n    }, theme.transitions.duration.standard);\r\n    return () => {\r\n      clearTimeout(timeout);\r\n    };\r\n  }, [items, setIntermediateItems, theme.transitions.duration.standard]);\r\n  const children = uniqBy([...intermediateItems, ...items], (c) => c.id)\r\n    .map((c) => items.find((c2) => c.id === c2.id) ?? c)\r\n    .map((x, i) => {\r\n      const { enabled, element, value, id } = x ?? {};\r\n      return {\r\n        value,\r\n        render: (p?: ComponentProps<typeof ListEditorField>) => (\r\n          <Collapse\r\n            in={!!items.find((p) => p.id === x.id)}\r\n            unmountOnExit\r\n            appear={!isInitialRender}\r\n            mountOnEnter\r\n          >\r\n            <ListEditorField\r\n              {...props}\r\n              onDeleteItem={(e) => {\r\n                onDeleteItem(e);\r\n                setNewIndex(-1);\r\n              }}\r\n              enabled={enabled}\r\n              element={element}\r\n              value={value}\r\n              id={id}\r\n              i={i}\r\n              autoFocus={autoFocus || i === newIndex}\r\n              {...p}\r\n            />\r\n          </Collapse>\r\n        ),\r\n        key: id,\r\n        in: !!items.find((p) => p.id === x.id),\r\n      };\r\n    });\r\n  const sorted = sortBy(\r\n    children,\r\n    (c) => getCategory?.(c.value),\r\n    (c) => getOrder?.(c.value)\r\n  ).map((c) => ({\r\n    ...c,\r\n    render: (p?: ComponentProps<typeof ListEditorField>) => (\r\n      <Box key={c.key}>{c.render(p)}</Box>\r\n    ),\r\n  }));\r\n  return (\r\n    <List\r\n      subheader={\r\n        label || text ? (\r\n          <>\r\n            <ListSubheader disableSticky>\r\n              {label && (\r\n                <Typography variant=\"body1\" gutterBottom color=\"textPrimary\">\r\n                  {label}\r\n                </Typography>\r\n              )}\r\n              {text && (\r\n                <Typography\r\n                  variant=\"body2\"\r\n                  color=\"textSecondary\"\r\n                  gutterBottom\r\n                  style={{ marginBottom: theme.spacing(3) }}\r\n                >\r\n                  {text}\r\n                </Typography>\r\n              )}\r\n            </ListSubheader>\r\n          </>\r\n        ) : undefined\r\n      }\r\n    >\r\n      <Box mt={getCategory ? -1 : 0}>\r\n        {(() => {\r\n          const out: ReactNode[] = [];\r\n          sorted.forEach((c, i) => {\r\n            if (getCategory && isNewCategory(sorted, i, c)) {\r\n              out.push(\r\n                <Collapse\r\n                  in={items.some(\r\n                    (c2) => getCategory(c2.value) === getCategory(c.value)\r\n                  )}\r\n                  appear\r\n                  key={getCategory(c.value)}\r\n                >\r\n                  <Box pl={2} pb={2} pt={1}>\r\n                    <Typography variant=\"overline\" color=\"textSecondary\">\r\n                      {getCategory(c.value)}\r\n                    </Typography>\r\n                  </Box>\r\n                </Collapse>\r\n              );\r\n            }\r\n            out.push(c.render());\r\n          });\r\n          return out;\r\n        })()}\r\n      </Box>\r\n      <Collapse in={!items?.length}>\r\n        <Box ml={2} mb={1} pt={getCategory ? 1 : 0}>\r\n          <Typography color=\"textSecondary\">\r\n            {placeholderText ?? \"No items\"}\r\n          </Typography>\r\n        </Box>\r\n      </Collapse>\r\n      <Box p={2} mb={-3}>\r\n        <Button\r\n          disableElevation\r\n          variant=\"contained\"\r\n          startIcon={<Add />}\r\n          color=\"primary\"\r\n          onClick={() => {\r\n            onAddItem();\r\n            setNewIndex(items.length);\r\n          }}\r\n        >\r\n          {addItemLabel}\r\n        </Button>\r\n        {extras}\r\n      </Box>\r\n    </List>\r\n  );\r\n\r\n  function isNewCategory(\r\n    arr: {\r\n      value: T | undefined;\r\n      render: (\r\n        p?: (Props<any> & ListEditorFieldProps & Item<any>) | undefined\r\n      ) => JSX.Element;\r\n      key: Key;\r\n    }[],\r\n    i: number,\r\n    c: {\r\n      value: T | undefined;\r\n      render: (\r\n        p?: (Props<any> & ListEditorFieldProps & Item<any>) | undefined\r\n      ) => JSX.Element;\r\n      key: Key;\r\n    }\r\n  ) {\r\n    return !!(\r\n      getCategory &&\r\n      (arr[i - 1] === undefined ||\r\n        getCategory(arr[i - 1].value) !== getCategory(c.value))\r\n    );\r\n  }\r\n}\r\n\r\nexport function ListEditor<T extends { key: string }>({\r\n  onChange,\r\n  value = [],\r\n  editor,\r\n  create,\r\n  ...props\r\n}: Omit<Props<T>, \"items\"> & {\r\n  items?: T[];\r\n  onChange?: (value: T[]) => void;\r\n  value?: T[];\r\n  editor?: (item: T) => ReactElement;\r\n  create?: () => Omit<T, \"key\">;\r\n}) {\r\n  const [state, setState] = useState(value ?? []);\r\n  function handleChange(next: T[]) {\r\n    setState(next);\r\n    onChange?.(next);\r\n  }\r\n  useEffect(() => {\r\n    setState(value);\r\n  }, [value]);\r\n  return (\r\n    <Box sx={{ ml: -2 }}>\r\n      <Editor\r\n        {...props}\r\n        items={state.map((c) => ({\r\n          id: c.key,\r\n          value: c,\r\n          element: editor?.(c),\r\n        }))}\r\n        useDelete\r\n        useEdit={false}\r\n        onAddItem={() =>\r\n          handleChange?.([...state, { key: id(), ...create?.() } as T])\r\n        }\r\n        onDeleteItem={(k) => {\r\n          return handleChange?.(filter(state, (b) => b.key !== k));\r\n        }}\r\n        onChangeItem={(k, v) =>\r\n          handleChange?.(map(state, (b) => (b.key === k ? v : b)))\r\n        }\r\n      />\r\n    </Box>\r\n  );\r\n}\r\n","import { Typography as Type } from \"@material-ui/core\";\r\nimport { FiberManualRecord as Dot } from \"@material-ui/icons\";\r\nimport { ComponentProps, ReactNode } from \"react\";\r\n\r\nexport function OverlineDot(props: ComponentProps<typeof Dot>) {\r\n  return (\r\n    <Dot\r\n      {...props}\r\n      sx={{\r\n        fontSize: 12,\r\n        transform: \"translateY(1.75px) translateX(-2px)\",\r\n        ...props.sx,\r\n      }}\r\n    />\r\n  );\r\n}\r\n\r\ntype Props = {\r\n  children?: ReactNode;\r\n};\r\n\r\nexport function Overline({ children }: Props) {\r\n  return (\r\n    <Type variant=\"overline\" sx={{ my: -0.75, display: \"block\" }}>\r\n      {children}\r\n    </Type>\r\n  );\r\n}\r\n","import { find } from \"lodash\";\nimport { useCallback } from \"react\";\nimport { Connection, useConnections } from \"slices/connections\";\n\nexport function useConnectionResolver() {\n  const [connections] = useConnections();\n  return useCallback(\n    (model?: Partial<Connection>) => find(connections, model),\n    [connections]\n  );\n}\n\nexport function useConnection(url: string) {\n  const resolve = useConnectionResolver();\n  return resolve({ url });\n}\n","import { useCallback } from \"react\";\r\nimport { createSlice } from \"./createSlice\";\r\n\r\ntype Loading = {\r\n  specimen?: boolean;\r\n  map?: boolean;\r\n  connections?: boolean;\r\n  features?: boolean;\r\n};\r\n\r\nexport const [useLoading, LoadingProvider] = createSlice<Loading>({});\r\n\r\nexport function useLoadingState(key: keyof Loading) {\r\n  const [, setLoading] = useLoading();\r\n\r\n  return useCallback(\r\n    async <T>(task: () => Promise<T>) => {\r\n      setLoading({ [key]: true });\r\n      const out = await task();\r\n      setLoading({ [key]: false });\r\n      return out;\r\n    },\r\n    [key, setLoading]\r\n  );\r\n}\r\n","import { find } from \"lodash\";\nimport { useLoading } from \"slices/loading\";\nimport { useSettings } from \"slices/settings\";\nimport { useConnectionResolver } from \"./useConnectionResolver\";\n\nexport type ConnectionStatus =\n  | \"connected\"\n  | \"connecting\"\n  | \"error\"\n  | \"not-connected\";\n\nexport function useConnectionStatus(url?: string): ConnectionStatus {\n  const [{ connections: loading }] = useLoading();\n  const resolve = useConnectionResolver();\n  const [{ remote }] = useSettings();\n  const entry = find(remote, { url });\n\n  return entry && !entry?.disabled\n    ? resolve({ url })\n      ? \"connected\"\n      : loading\n      ? \"connecting\"\n      : url\n      ? \"error\"\n      : \"not-connected\"\n    : \"not-connected\";\n}\n","import {\n  Switch,\n  TextField,\n  Tooltip,\n  Typography as Type,\n} from \"@material-ui/core\";\nimport { EditTwoTone as EditIcon } from \"@material-ui/icons\";\nimport { Box } from \"@material-ui/system\";\nimport { Flex } from \"components/generic/Flex\";\nimport { IconButtonWithTooltip as IconButton } from \"components/generic/IconButtonWithTooltip\";\nimport {\n  AppBarTitle as Title,\n  ManagedModal as Dialog,\n} from \"components/generic/Modal\";\nimport { OverlineDot as Dot } from \"components/generic/Overline\";\nimport { Space } from \"components/generic/Space\";\nimport { useConnection } from \"hooks/useConnectionResolver\";\nimport { useConnectionStatus } from \"hooks/useConnectionStatus\";\nimport { entries, startCase } from \"lodash\";\nimport { merge } from \"slices/reducers\";\nimport { Remote } from \"slices/settings\";\nimport { SelectField as Select } from \"components/generic/Select\";\nimport { transports } from \"client\";\n\nconst statusColor = {\n  connected: \"success.light\",\n  connecting: \"warning.light\",\n  error: \"error.light\",\n  \"not-connected\": \"text.disabled\",\n};\n\ntype ServerEditorProps = {\n  value: Remote;\n  onValueChange?: (e: Remote) => void;\n};\n\nexport function ServerEditor({ value, onValueChange }: ServerEditorProps) {\n  const connection = useConnection(value.url);\n  const status = useConnectionStatus(value.url);\n\n  function handleChange(next: Partial<Remote>) {\n    onValueChange?.(merge(value, next));\n  }\n\n  return (\n    <>\n      <Flex alignItems=\"center\" py={0.5}>\n        <Dot sx={{ color: statusColor[status] }} />\n        <Space />\n        <Box flex={1}>\n          <Type>\n            {connection\n              ? `${connection.name} ${connection.version}`\n              : startCase(status)}\n          </Type>\n          <Type variant=\"body2\" color=\"text.secondary\">\n            {connection?.description ?? (value?.url || \"No URL\")}\n          </Type>\n        </Box>\n        <Tooltip title={`${value.disabled ? \"Enable\" : \"Disable\"} Connection`}>\n          <Box>\n            <Switch\n              checked={!value.disabled}\n              onChange={(_, v) => handleChange({ disabled: !v })}\n            />\n          </Box>\n        </Tooltip>\n        <Dialog\n          trigger={(onClick) => (\n            <IconButton\n              icon={<EditIcon />}\n              label=\"Edit Connection\"\n              {...{ onClick }}\n            />\n          )}\n          appBar={{ children: <Title>Edit Connection</Title> }}\n        >\n          <Box p={2.5}>\n            <TextField\n              value={value.url}\n              onChange={(e) => handleChange({ url: e.target.value })}\n              fullWidth\n              variant=\"filled\"\n              label=\"URL\"\n              sx={{ mb: 2 }}\n            />\n            <Select\n              placeholder=\"Connection Type\"\n              items={entries(transports).map(([k, { name }]) => ({\n                value: k,\n                label: name,\n              }))}\n              fullWidth\n              value={value.transport}\n              onChange={(v) => handleChange({ transport: v })}\n            />\n          </Box>\n        </Dialog>\n      </Flex>\n    </>\n  );\n}\n","import { Button } from \"@material-ui/core\";\nimport { ReplayOutlined as ResetIcon } from \"@material-ui/icons\";\nimport { defaultTransport } from \"client\";\nimport { ListEditor } from \"components/generic/ListEditor\";\nimport { debounce } from \"lodash\";\nimport { defaultRemotes, Remote, useSettings } from \"slices/settings\";\nimport { ServerEditor } from \"./ServerEditor\";\n\nexport function ServerListEditor() {\n  const [{ remote }, setSettings] = useSettings();\n  return (\n    <>\n      <ListEditor<Remote>\n        editor={(v) => <ServerEditor value={v} />}\n        icon={null}\n        value={remote}\n        onChange={debounce((v) => setSettings({ remote: v }), 300)}\n        addItemLabel=\"Add Solver\"\n        create={() => ({\n          transport: defaultTransport,\n          url: \"\",\n          disabled: true,\n        })}\n        extras={\n          <Button\n            startIcon={<ResetIcon />}\n            sx={{ ml: 2 }}\n            onClick={() => setSettings({ remote: defaultRemotes })}\n          >\n            Reset to Defaults\n          </Button>\n        }\n      />\n    </>\n  );\n}\n","import {\n  Box,\n  Divider,\n  Slider,\n  Tab,\n  Typography as Type,\n} from \"@material-ui/core\";\nimport { TabContext, TabList, TabPanel } from \"@material-ui/lab\";\nimport { Flex } from \"components/generic/Flex\";\nimport { Space } from \"components/generic/Space\";\nimport { ReactNode, useState } from \"react\";\nimport { defaultPlaybackRate as baseRate, useSettings } from \"slices/settings\";\nimport { ServerListEditor } from \"./ServerListEditor\";\n\nconst formatLabel = (v: number) => `${v}x`;\n\nexport function SettingsEditor() {\n  const [{ playbackRate = 1 }, setSettings] = useSettings();\n  const [tab, setTab] = useState(\"general\");\n  function renderHeading(label: ReactNode) {\n    return (\n      <Type variant=\"overline\" color=\"textSecondary\">\n        {label}\n      </Type>\n    );\n  }\n  function renderLabel(label: ReactNode) {\n    return <Type variant=\"body1\">{label}</Type>;\n  }\n  return (\n    <TabContext value={tab}>\n      <TabList onChange={(_, v) => setTab(v)}>\n        <Tab label=\"General\" value=\"general\" />\n        <Tab label=\"Connections\" value=\"connections\" />\n      </TabList>\n      <Divider />\n      <TabPanel value=\"general\">\n        <Box>\n          {renderHeading(\"Visualiser\")}\n          <Flex alignItems=\"center\">\n            {renderLabel(\"Playback Rate\")}\n            <Space flex={1} />\n            <Slider\n              sx={{ maxWidth: 320 }}\n              marks={[0.25, 1, 5].map((v) => ({\n                value: v * baseRate,\n                label: formatLabel(v),\n              }))}\n              step={0.25 * baseRate}\n              min={0.25 * baseRate}\n              max={5 * baseRate}\n              valueLabelFormat={(v) => formatLabel(v / baseRate)}\n              valueLabelDisplay=\"auto\"\n              defaultValue={playbackRate}\n              onChangeCommitted={(_, v) =>\n                setSettings({ playbackRate: v as number })\n              }\n            />\n          </Flex>\n        </Box>\n      </TabPanel>\n      <TabPanel value=\"connections\">\n        <Box>\n          {renderHeading(\"Solvers\")}\n          <ServerListEditor />\n        </Box>\n      </TabPanel>\n    </TabContext>\n  );\n}\n","import { SettingsTwoTone as SettingsIcon } from \"@material-ui/icons\";\nimport { IconButtonWithTooltip } from \"components/generic/IconButtonWithTooltip\";\nimport {\n  AppBarTitle as Title,\n  ManagedModal as Dialog,\n} from \"components/generic/Modal\";\nimport { SettingsEditor } from \"components/settings-editor/SettingsEditor\";\n\nexport function Settings() {\n  return (\n    <>\n      <Dialog\n        trigger={(onClick) => (\n          <IconButtonWithTooltip\n            {...{ onClick }}\n            icon={<SettingsIcon fontSize=\"small\" color=\"primary\" />}\n            label=\"Settings\"\n          />\n        )}\n        options={{ width: 960, scrollable: false }}\n        appBar={{ children: <Title>Settings</Title> }}\n      >\n        <SettingsEditor />\n      </Dialog>\n    </>\n  );\n}\n","import { Typography as Type, BoxProps, Box } from \"@material-ui/core\";\r\n\r\nexport function Title(props: BoxProps) {\r\n  return (\r\n    <Box bgcolor=\"primary.main\" p={2} {...props}>\r\n      <Type\r\n        variant=\"body1\"\r\n        color=\"text.secondary\"\r\n        sx={{\r\n          color: \"primary.contrastText\",\r\n          whiteSpace: \"nowrap\",\r\n          fontWeight: 500,\r\n        }}\r\n      >\r\n        PFAlgoViz\r\n      </Type>\r\n    </Box>\r\n  );\r\n}\r\n","import {\r\n  FormControlLabel,\r\n  Switch as MuiSwitch,\r\n  SwitchProps as MuiSwitchProps,\r\n} from \"@material-ui/core\";\r\nimport { ReactNode } from \"react\";\r\n\r\ntype SwitchProps = { label?: ReactNode } & MuiSwitchProps;\r\n\r\nexport function Switch({ label = <></>, ...props }: SwitchProps) {\r\n  return (\r\n    <FormControlLabel\r\n      control={<MuiSwitch defaultChecked {...props} />}\r\n      {...{ label }}\r\n    />\r\n  );\r\n}\r\n","import { Comparator } from \"slices/UIState\";\r\n\r\nexport const comparators: Comparator[] = [\r\n  {\r\n    key: \"equal\",\r\n    apply: (a, b) => a === b,\r\n  },\r\n  {\r\n    key: \"less-than\",\r\n    apply: (a, b) => a < b,\r\n  },\r\n  {\r\n    key: \"greater-than\",\r\n    apply: (a, b) => a > b,\r\n  },\r\n];\r\n","export const intrinsicProperties = [\"f\", \"g\"];\r\n","import { TraceEventType } from \"protocol/Trace\";\r\n\r\nexport const eventTypes: (TraceEventType | \"any\")[] = [\r\n  \"any\",\r\n  \"source\",\r\n  \"destination\",\r\n  \"expanding\",\r\n  \"generating\",\r\n  \"closing\",\r\n];\r\n","import { Divider, TextField, Typography as Type } from \"@material-ui/core\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { SelectField as Select } from \"components/generic/Select\";\r\nimport { Space } from \"components/generic/Space\";\r\nimport { Switch } from \"components/generic/Switch\";\r\nimport { find, last, map, startCase } from \"lodash\";\r\nimport { Breakpoint } from \"slices/UIState\";\r\nimport { comparators } from \"./comparators\";\r\nimport { eventTypes } from \"./eventTypes\";\r\n\r\ntype BreakpointEditorProps = {\r\n  value: Breakpoint;\r\n  onValueChange?: (v: Breakpoint) => void;\r\n  properties?: string[];\r\n};\r\n\r\nexport function BreakpointEditor({\r\n  value,\r\n  onValueChange: onChange,\r\n  properties,\r\n}: BreakpointEditorProps) {\r\n  function handleChange(next: Partial<Breakpoint>) {\r\n    onChange?.({ ...value, ...next });\r\n  }\r\n  return (\r\n    <Flex>\r\n      <Select\r\n        placeholder=\"Event\"\r\n        sx={{ minWidth: 160 }}\r\n        items={map(eventTypes, (c) => ({ value: c, label: startCase(c) }))}\r\n        onChange={(v) => handleChange({ type: v === \"any\" ? undefined : v })}\r\n        value={value.type ?? \"any\"}\r\n      />\r\n      <Divider flexItem orientation=\"vertical\" sx={{ mx: 2 }} />\r\n      <Select\r\n        placeholder=\"Property\"\r\n        sx={{\r\n          minWidth: 140,\r\n          textOverflow: \"ellipsis\",\r\n          whiteSpace: \"nowrap\",\r\n        }}\r\n        items={map(properties, (c) => ({\r\n          value: c,\r\n          label: (\r\n            <>\r\n              {last(c.split(\".\"))}\r\n              <Space />\r\n              <Type\r\n                color=\"textSecondary\"\r\n                variant=\"body2\"\r\n                component=\"span\"\r\n              >{`event.${c}`}</Type>\r\n            </>\r\n          ),\r\n        }))}\r\n        onChange={(v) => handleChange({ property: v })}\r\n        value={value.property}\r\n      />\r\n      <Space />\r\n      <Select\r\n        placeholder=\"Condition\"\r\n        items={comparators.map((c) => ({\r\n          value: c.key,\r\n          label: startCase(c.key),\r\n        }))}\r\n        value={value?.condition?.key ?? comparators?.[0]?.key}\r\n        onChange={(v) =>\r\n          handleChange({ condition: find(comparators, { key: v }) })\r\n        }\r\n      />\r\n      <Space />\r\n      <TextField\r\n        label=\"Reference\"\r\n        fullWidth\r\n        value={`${value.reference ?? 0}`}\r\n        variant=\"filled\"\r\n        inputProps={{ inputMode: \"numeric\", pattern: \"[0-9]*\" }}\r\n        onChange={(v) => handleChange({ reference: +v.target.value })}\r\n        type=\"number\"\r\n      />\r\n      <Space sx={{ px: 2 }} />\r\n      <Switch\r\n        checked={!!value.active}\r\n        onChange={(_, v) => handleChange({ active: v })}\r\n      />\r\n    </Flex>\r\n  );\r\n}\r\n","export const propertyPaths = [\"variables\"];\r\n","import { ListEditor } from \"components/generic/ListEditor\";\r\nimport { debounce, flatMap as flat, get, keys, map, uniq } from \"lodash\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { Breakpoint, useUIState } from \"slices/UIState\";\r\nimport { comparators } from \"./comparators\";\r\nimport { intrinsicProperties } from \"./intrinsicProperties\";\r\nimport { BreakpointEditor } from \"./BreakpointEditor\";\r\nimport { Box } from \"@material-ui/system\";\r\nimport { propertyPaths as paths } from \"./propertyPaths\";\r\n\r\nexport function BreakpointListEditor() {\r\n  const [{ breakpoints = [] }, setUIState] = useUIState();\r\n  const [{ specimen }] = useSpecimen();\r\n\r\n  const properties = uniq([\r\n    ...intrinsicProperties,\r\n    ...flat(paths, (p) =>\r\n      flat(specimen?.nodeStructure, (v) =>\r\n        map(keys(get(v, p)), (k) => `${p}.${k}`)\r\n      )\r\n    ),\r\n  ]);\r\n\r\n  return (\r\n    <Box sx={{ overflow: \"auto hidden\", width: \"100%\" }}>\r\n      <Box sx={{ minWidth: 720, mb: 2 }}>\r\n        <ListEditor<Breakpoint>\r\n          icon={null}\r\n          value={breakpoints}\r\n          useDelete\r\n          useEdit={false}\r\n          editor={(v) => <BreakpointEditor value={v} properties={properties} />}\r\n          create={() => ({\r\n            active: true,\r\n            property: properties?.[0],\r\n            condition: comparators?.[0],\r\n            type: undefined,\r\n            reference: 0,\r\n          })}\r\n          onChange={debounce((v) => setUIState({ breakpoints: v }), 1000)}\r\n          addItemLabel=\"Breakpoint\"\r\n          placeholderText=\"Click the button below to add a breakpoint.\"\r\n        />\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { CircularProgress } from \"@material-ui/core\";\r\nimport Editor from \"@monaco-editor/react\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { debounce } from \"lodash\";\r\nimport AutoSize from \"react-virtualized-auto-sizer\";\r\nimport { useUIState } from \"slices/UIState\";\r\n\r\nconst DELAY = 2500;\r\n\r\nexport function ScriptEditor() {\r\n  const [{ code }, setUIState] = useUIState();\r\n  return (\r\n    <Flex height=\"70vh\" overflow=\"hidden\">\r\n      <AutoSize>\r\n        {({ width, height }) => (\r\n          <Editor\r\n            width={width}\r\n            loading={<CircularProgress variant=\"indeterminate\" />}\r\n            height={height}\r\n            language=\"javascript\"\r\n            defaultValue={code}\r\n            onChange={debounce((v) => setUIState({ code: v }), DELAY)}\r\n            options={{\r\n              minimap: {\r\n                enabled: false,\r\n              },\r\n            }}\r\n          />\r\n        )}\r\n      </AutoSize>\r\n    </Flex>\r\n  );\r\n}\r\n","import download from \"downloadjs\";\nimport stringify from \"json-beautify\";\nimport { Trace } from \"protocol/Trace\";\n\nexport function saveJSON(filename: string, specimen?: Trace) {\n  download(\n    stringify(specimen, null as any, 2),\n    `${filename}.json`,\n    \"application/json\"\n  );\n}\n","import {\r\n  Box,\r\n  Divider,\r\n  Tab,\r\n  Typography as Type,\r\n  Button,\r\n} from \"@material-ui/core\";\r\nimport { TabContext, TabList, TabPanel } from \"@material-ui/lab\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { Space } from \"components/generic/Space\";\r\nimport { Switch } from \"components/generic/Switch\";\r\nimport { ReactNode, useState } from \"react\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { BreakpointListEditor } from \"../breakpoint-editor/BreakpointListEditor\";\r\nimport { ScriptEditor } from \"components/script-editor/ScriptEditor\";\r\nimport { saveJSON as save } from \"./saveJSON\";\r\n\r\nexport function DebugOptionsEditor() {\r\n  const [{ specimen, format, algorithm }] = useSpecimen();\r\n  const [{ monotonicF, monotonicG }, setUIState] = useUIState();\r\n  const [tab, setTab] = useState(\"standard\");\r\n  function renderHeading(label: ReactNode) {\r\n    return (\r\n      <Type variant=\"overline\" color=\"textSecondary\">\r\n        {label}\r\n      </Type>\r\n    );\r\n  }\r\n  return (\r\n    <TabContext value={tab}>\r\n      <TabList onChange={(_, v) => setTab(v)}>\r\n        <Tab label=\"Standard\" value=\"standard\" />\r\n        <Tab label=\"Advanced\" value=\"advanced\" />\r\n      </TabList>\r\n      <Divider />\r\n      <TabPanel value=\"standard\">\r\n        <Box>\r\n          {renderHeading(\"General\")}\r\n          <Flex>\r\n            <Switch\r\n              label=\"Monotonic f value\"\r\n              checked={!!monotonicF}\r\n              onChange={(_, v) => setUIState({ monotonicF: v })}\r\n            />\r\n            <Space />\r\n            <Switch\r\n              label=\"Monotonic g value\"\r\n              checked={!!monotonicG}\r\n              onChange={(_, v) => setUIState({ monotonicG: v })}\r\n            />\r\n          </Flex>\r\n        </Box>\r\n        <Space />\r\n        <Box>\r\n          {renderHeading(\"Breakpoints\")}\r\n          <BreakpointListEditor />\r\n        </Box>\r\n        <Box>\r\n          {renderHeading(\"Export\")}\r\n          <Flex mt={1}>\r\n            <Button\r\n              variant=\"contained\"\r\n              disableElevation\r\n              disabled={!specimen}\r\n              onClick={() => save(`${format} - ${algorithm}`, specimen)}\r\n            >\r\n              Save Trace as JSON\r\n            </Button>\r\n          </Flex>\r\n        </Box>\r\n      </TabPanel>\r\n      <TabPanel value=\"advanced\" sx={{ p: 0 }}>\r\n        <ScriptEditor />\r\n      </TabPanel>\r\n    </TabContext>\r\n  );\r\n}\r\n","import { Button, Tooltip } from \"@material-ui/core\";\r\nimport { BugReportTwoTone as BugIcon } from \"@material-ui/icons\";\r\nimport { DebugOptionsEditor } from \"components/debug-options-editor/DebugOptionsEditor\";\r\nimport {\r\n  AppBarTitle as Title,\r\n  ManagedModal as Dialog,\r\n} from \"components/generic/Modal\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\n\r\nexport function Utility() {\r\n  const [{ specimen }] = useSpecimen();\r\n\r\n  return (\r\n    <>\r\n      <Dialog\r\n        trigger={(onClick) => (\r\n          <Tooltip title=\"Debug Options\">\r\n            <Button\r\n              {...{ onClick }}\r\n              disabled={!specimen}\r\n              startIcon={<BugIcon />}\r\n            >\r\n              Debug\r\n            </Button>\r\n          </Tooltip>\r\n        )}\r\n        options={{ width: 960, scrollable: false }}\r\n        appBar={{ children: <Title>Debug Options</Title> }}\r\n      >\r\n        <DebugOptionsEditor />\r\n      </Dialog>\r\n    </>\r\n  );\r\n}\r\n","import { Box, Card, Divider } from \"@material-ui/core\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { acrylic } from \"theme\";\r\nimport { Input } from \"./Input\";\r\nimport { Playback } from \"./Playback\";\r\nimport { Settings } from \"./Settings\";\r\nimport { Title } from \"./Title\";\r\nimport { Utility } from \"./Utility\";\r\n\r\nconst divider = <Divider orientation=\"vertical\" flexItem sx={{ m: 1 }} />;\r\n\r\nexport function Controls() {\r\n  return (\r\n    <Card\r\n      sx={{\r\n        m: 3,\r\n        position: \"absolute\",\r\n        top: 0,\r\n        left: 0,\r\n        zIndex: \"appBar\",\r\n        ...acrylic,\r\n      }}\r\n    >\r\n      <Box display=\"flex\">\r\n        <Title mr={1} />\r\n        <Flex p={1} alignItems=\"center\">\r\n          <Input />\r\n          {divider}\r\n          <Playback />\r\n          {divider}\r\n          <Utility />\r\n          {divider}\r\n          <Settings />\r\n        </Flex>\r\n      </Box>\r\n    </Card>\r\n  );\r\n}\r\n","import { BlurOffOutlined as DisabledIcon } from \"@material-ui/icons\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { RendererProps } from \"components/specimen-renderer/Renderer\";\r\n\r\nexport function DefaultRenderer({ width, height }: RendererProps) {\r\n  return (\r\n    <Flex\r\n      {...{ width, height }}\r\n      justifyContent=\"center\"\r\n      alignItems=\"center\"\r\n      color=\"text.secondary\"\r\n      vertical\r\n    >\r\n      <DisabledIcon sx={{ mb: 2 }} fontSize=\"large\" />\r\n      No renderer is installed for the current map style.\r\n    </Flex>\r\n  );\r\n}\r\n","export const getDefaults = () => ({\r\n  start: 0,\r\n  end: 0,\r\n});\r\n","import { Point } from \"components/specimen-renderer/Renderer\";\r\nimport { filter, flatMap as flat, last, map, split } from \"lodash\";\r\nimport { TraceEvent } from \"protocol/Trace\";\r\n\r\nexport function parseMap(m: string = \"\", wall: string = \"@\") {\r\n  const [, h, w] = split(m, \"\\n\");\r\n  const [width, height] = map([w, h], (d) => +last(split(d, \" \"))!);\r\n  const grid = split(m, \"\\n\").slice(4);\r\n  return [\r\n    { x: width, y: height },\r\n    filter(\r\n      flat(grid, (row, y) =>\r\n        map(row, (tile, x) =>\r\n          tile === wall ? { variables: { x, y } } : undefined\r\n        )\r\n      )\r\n    ) as TraceEvent[],\r\n    ({ x, y }: Point) => grid[y]?.[x] !== wall,\r\n  ] as const;\r\n}\r\n","import { find, floor, range } from \"lodash\";\r\nimport { parseMap } from \"./parseMap\";\r\n\r\nexport function getDefaults(m: string = \"\", wall: string = \"@\") {\r\n  const [{ x: w, y: h }, , valid] = parseMap(m, wall);\r\n  const node =\r\n    find(range(w * h), (i) => valid({ x: i % w, y: floor(i / w) })) ?? 0;\r\n  return {\r\n    start: node,\r\n    end: node,\r\n  };\r\n}\r\n","import memo from \"memoizee\";\r\nimport { FunctionTemplate } from \"./FunctionTemplate\";\r\nimport { templates } from \"./templates\";\r\n\r\ntype TemplateMap = typeof templates;\r\n\r\ntype Key = keyof TemplateMap;\r\n\r\ntype ReturnTypeOf<T extends Key> = TemplateMap[T] extends FunctionTemplate<\r\n  [...any],\r\n  infer R\r\n>\r\n  ? R\r\n  : never;\r\n\r\ntype ParamsOf<T extends Key> = TemplateMap[T] extends FunctionTemplate<\r\n  infer R,\r\n  any\r\n>\r\n  ? R\r\n  : [];\r\n\r\nconst fn = memo(\r\n  (script: string, method: string) =>\r\n    // eslint-disable-next-line no-new-func\r\n    new Function(\r\n      \"params\",\r\n      `${script}; return ${method}.apply(null, params);`\r\n    ) as (params: any[]) => any\r\n);\r\n\r\nexport function call<T extends Key>(\r\n  script: string,\r\n  method: T,\r\n  params: ParamsOf<T>\r\n): ReturnTypeOf<T> {\r\n  try {\r\n    return fn(script, method)(params);\r\n  } catch {\r\n    return templates[method].defaultReturnValue as ReturnTypeOf<T>;\r\n  }\r\n}\r\n","import {\r\n  blueGrey,\r\n  deepOrange,\r\n  orange,\r\n  pink,\r\n  teal,\r\n  yellow,\r\n} from \"@material-ui/core/colors\";\r\nimport { mapValues } from \"lodash\";\r\nimport { TraceEventType } from \"protocol/Trace\";\r\n\r\nconst tint = \"500\";\r\n\r\nexport function hex(h: string) {\r\n  return parseInt(h.replace(\"#\", \"0x\"));\r\n}\r\n\r\nexport const colorsHex = {\r\n  source: teal[\"A400\"],\r\n  destination: pink[\"A400\"],\r\n  expanding: deepOrange[tint],\r\n  generating: yellow[tint],\r\n  closing: blueGrey[\"200\"],\r\n  end: pink[\"A400\"],\r\n};\r\n\r\nexport const colors: { [K in TraceEventType]: number } = mapValues(\r\n  colorsHex,\r\n  hex\r\n);\r\n\r\nexport function getColor(key?: TraceEventType) {\r\n  return (key && colors[key]) || hex(orange[tint]);\r\n}\r\n\r\nexport function getColorHex(key?: TraceEventType) {\r\n  return (key && colorsHex[key]) ?? orange[tint];\r\n}\r\n","export const scale = 10 * devicePixelRatio;\r\nexport const size = 1200;\r\n","import { Graphics } from \"@inlet/react-pixi\";\r\nimport { ComponentProps } from \"react\";\r\nimport { Graphics as PIXIGraphics } from \"@pixi/graphics\";\r\n\r\nexport function makeGraphic<T = any>(\r\n  draw: (g: PIXIGraphics, props: ComponentProps<typeof Graphics> & T) => void\r\n) {\r\n  return (props: ComponentProps<typeof Graphics> & T) => {\r\n    return <Graphics {...props} draw={(g) => draw(g, props)} />;\r\n  };\r\n}\r\n","import { ceil, forEach, range } from \"lodash\";\r\nimport { ComponentProps } from \"react\";\r\nimport { scale } from \"./config\";\r\nimport { makeGraphic } from \"./makeGraphic\";\r\n\r\nconst WEIGHT = 1 / scale;\r\n\r\nconst Grid = makeGraphic<{ alpha?: number; grid?: number }>(\r\n  (g, { width = 0, height = 0, alpha = 1, grid = 5 }) => {\r\n    g.clear();\r\n    g.lineStyle(WEIGHT, 0x000000, alpha);\r\n    forEach(range(grid, height, grid), (i) =>\r\n      g.moveTo(0, i + WEIGHT / 2).lineTo(width, i + WEIGHT / 2)\r\n    );\r\n    forEach(range(grid, width, grid), (i) =>\r\n      g.moveTo(i + WEIGHT / 2, 0).lineTo(i + WEIGHT / 2, height)\r\n    );\r\n  }\r\n);\r\n\r\ntype Props = ComponentProps<typeof Grid>;\r\n\r\nexport function Guides({\r\n  width = 0,\r\n  height = 0,\r\n  x = 0,\r\n  y = 0,\r\n  grid = 5,\r\n  ...params\r\n}: Props) {\r\n  return (\r\n    <Grid\r\n      width={ceil((width + 2) / grid) * grid}\r\n      height={ceil((height + 2) / grid) * grid}\r\n      grid={grid}\r\n      {...params}\r\n    />\r\n  );\r\n}\r\n","import { Graphics } from \"@pixi/graphics\";\r\nimport { map } from \"lodash\";\r\nimport { scale } from \"./config\";\r\nimport { makeGraphic } from \"./makeGraphic\";\r\n\r\nconst WEIGHT = 1.5 / scale;\r\n\r\nexport type GraphicProps = {\r\n  color?: number;\r\n  resolution?: number;\r\n  radius?: number;\r\n};\r\n\r\nexport type LineProps = {\r\n  x1?: number;\r\n  y1?: number;\r\n  x2?: number;\r\n  y2?: number;\r\n};\r\n\r\nexport type NodeProps = GraphicProps & LineProps;\r\n\r\nexport const coerce = (obj: any) => ({\r\n  x1: obj?.x,\r\n  y1: obj?.y,\r\n  ...obj,\r\n});\r\n\r\nexport const node = (\r\n  g: Graphics,\r\n  { color, x1 = 0, y1 = 0, radius = 0.25, resolution: r = 1 }: NodeProps\r\n) =>\r\n  g\r\n    .beginFill(color ?? 0x000000)\r\n    .drawCircle(r * (1.5 + x1), r * (1.5 + y1), r * radius)\r\n    .endFill();\r\n\r\nexport const square = (\r\n  g: Graphics,\r\n  { color, x1 = 0, y1 = 0, radius = 0.5, resolution: r = 1 }: NodeProps\r\n) =>\r\n  g\r\n    .beginFill(color ?? 0x000000)\r\n    .drawRect(\r\n      r * (radius / 2 + x1),\r\n      r * (radius / 2 + y1),\r\n      r * radius,\r\n      r * radius\r\n    )\r\n    .endFill();\r\n\r\nexport const box = (\r\n  g: Graphics,\r\n  { color, x1 = 0, y1 = 0, resolution: r = 1 }: NodeProps\r\n) =>\r\n  g\r\n    .beginFill(color ?? 0x000000)\r\n    .drawRect(r * x1, r * y1, r * 1, r * 1)\r\n    .endFill();\r\n\r\nexport const line = (\r\n  g: Graphics,\r\n  { color, x1 = 0, y1 = 0, x2 = 0, y2 = 0 }: NodeProps\r\n) => g.moveTo(x1, y1).lineStyle(WEIGHT, color, 1).lineTo(x2, y2);\r\n\r\nexport const [Node, Box, Square, Line] = map([node, box, square, line], (f) =>\r\n  makeGraphic<NodeProps>((g, p) => {\r\n    g.clear();\r\n    f(g, p);\r\n  })\r\n);\r\n","import { Graphics } from \"@inlet/react-pixi\";\r\nimport { constant, filter, floor, memoize, slice } from \"lodash\";\r\nimport * as PIXI from \"pixi.js\";\r\nimport { Trace, TraceEventType } from \"protocol/Trace\";\r\nimport { useCallback, useMemo } from \"react\";\r\nimport { box, coerce, NodeProps } from \"./Node\";\r\n\r\ntype Props = {\r\n  nodes: Trace[\"eventList\"];\r\n  color?: (type?: TraceEventType) => number;\r\n  variant?: (g: PIXI.Graphics, options: NodeProps) => PIXI.Graphics;\r\n  resolution?: number;\r\n  condition?: (step: number) => boolean;\r\n};\r\n\r\nconst defaultCondition = constant(true);\r\n\r\nexport function NodeList({\r\n  nodes,\r\n  color,\r\n  variant = box,\r\n  resolution = 1,\r\n  condition = defaultCondition,\r\n}: Props) {\r\n  const memo = useMemo(\r\n    () => filter(nodes, (_, i) => condition(i)),\r\n    [nodes, condition]\r\n  );\r\n  const draw = useCallback(\r\n    (g: PIXI.Graphics) => {\r\n      g.clear();\r\n      for (const { variables: v, type } of memo) {\r\n        variant(g, {\r\n          ...coerce(v),\r\n          color: color?.(type) ?? 0xf1f1f1,\r\n          radius: 0.25,\r\n          resolution,\r\n        });\r\n      }\r\n      return g;\r\n    },\r\n    [memo, color, resolution, variant]\r\n  );\r\n  return <Graphics draw={draw} />;\r\n}\r\n\r\nconst down = (n: number, a: number = 1) => floor(n / a) * a;\r\n\r\nexport function LazyNodeList({\r\n  nodes,\r\n  step = 0,\r\n  size = 2500,\r\n  condition,\r\n  ...props\r\n}: {\r\n  step?: number;\r\n  size?: number;\r\n} & Props) {\r\n  const threshold = down(step, size);\r\n\r\n  const chunk = useMemo(\r\n    () => memoize((n: number) => slice(nodes, 0, n)),\r\n    [nodes]\r\n  );\r\n\r\n  const c = useCallback(\r\n    (n: number) => condition?.(n + threshold) ?? true,\r\n    [condition, threshold]\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <NodeList {...props} nodes={chunk(threshold)} condition={condition} />\r\n      <NodeList\r\n        {...props}\r\n        nodes={slice(nodes, threshold, step + 1)}\r\n        condition={c}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { Point } from \"components/specimen-renderer/Renderer\";\r\nimport { floor, map } from \"lodash\";\r\nimport { getColor } from \"../colors\";\r\nimport { Square } from \"./Node\";\r\n\r\ntype OverlayProps = {\r\n  start?: number;\r\n  end?: number;\r\n  size?: Point;\r\n};\r\nexport function Overlay({\r\n  start = 0,\r\n  end = 0,\r\n  size = { x: 0, y: 0 },\r\n}: OverlayProps) {\r\n  return (\r\n    <>\r\n      {map(\r\n        [\r\n          { color: getColor(\"destination\"), node: end },\r\n          { color: getColor(\"source\"), node: start },\r\n        ],\r\n        ({ color, node }, i) => (\r\n          <Square\r\n            key={i}\r\n            x={node % size.x}\r\n            y={floor(node / size.x)}\r\n            color={color}\r\n          />\r\n        )\r\n      )}\r\n    </>\r\n  );\r\n}\r\n","import { Graphics } from \"@inlet/react-pixi\";\r\nimport { Graphics as PixiGraphics } from \"@pixi/graphics\";\r\nimport { isNull, isUndefined, keyBy } from \"lodash\";\r\nimport { TraceEvent } from \"protocol/Trace\";\r\nimport { useMemo } from \"react\";\r\nimport { getColor } from \"../colors\";\r\nimport { scale } from \"./config\";\r\nimport { Square } from \"./Node\";\r\n\r\nconst WEIGHT = 3 / scale;\r\n\r\nfunction defined<T>(obj: T): obj is Exclude<T, undefined | null> {\r\n  return !isUndefined(obj) && !isNull(obj);\r\n}\r\n\r\ntype PathProps = {\r\n  nodes?: TraceEvent[];\r\n  step?: number;\r\n};\r\n\r\nexport function Path({ nodes = [], step = 0 }: PathProps) {\r\n  const path = useMemo(() => {\r\n    const memo = keyBy(nodes, \"id\");\r\n    return (s: number) => {\r\n      const out = [];\r\n      let next: TraceEvent | undefined = nodes[s];\r\n      while (next) {\r\n        out.push(next);\r\n        next = defined(next.pId) ? memo[`${next.pId}`] : undefined;\r\n      }\r\n      return out;\r\n    };\r\n  }, [nodes]);\r\n\r\n  const draw = useMemo(() => {\r\n    const p = path(step);\r\n    return (g: PixiGraphics) => {\r\n      g.clear();\r\n      for (const [i, node] of p.entries()) {\r\n        const { x = 0, y = 0 } = node?.variables ?? {};\r\n        g.lineTo(x + 0.5, y + 0.5);\r\n        if (!i) g.lineStyle(WEIGHT, getColor(\"source\"));\r\n      }\r\n    };\r\n  }, [path, step]);\r\n\r\n  return (\r\n    <>\r\n      <Graphics draw={draw} />\r\n      <Square\r\n        x={nodes?.[step]?.variables?.x ?? 0}\r\n        y={nodes?.[step]?.variables?.y ?? 0}\r\n        color={getColor(\"source\")}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { find } from \"lodash\";\r\nimport { Viewport as PixiViewportBase } from \"pixi-viewport\";\r\nimport * as PIXI from \"pixi.js\";\r\n\r\nexport type ViewportEvent = {\r\n  global: PIXI.Point;\r\n  world: PIXI.Point;\r\n  event: PointerEvent;\r\n};\r\n\r\nexport type ViewportEventHandler = (e: ViewportEvent) => void;\r\n\r\nexport type PointerEvent = \"onMouseOver\" | \"onClick\" | \"onMouseDown\";\r\n\r\nexport type PropEventPair = {\r\n  prop: PointerEvent;\r\n  event: string;\r\n  filter?: boolean;\r\n};\r\n\r\nexport const events = [\r\n  { prop: \"onClick\", event: \"pointerup\", filter: true },\r\n  { prop: \"onMouseOver\", event: \"mousemove\" },\r\n  { prop: \"onMouseDown\", event: \"pointerdown\", filter: true },\r\n] as PropEventPair[];\r\n\r\nexport class PixiViewport extends PixiViewportBase {\r\n  events: {\r\n    [K in string]?: () => void;\r\n  } = {};\r\n  register(prop: PointerEvent, handler?: ViewportEventHandler) {\r\n    const { event, filter } = find(events, (c) => c.prop === prop)!;\r\n    this.events?.[event]?.();\r\n    if (handler) {\r\n      const f = (e: PIXI.InteractionEvent) => {\r\n        const { global } = e.data;\r\n        if (!filter || this.input.last?.equals(global)) {\r\n          handler?.({\r\n            global,\r\n            world: this.toWorld(global),\r\n            event: prop,\r\n          });\r\n        }\r\n      };\r\n      this.on(event, f);\r\n      this.events[event] = () => this.off(event, f);\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Adapted from https://codesandbox.io/s/react-pixi-viewport-9ngfd\r\n * @author roxgarage\r\n */\r\n\r\nimport { PixiComponent, useApp } from \"@inlet/react-pixi\";\r\nimport { map } from \"lodash\";\r\nimport * as PIXI from \"pixi.js\";\r\nimport React from \"react\";\r\nimport { scale } from \"./config\";\r\nimport {\r\n  PointerEvent,\r\n  PixiViewport,\r\n  events,\r\n  ViewportEventHandler,\r\n} from \"./PixiViewport\";\r\n\r\nexport type ViewportProps = {\r\n  width?: number;\r\n  height?: number;\r\n  children?: React.ReactNode;\r\n  event?: PIXI.InteractionEvent;\r\n} & { [K in PointerEvent]?: ViewportEventHandler };\r\n\r\nexport type Props = {\r\n  app: PIXI.Application;\r\n} & ViewportProps;\r\n\r\nfunction create(props: Props) {\r\n  const viewport = new PixiViewport({\r\n    interaction: props.app.renderer.plugins.interaction,\r\n    ticker: props.app.ticker,\r\n    stopPropagation: true,\r\n    passiveWheel: false,\r\n  })\r\n    .drag()\r\n    .pinch()\r\n    .wheel()\r\n    .decelerate({ friction: 0.98 })\r\n    .clampZoom({ maxScale: 10 * scale, minScale: 0.001 * scale })\r\n    .zoomPercent(scale);\r\n  return viewport as PixiViewport;\r\n}\r\n\r\nfunction applyProps(\r\n  v: PixiViewport,\r\n  prev: Props,\r\n  { width, height, ...next }: Props\r\n) {\r\n  for (const { equal, apply } of [\r\n    ...map(events, ({ prop }) => ({\r\n      equal: prev[prop] === next[prop],\r\n      apply: () => v.register(prop, next[prop]),\r\n    })),\r\n    {\r\n      prop: prev.width === width && prev.height === height,\r\n      apply: () => v.resize(width, height, (width ?? 0) * 2, (height ?? 0) * 2),\r\n    },\r\n  ]) {\r\n    !equal && apply();\r\n  }\r\n}\r\n\r\nconst Component = PixiComponent<Props, PixiViewport>(\"Viewport\", {\r\n  create: (props) => {\r\n    const viewport = create(props);\r\n    applyProps(viewport, props, props);\r\n    return viewport;\r\n  },\r\n  applyProps,\r\n});\r\n\r\nexport const Viewport = (props: ViewportProps) => {\r\n  const app = useApp();\r\n  return <Component app={app} {...props} />;\r\n};\r\n","import { Stage } from \"@inlet/react-pixi\";\nimport { Box } from \"@material-ui/core\";\nimport { ComponentProps, forwardRef, ReactNode } from \"react\";\nimport { RendererProps } from \"../Renderer\";\nimport { Viewport } from \"../raster-renderer/Viewport\";\n\ntype RasterRendererProps = RendererProps & {\n  children?: ReactNode;\n  StageProps?: ComponentProps<typeof Stage>;\n  ViewportProps?: ComponentProps<typeof Viewport>;\n};\n\nexport const RasterRenderer = forwardRef<unknown, RasterRendererProps>(\n  ({ children, width, height, ViewportProps, StageProps }, ref) => (\n    <Box sx={{ cursor: \"pointer\" }} ref={ref}>\n      <Stage options={{ backgroundColor: 0xffffff }} {...StageProps}>\n        <Viewport width={width} height={height} {...ViewportProps}>\n          {children}\n        </Viewport>\n      </Stage>\n    </Box>\n  )\n);\n","import { map } from \"lodash\";\r\nimport { Point } from \"components/specimen-renderer/Renderer\";\r\nimport { useTween } from \"react-use\";\r\nimport { ComponentProps as PropsOf } from \"react\";\r\nimport { Node } from \"../raster-renderer/Node\";\r\n\r\ntype SelectedProps = {\r\n  animateScale?: boolean;\r\n  animateAlpha?: boolean;\r\n} & PropsOf<typeof Node>;\r\n\r\ntype Props = {\r\n  hover?: Point;\r\n  highlight?: Point;\r\n};\r\n\r\nexport function Selected({\r\n  x = 0,\r\n  y = 0,\r\n  alpha = 0,\r\n  animateScale,\r\n  animateAlpha,\r\n  ...props\r\n}: SelectedProps) {\r\n  const t = useTween(\"outCirc\", 300);\r\n  return (\r\n    <Node\r\n      {...props}\r\n      scale={animateScale ? t : 1}\r\n      x={x - 1 + (animateScale ? 1.5 - 1.5 * t : 0)}\r\n      y={y - 1 + (animateScale ? 1.5 - 1.5 * t : 0)}\r\n      radius={1}\r\n      alpha={(animateAlpha ? t : 1) * alpha}\r\n    />\r\n  );\r\n}\r\n\r\nexport function Selection({ hover, highlight }: Props) {\r\n  return (\r\n    <>\r\n      {map(\r\n        [\r\n          { point: hover, alpha: 0.08, animateAlpha: true },\r\n          { point: highlight, alpha: 0.08, animateScale: true },\r\n        ],\r\n        ({ point, ...props }, i) =>\r\n          point && (\r\n            <Selected\r\n              key={`${i}::${point.x}::${point.y}`}\r\n              x={point.x}\r\n              y={point.y}\r\n              color={0x000000}\r\n              {...props}\r\n            />\r\n          )\r\n      )}\r\n    </>\r\n  );\r\n}\r\n","import { Point, SelectionInfo } from \"components/specimen-renderer/Renderer\";\r\nimport { findIndex, findLastIndex, take } from \"lodash\";\r\nimport { Trace } from \"protocol/Trace\";\r\nimport { parseMap } from \"./parseMap\";\r\n\r\nfunction between(v: number, min: number, max: number) {\r\n  return v >= min && v < max;\r\n}\r\n\r\nexport function selectionInfo(map: string = \"\", specimen: Trace = {}) {\r\n  const [{ x: w, y: h }, , valid] = parseMap(map);\r\n  return ({ x, y }: Point, step: number = 0) => {\r\n    const nodes = take(specimen?.eventList, step);\r\n    const node = findLastIndex(\r\n      nodes,\r\n      ({ variables: v }) => (v?.x ?? 0) === x && (v?.y ?? 0) === y\r\n    );\r\n    const entry = findIndex(\r\n      specimen?.eventList,\r\n      ({ variables: v, type }) =>\r\n        type === \"expanding\" && (v?.x ?? 0) === x && (v?.y ?? 0) === y\r\n    );\r\n    return {\r\n      current: node !== -1 ? { index: node, event: nodes[node] } : undefined,\r\n      entry: entry !== -1 ? { index: entry, event: nodes[entry] } : undefined,\r\n      node:\r\n        between(x, 0, w) && between(y, 0, h) && valid({ x, y })\r\n          ? { key: y * w + x }\r\n          : undefined,\r\n    } as SelectionInfo;\r\n  };\r\n}\r\n","import { Stage } from \"@inlet/react-pixi\";\r\nimport { blueGrey } from \"@material-ui/core/colors\";\r\nimport { call } from \"components/script-editor/call\";\r\nimport { Point, RendererProps } from \"components/specimen-renderer/Renderer\";\r\nimport { constant, delay, floor, memoize, merge, once } from \"lodash\";\r\nimport { ComponentProps, useMemo, useState } from \"react\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { getColor, hex } from \"../colors\";\r\nimport { Guides } from \"../raster-renderer/Guides\";\r\nimport {\r\n  LazyNodeList as LazyNodes,\r\n  NodeList as Nodes,\r\n} from \"../raster-renderer/NodeList\";\r\nimport { Overlay } from \"../raster-renderer/Overlay\";\r\nimport { Path } from \"../raster-renderer/Path\";\r\nimport { ViewportEvent } from \"../raster-renderer/PixiViewport\";\r\nimport { RasterRenderer } from \"../raster-renderer/RasterRenderer\";\r\nimport { getDefaults } from \"./getDefaults\";\r\nimport { parseMap } from \"./parseMap\";\r\nimport { Selection } from \"./Selection\";\r\nimport { selectionInfo } from \"./selectionInfo\";\r\n\r\ntype GridRendererProps = RendererProps &\r\n  Omit<ComponentProps<typeof Stage>, \"onSelect\">;\r\n\r\nfunction getPoint({ x, y }: Point) {\r\n  return { x: floor(x), y: floor(y) };\r\n}\r\n\r\nexport function GridRenderer({\r\n  onSelect,\r\n  selection,\r\n  ...props\r\n}: GridRendererProps) {\r\n  const [ref, setRef] = useState<HTMLDivElement | null>(null);\r\n  const [{ specimen, map: m }] = useSpecimen();\r\n  const [{ step = 0, code, ...state }] = useUIState();\r\n\r\n  const [active, setActive] = useState<Point | undefined>(undefined);\r\n  const [hover, setHover] = useState<Point | undefined>(undefined);\r\n\r\n  const [[size, bgNodes], bgNodeColor, { start, end }] = useMemo(\r\n    () =>\r\n      [\r\n        parseMap(m),\r\n        once(() => hex(blueGrey[\"500\"])),\r\n        merge(getDefaults(m), { start: state.start, end: state.end }),\r\n      ] as const,\r\n    [m, state.start, state.end]\r\n  );\r\n\r\n  const handleClick = useMemo(() => {\r\n    const info = selectionInfo(m, specimen);\r\n    return (step: number = 0) =>\r\n      ({ global, world }: ViewportEvent) => {\r\n        if (ref && specimen) {\r\n          const { top, left } = ref.getBoundingClientRect();\r\n          const point = getPoint(world);\r\n          onSelect?.({\r\n            global: { x: left + global.x, y: top + global.y },\r\n            world: point,\r\n            info: info(point, step),\r\n          });\r\n        }\r\n      };\r\n  }, [ref, onSelect, specimen, m]);\r\n\r\n  const handleMouseEvent = useMemo(() => {\r\n    let timeout = 0;\r\n    return ({ world, event }: ViewportEvent) => {\r\n      switch (event) {\r\n        case \"onMouseOver\":\r\n          setHover(getPoint(world));\r\n          setActive(undefined);\r\n          clearTimeout(timeout);\r\n          break;\r\n        case \"onMouseDown\":\r\n          timeout = delay(() => setActive(getPoint(world)), 100);\r\n          break;\r\n      }\r\n    };\r\n  }, [setHover]);\r\n\r\n  const condition = useMemo(() => {\r\n    if (code && specimen?.eventList) {\r\n      return memoize((n: number) =>\r\n        code && specimen?.eventList\r\n          ? call(code ?? \"\", \"shouldRender\", [\r\n              n,\r\n              specimen.eventList[n],\r\n              specimen.eventList,\r\n            ])\r\n          : true\r\n      );\r\n    } else return constant(true);\r\n  }, [code, specimen?.eventList]);\r\n\r\n  return (\r\n    <RasterRenderer\r\n      ref={setRef}\r\n      StageProps={props}\r\n      ViewportProps={{\r\n        onClick: handleClick(step),\r\n        onMouseDown: handleMouseEvent,\r\n        onMouseOver: handleMouseEvent,\r\n      }}\r\n    >\r\n      <Nodes nodes={specimen?.eventList} />\r\n      <Nodes nodes={bgNodes} color={bgNodeColor} />\r\n      <LazyNodes\r\n        nodes={specimen?.eventList}\r\n        step={step}\r\n        color={getColor}\r\n        condition={condition}\r\n      />\r\n      <Overlay start={start} end={end} size={size} />\r\n      <Path nodes={specimen?.eventList} step={step} />\r\n      <Selection hover={hover} highlight={selection || active} />\r\n      <Guides width={size.x} height={size.y} alpha={0.24} grid={1} />\r\n    </RasterRenderer>\r\n  );\r\n}\r\n","export function getDefaults(\r\n  m: string = \"\",\r\n  vert: string = \"v\",\r\n  edge: string = \"e\"\r\n) {\r\n  return {\r\n    start: 0,\r\n    end: 0,\r\n  };\r\n}\r\n","import { Point } from \"components/specimen-renderer/Renderer\";\r\nimport { max, maxBy, minBy, split } from \"lodash\";\r\nimport { TraceEvent } from \"protocol/Trace\";\r\n\r\nenum Index {\r\n  X,\r\n  Y,\r\n}\r\n\r\nconst mag = (n: number) => 10 ** Math.log10(n);\r\n\r\nexport function parseMap(\r\n  m: string = \"\",\r\n  vert: string = \"v\",\r\n  edge: string = \"e\"\r\n) {\r\n  const lines = split(m, \"\\n\");\r\n  const verts = lines\r\n    .filter((c) => c.startsWith(vert))\r\n    .map((c: string) => {\r\n      const [, , x, y] = split(c, \" \");\r\n      return [+x, +y] as [number, number];\r\n    });\r\n  const edges = lines\r\n    .filter((c) => c.startsWith(edge))\r\n    .map((c: string) => {\r\n      const [, a, b] = split(c, \" \");\r\n      return [+a, +b] as [number, number];\r\n    });\r\n  const [[minX, minY], [maxX, maxY]] = [minAt, maxAt].map((f) =>\r\n    [Index.X, Index.Y].map((i) => f(verts, i) ?? 0)\r\n  );\r\n  const [width, height] = [maxX - minX, maxY - minY];\r\n  const scale = 100 / mag(max([width, height]) ?? 0);\r\n  return [\r\n    { x: width * scale, y: height * scale },\r\n    edges.map(([a, b]) => {\r\n      const [[x1, y1], [x2, y2]] = [verts[a], verts[b]];\r\n      return {\r\n        variables: {\r\n          x1: (x1 - minX) * scale,\r\n          y1: (y1 - minY) * scale,\r\n          x2: (x2 - minX) * scale,\r\n          y2: (y2 - minY) * scale,\r\n        },\r\n      };\r\n    }) as TraceEvent[],\r\n    ({ x, y }: Point) => false,\r\n  ] as const;\r\n}\r\n\r\nconst minAt = (c: number[][], index: number) => minBy(c, index)?.[index];\r\nconst maxAt = (c: number[][], index: number) => maxBy(c, index)?.[index];\r\n","import { Point } from \"components/specimen-renderer/Renderer\";\r\nimport { map } from \"lodash\";\r\nimport { ComponentProps as PropsOf } from \"react\";\r\nimport { useTween } from \"react-use\";\r\nimport { Node } from \"../raster-renderer/Node\";\r\n\r\ntype SelectedProps = {\r\n  animateScale?: boolean;\r\n  animateAlpha?: boolean;\r\n} & PropsOf<typeof Node>;\r\n\r\ntype Props = {\r\n  hover?: Point;\r\n  highlight?: Point;\r\n};\r\n\r\nexport function Selected({\r\n  x = 0,\r\n  y = 0,\r\n  animateScale,\r\n  animateAlpha,\r\n  ...props\r\n}: SelectedProps) {\r\n  const t = useTween(\"outCirc\", 300);\r\n  return (\r\n    <Node\r\n      {...props}\r\n      scale={animateScale ? t : 1}\r\n      x={x + (animateScale ? 1.5 - 1.5 * t : 0)}\r\n      y={y + (animateScale ? 1.5 - 1.5 * t : 0)}\r\n      radius={1}\r\n      alpha={animateAlpha ? t : 1}\r\n    />\r\n  );\r\n}\r\n\r\nexport function Selection({ hover, highlight }: Props) {\r\n  return (\r\n    <>\r\n      {map(\r\n        [\r\n          { point: hover, color: 0xf9f9f9, animateAlpha: true },\r\n          { point: highlight, color: 0xf1f1f1, animateScale: true },\r\n        ],\r\n        ({ point, ...props }, i) =>\r\n          point && (\r\n            <Selected\r\n              key={`${i}::${point.x}::${point.y}`}\r\n              x={point.x}\r\n              y={point.y}\r\n              {...props}\r\n            />\r\n          )\r\n      )}\r\n    </>\r\n  );\r\n}\r\n","import { Point, SelectionInfo } from \"components/specimen-renderer/Renderer\";\r\nimport { findIndex, findLastIndex, take } from \"lodash\";\r\nimport { Trace } from \"protocol/Trace\";\r\nimport { parseMap } from \"./parseMap\";\r\n\r\nfunction between(v: number, min: number, max: number) {\r\n  return v >= min && v < max;\r\n}\r\n\r\nexport function selectionInfo(map: string = \"\", specimen: Trace = {}) {\r\n  const [{ x: w, y: h }, , valid] = parseMap(map);\r\n  return ({ x, y }: Point, step: number = 0) => {\r\n    const nodes = take(specimen?.eventList, step);\r\n    const node = findLastIndex(\r\n      nodes,\r\n      ({ variables: v }) => (v?.x ?? 0) === x && (v?.y ?? 0) === y\r\n    );\r\n    const entry = findIndex(\r\n      specimen?.eventList,\r\n      ({ variables: v, type }) =>\r\n        type === \"expanding\" && (v?.x ?? 0) === x && (v?.y ?? 0) === y\r\n    );\r\n    return {\r\n      current: node !== -1 ? { index: node, event: nodes[node] } : undefined,\r\n      entry: entry !== -1 ? { index: entry, event: nodes[entry] } : undefined,\r\n      node:\r\n        between(x, 0, w) && between(y, 0, h) && valid({ x, y })\r\n          ? { key: y * w + x }\r\n          : undefined,\r\n    } as SelectionInfo;\r\n  };\r\n}\r\n","import { Stage } from \"@inlet/react-pixi\";\r\nimport { blueGrey } from \"@material-ui/core/colors\";\r\nimport { call } from \"components/script-editor/call\";\r\nimport { Point, RendererProps } from \"components/specimen-renderer/Renderer\";\r\nimport { constant, delay, memoize, merge, once } from \"lodash\";\r\nimport { ComponentProps, useMemo, useState } from \"react\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { getColor, hex } from \"../colors\";\r\nimport { Guides } from \"../raster-renderer/Guides\";\r\nimport { line } from \"../raster-renderer/Node\";\r\nimport {\r\n  LazyNodeList as LazyNodes,\r\n  NodeList as Nodes,\r\n} from \"../raster-renderer/NodeList\";\r\nimport { Overlay } from \"../raster-renderer/Overlay\";\r\nimport { Path } from \"../raster-renderer/Path\";\r\nimport { ViewportEvent } from \"../raster-renderer/PixiViewport\";\r\nimport { RasterRenderer } from \"../raster-renderer/RasterRenderer\";\r\nimport { getDefaults } from \"./getDefaults\";\r\nimport { parseMap } from \"./parseMap\";\r\nimport { Selection } from \"./Selection\";\r\nimport { selectionInfo } from \"./selectionInfo\";\r\n\r\ntype NetworkRendererProps = RendererProps &\r\n  Omit<ComponentProps<typeof Stage>, \"onSelect\">;\r\n\r\nfunction getPoint({ x, y }: Point) {\r\n  return { x: x - 1.5, y: y - 1.5 };\r\n}\r\n\r\nexport function NetworkRenderer({\r\n  onSelect,\r\n  selection,\r\n  ...props\r\n}: NetworkRendererProps) {\r\n  const [ref, setRef] = useState<HTMLDivElement | null>(null);\r\n  const [{ specimen, map: m }] = useSpecimen();\r\n  const [{ step = 0, code, ...state }] = useUIState();\r\n\r\n  const [active, setActive] = useState<Point | undefined>(undefined);\r\n\r\n  const [[size, bgNodes], bgNodeColor, { start, end }] = useMemo(\r\n    () =>\r\n      [\r\n        parseMap(m),\r\n        once(() => hex(blueGrey[\"500\"])),\r\n        merge(getDefaults(m), { start: state.start, end: state.end }),\r\n      ] as const,\r\n    [m, state.start, state.end]\r\n  );\r\n\r\n  const handleClick = useMemo(() => {\r\n    const info = selectionInfo(m, specimen);\r\n    return ({ global, world }: ViewportEvent, step: number = 0) => {\r\n      if (ref && specimen) {\r\n        const { top, left } = ref.getBoundingClientRect();\r\n        const point = getPoint(world);\r\n        onSelect?.({\r\n          global: { x: left + global.x, y: top + global.y },\r\n          world: point,\r\n          info: info(point),\r\n        });\r\n      }\r\n    };\r\n  }, [ref, onSelect, specimen, m]);\r\n\r\n  const handleMouseEvent = useMemo(() => {\r\n    let timeout = 0;\r\n    return ({ world, event }: ViewportEvent) => {\r\n      switch (event) {\r\n        case \"onMouseOver\":\r\n          setActive(undefined);\r\n          clearTimeout(timeout);\r\n          break;\r\n        case \"onMouseDown\":\r\n          timeout = delay(() => setActive(getPoint(world)), 100);\r\n          break;\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const condition = useMemo(() => {\r\n    if (code && specimen?.eventList) {\r\n      return memoize((n: number) =>\r\n        code && specimen?.eventList\r\n          ? call(code ?? \"\", \"shouldRender\", [\r\n              n,\r\n              specimen.eventList[n],\r\n              specimen.eventList,\r\n            ])\r\n          : true\r\n      );\r\n    } else return constant(true);\r\n  }, [code, specimen?.eventList]);\r\n\r\n  return (\r\n    <RasterRenderer\r\n      ref={setRef}\r\n      StageProps={props}\r\n      ViewportProps={{\r\n        onClick: (e) => handleClick(e, step),\r\n        onMouseDown: handleMouseEvent,\r\n        onMouseOver: handleMouseEvent,\r\n      }}\r\n    >\r\n      <Selection highlight={selection || active} />\r\n      <Nodes nodes={specimen?.eventList} />\r\n      <Nodes nodes={bgNodes} color={bgNodeColor} variant={line} />\r\n      <LazyNodes\r\n        nodes={specimen?.eventList}\r\n        step={step}\r\n        color={getColor}\r\n        condition={condition}\r\n      />\r\n      <Overlay start={start} end={end} size={size} />\r\n      <Path nodes={specimen?.eventList} step={step} />\r\n      <Guides width={size.x} height={size.y} alpha={0.24} grid={1} />\r\n    </RasterRenderer>\r\n  );\r\n}\r\n","import { get } from \"lodash\";\r\nimport { DefaultRenderer } from \"./default-renderer/DefaultRenderer\";\r\nimport { getDefaults } from \"./default-renderer/getDefaults\";\r\nimport { getDefaults as getGridDefaults } from \"./grid-renderer/getDefaults\";\r\nimport { GridRenderer } from \"./grid-renderer/GridRenderer\";\r\nimport { getDefaults as getNetworkDefaults } from \"./network-renderer/getDefaults\";\r\nimport { NetworkRenderer } from \"./network-renderer/NetworkRenderer\";\r\nimport { RendererEntry, RendererMap } from \"./Renderer\";\r\n\r\nconst renderers: RendererMap = {\r\n  grid: [GridRenderer, getGridDefaults],\r\n  json: [GridRenderer, getGridDefaults],\r\n  xy: [NetworkRenderer, getNetworkDefaults],\r\n};\r\n\r\nexport function getRenderer(key = \"\") {\r\n  return get(renderers, key, [DefaultRenderer, getDefaults] as RendererEntry);\r\n}\r\n","import { Card, Stack } from \"@material-ui/core\";\nimport { ReactNode } from \"react\";\nimport { acrylic } from \"theme\";\n\nexport function Toolbar({ children }: { children?: ReactNode }) {\n  return (\n    <Card\n      sx={{\n        m: 3,\n        px: 1.25,\n        height: 56,\n        display: \"flex\",\n        alignItems: \"center\",\n        pointerEvents: \"all\",\n        ...acrylic,\n      }}\n    >\n      <Stack spacing={1.25} direction=\"row\">\n        {children}\n      </Stack>\n    </Card>\n  );\n}\n","import { Box, BoxProps } from \"@material-ui/core\";\r\nimport { ReactElement } from \"react\";\r\nimport {\r\n  Virtuoso as List,\r\n  VirtuosoHandle as Handle,\r\n  VirtuosoProps as ListProps,\r\n} from \"react-virtuoso\";\r\n\r\nexport type LazyListHandle = Handle;\r\n\r\nexport type LazyListProps<T> = {\r\n  items?: T[];\r\n  renderItem?: (item: T, index: number) => ReactElement;\r\n  listOptions?: Partial<ListProps<T>>;\r\n} & BoxProps;\r\n\r\nexport function LazyList<T>({\r\n  items = [],\r\n  renderItem,\r\n  listOptions: options,\r\n  ...props\r\n}: LazyListProps<T>) {\r\n  return (\r\n    <Box {...props}>\r\n      <List\r\n        totalCount={items.length}\r\n        itemContent={(i) => renderItem?.(items[i], i)}\r\n        {...options}\r\n      />\r\n    </Box>\r\n  );\r\n}\r\n","import { HideSourceOutlined as HiddenIcon } from \"@material-ui/icons\";\nimport { Overline, OverlineDot as Dot } from \"components/generic/Overline\";\nimport { getColorHex } from \"components/specimen-renderer/colors\";\nimport { TraceEvent } from \"protocol/Trace\";\n\nexport function EventLabel({\n  event,\n  hidden,\n}: {\n  event?: TraceEvent;\n  hidden?: boolean;\n}) {\n  return (\n    <Overline>\n      <Dot\n        sx={{\n          color: getColorHex(event?.type),\n          mr: 1,\n        }}\n      />\n      {`${event?.type ?? \"unsupported\"} #${event?.id ?? \"-\"}`}{\" \"}\n      {hidden && (\n        <HiddenIcon\n          sx={{\n            opacity: 0.56,\n            fontSize: 12,\n            ml: 1,\n            transform: \"translateY(1.75px)\",\n          }}\n        />\n      )}\n    </Overline>\n  );\n}\n","import { Flex } from \"./Flex\";\r\nimport {\r\n  Typography as Type,\r\n  TypographyProps as TypeProps,\r\n} from \"@material-ui/core\";\r\nimport { Space } from \"./Space\";\r\nimport { ReactNode } from \"react\";\r\n\r\ntype Props = {\r\n  label?: ReactNode;\r\n  value?: ReactNode;\r\n  type?: TypeProps;\r\n};\r\n\r\nexport function Property({ label, value, type }: Props) {\r\n  return (\r\n    <Flex width=\"auto\" mr={3} mt={0.5} key={`${label}::${value}`}>\r\n      <Type sx={{ opacity: 0.54 }} {...type}>\r\n        {label}\r\n      </Type>\r\n      <Space />\r\n      <Type {...type}>{value}</Type>\r\n    </Flex>\r\n  );\r\n}\r\n","import { TypographyVariant } from \"@material-ui/core\";\nimport { Flex, FlexProps } from \"components/generic/Flex\";\nimport { Property } from \"components/generic/Property\";\nimport { entries, filter, map } from \"lodash\";\nimport { TraceEvent } from \"protocol/Trace\";\n\nexport function PropertyList({\n  event,\n  variant = \"body2\",\n  ...props\n}: {\n  event?: TraceEvent<string>;\n  variant?: TypographyVariant;\n} & FlexProps) {\n  return (\n    <Flex flexWrap=\"wrap\" {...props}>\n      {map(\n        filter(\n          [\n            [\"f\", event?.f],\n            [\"g\", event?.g],\n            ...entries(event?.variables),\n            [\"pId\", event?.pId],\n            [\"info\", event?.info],\n          ],\n          ([, v]) => v !== undefined\n        ),\n        ([k, v]) => (\n          <Property label={k} value={v} type={{ variant }} />\n        )\n      )}\n    </Flex>\n  );\n}\n","import {\r\n  Box,\r\n  Card,\r\n  CardActionArea,\r\n  CardProps,\r\n  Divider,\r\n  Typography as Type,\r\n} from \"@material-ui/core\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { call } from \"components/script-editor/call\";\r\nimport { TraceEvent } from \"protocol/Trace\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { EventLabel } from \"./EventLabel\";\r\nimport { PropertyList } from \"./PropertyList\";\r\n\r\ntype EventInspectorProps = {\r\n  event?: TraceEvent;\r\n  index?: number;\r\n  selected?: boolean;\r\n} & CardProps;\r\n\r\nexport function EventInspector({\r\n  event,\r\n  index,\r\n  selected,\r\n  ...props\r\n}: EventInspectorProps) {\r\n  const [{ specimen }] = useSpecimen();\r\n  const [{ code }, setUIState] = useUIState();\r\n\r\n  const cardStyles = selected\r\n    ? {\r\n        color: \"primary.contrastText\",\r\n        bgcolor: \"primary.main\",\r\n      }\r\n    : {};\r\n\r\n  const hidden = event\r\n    ? !call(code ?? \"\", \"shouldRender\", [\r\n        index ?? 0,\r\n        event,\r\n        specimen?.eventList ?? [],\r\n      ])\r\n    : false;\r\n\r\n  return (\r\n    <Card\r\n      {...props}\r\n      sx={{\r\n        ...cardStyles,\r\n        ...props.sx,\r\n      }}\r\n    >\r\n      <CardActionArea\r\n        sx={{ p: 2, height: \"100%\" }}\r\n        onClick={() => setUIState({ step: index })}\r\n      >\r\n        <Flex alignItems=\"center\">\r\n          <Type>{index}</Type>\r\n          <Divider sx={{ mx: 2 }} flexItem orientation=\"vertical\" />\r\n          <Box>\r\n            <EventLabel event={event} hidden={hidden} />\r\n            <PropertyList event={event} />\r\n          </Box>\r\n        </Flex>\r\n      </CardActionArea>\r\n    </Card>\r\n  );\r\n}\r\n","import { Flex } from \"components/generic/Flex\";\r\nimport {\r\n  LazyList as List,\r\n  LazyListHandle as ListHandle,\r\n  LazyListProps as ListProps,\r\n} from \"components/generic/LazyList\";\r\nimport { delay } from \"lodash\";\r\nimport { TraceEvent } from \"protocol/Trace\";\r\nimport { useEffect, useRef } from \"react\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { EventInspector } from \"./EventInspector\";\r\n\r\nexport function EventListInspector(props: ListProps<TraceEvent>) {\r\n  const [{ step = 0, playback }] = useUIState();\r\n  const [{ specimen }] = useSpecimen();\r\n  const ref = useRef<ListHandle | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (playback === \"paused\") {\r\n      delay(\r\n        () =>\r\n          ref?.current?.scrollToIndex?.({\r\n            index: step,\r\n            align: \"start\",\r\n            behavior: \"smooth\",\r\n            offset: -16,\r\n          }),\r\n        150\r\n      );\r\n    }\r\n  }, [step, playback]);\r\n\r\n  return (\r\n    <Flex>\r\n      <List\r\n        {...props}\r\n        items={specimen?.eventList}\r\n        listOptions={{ ref }}\r\n        renderItem={(item, i) => (\r\n          <Flex p={2} pt={i ? 0 : 2}>\r\n            <EventInspector\r\n              sx={{ flex: 1 }}\r\n              event={item}\r\n              index={i}\r\n              selected={i === step}\r\n            />\r\n          </Flex>\r\n        )}\r\n      />\r\n    </Flex>\r\n  );\r\n}\r\n","import { BoxProps, Button, Card, Fade, Tooltip } from \"@material-ui/core\";\nimport { SortTwoTone as StepsIcon } from \"@material-ui/icons\";\nimport { TabContext, TabPanel } from \"@material-ui/lab\";\nimport { Box } from \"@material-ui/system\";\nimport { Flex } from \"components/generic/Flex\";\nimport { Toolbar } from \"components/generic/Toolbar\";\nimport { startCase } from \"lodash\";\nimport { useState } from \"react\";\nimport { useUIState } from \"slices/UIState\";\nimport { EventListInspector } from \"./EventListInspector\";\n\nexport function InfoPanel(props: BoxProps) {\n  const [{ playback }] = useUIState();\n  const [tab, setTab] = useState(\"steps\");\n  return (\n    <TabContext value={tab}>\n      <Flex\n        vertical\n        sx={{ pointerEvents: \"none\" }}\n        alignItems=\"center\"\n        {...props}\n      >\n        <Toolbar>\n          {[\n            { icon: <StepsIcon />, key: \"steps\" },\n            { key: \"info\" },\n            { key: \"parameters\" },\n          ].map(({ key, icon }) => (\n            <Tooltip title={startCase(key)}>\n              <Button\n                onClick={() => setTab(key === tab ? \"\" : key)}\n                color=\"primary\"\n                variant={key === tab ? \"contained\" : \"text\"}\n                startIcon={icon}\n              >\n                {startCase(key)}\n              </Button>\n            </Tooltip>\n          ))}\n        </Toolbar>\n        {[\n          {\n            key: \"steps\",\n            content: (\n              <Fade unmountOnExit mountOnEnter in={playback === \"paused\"}>\n                <Box height=\"100%\" width=\"100%\" pl={1}>\n                  <EventListInspector height=\"100%\" width=\"100%\" />\n                </Box>\n              </Fade>\n            ),\n          },\n          {\n            key: \"info\",\n            content: <Card sx={{ m: 2, p: 2 }}>-</Card>,\n          },\n          {\n            key: \"parameters\",\n            content: <Card sx={{ m: 2, p: 2 }}>-</Card>,\n          },\n        ].map(({ content, key }) => (\n          <TabPanel\n            value={key}\n            sx={{ pointerEvents: \"all\", flex: 1, p: 0, width: \"100%\" }}\n          >\n            {content}\n          </TabPanel>\n        ))}\n      </Flex>\n    </TabContext>\n  );\n}\n","import { Box } from \"@material-ui/core\";\nimport { ReactNode } from \"react\";\nimport { Flex } from \"./Flex\";\nimport { Space } from \"./Space\";\n\ntype LabelProps = {\n  primary?: ReactNode;\n  secondary?: ReactNode;\n};\n\nexport function Label({ primary, secondary }: LabelProps) {\n  return (\n    <Flex>\n      <Box>{primary}</Box>\n      <Space />\n      <Box sx={{ opacity: 0.56 }}>{secondary}</Box>\n    </Flex>\n  );\n}\n","import {\r\n  Box,\r\n  Divider,\r\n  ListItem,\r\n  ListItemIcon,\r\n  ListItemText,\r\n  Menu,\r\n  MenuItem,\r\n} from \"@material-ui/core\";\r\nimport {\r\n  PlaceOutlined as DestinationIcon,\r\n  TripOriginOutlined as StartIcon,\r\n} from \"@material-ui/icons\";\r\nimport { Overline } from \"components/generic/Overline\";\r\nimport { Property } from \"components/generic/Property\";\r\nimport { map } from \"lodash\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { SelectEvent as RendererSelectEvent } from \"components/specimen-renderer/Renderer\";\r\nimport { useSnackbar } from \"components/generic/Snackbar\";\r\nimport { PropertyList } from \"./PropertyList\";\r\nimport { EventLabel } from \"./EventLabel\";\r\nimport { Label } from \"components/generic/Label\";\r\n\r\ntype Props = {\r\n  selection?: RendererSelectEvent;\r\n  onClose?: () => void;\r\n};\r\n\r\nexport function SelectionMenu({ selection, onClose }: Props) {\r\n  const notify = useSnackbar();\r\n  const [, setUIState] = useUIState();\r\n  const { global, world, info } = selection ?? {};\r\n  const { current, entry, node } = info ?? {};\r\n\r\n  return (\r\n    <Menu\r\n      open={!!selection}\r\n      anchorReference=\"anchorPosition\"\r\n      anchorPosition={{\r\n        top: global?.y ?? 0,\r\n        left: global?.x ?? 0,\r\n      }}\r\n      onClose={onClose}\r\n    >\r\n      <ListItem>\r\n        <ListItemText>\r\n          <Box>\r\n            <Overline>Point</Overline>\r\n            <Property label=\"x\" value={world?.x ?? \"-\"} />\r\n            <Property label=\"y\" value={world?.y ?? \"-\"} />\r\n          </Box>\r\n          {current?.event && (\r\n            <Box mt={2}>\r\n              <EventLabel event={current?.event} />\r\n              <PropertyList event={current?.event} variant=\"body1\" vertical />\r\n            </Box>\r\n          )}\r\n        </ListItemText>\r\n      </ListItem>\r\n      <Divider sx={{ my: 1 }} />\r\n      {map(\r\n        [\r\n          {\r\n            label: \"Set Origin\",\r\n            icon: <StartIcon sx={{ transform: \"scale(0.5)\" }} />,\r\n            action: () => {\r\n              notify(\"Origin set.\");\r\n              setUIState({ start: node?.key });\r\n            },\r\n            disabled: !node,\r\n          },\r\n          {\r\n            label: \"Set Destination\",\r\n            icon: <DestinationIcon />,\r\n            action: () => {\r\n              notify(\"Destination set.\");\r\n              setUIState({ end: node?.key });\r\n            },\r\n            disabled: !node,\r\n          },\r\n          {\r\n            label: (\r\n              <Label primary=\"Go to Expansion Step\" secondary={entry?.index} />\r\n            ),\r\n            action: () =>\r\n              setUIState({ step: entry?.index ?? 0, playback: \"paused\" }),\r\n            disabled: !entry,\r\n          },\r\n          {\r\n            label: (\r\n              <Label primary=\"Rewind to This Step\" secondary={current?.index} />\r\n            ),\r\n            action: () =>\r\n              setUIState({ step: current?.index ?? 0, playback: \"paused\" }),\r\n            disabled: !current,\r\n          },\r\n        ],\r\n        ({ label, icon, action, disabled }) => (\r\n          <MenuItem\r\n            disabled={disabled}\r\n            onClick={() => {\r\n              action();\r\n              onClose?.();\r\n            }}\r\n          >\r\n            <ListItemIcon>{icon}</ListItemIcon>\r\n            <ListItemText>{label}</ListItemText>\r\n          </MenuItem>\r\n        )\r\n      )}\r\n    </Menu>\r\n  );\r\n}\r\n","import { Fade, LinearProgress } from \"@material-ui/core\";\r\nimport { BlurOnTwoTone as DisabledIcon } from \"@material-ui/icons\";\r\nimport { Flex, FlexProps } from \"components/generic/Flex\";\r\nimport { getRenderer } from \"components/specimen-renderer/getRenderer\";\r\nimport { SelectEvent as RendererSelectEvent } from \"components/specimen-renderer/Renderer\";\r\nimport { some, values } from \"lodash\";\r\nimport { createElement, useState } from \"react\";\r\nimport AutoSize from \"react-virtualized-auto-sizer\";\r\nimport { useLoading } from \"slices/loading\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { InfoPanel } from \"./InfoPanel\";\r\nimport { SelectionMenu } from \"./SelectionMenu\";\r\n\r\ntype SpecimenInspectorProps = {} & FlexProps;\r\n\r\nexport function SpecimenInspector(props: SpecimenInspectorProps) {\r\n  const [loading] = useLoading();\r\n  const [{ specimen, format, map }] = useSpecimen();\r\n  const [renderer] = getRenderer(format);\r\n  const [selection, setSelection] = useState<RendererSelectEvent | undefined>(\r\n    undefined\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <Fade in={some(values(loading))}>\r\n        <LinearProgress variant=\"indeterminate\" sx={{ mb: -0.5, zIndex: 1 }} />\r\n      </Fade>\r\n      <Flex {...props}>\r\n        {specimen ? (\r\n          <Flex>\r\n            <AutoSize>\r\n              {(size) =>\r\n                createElement(renderer, {\r\n                  ...size,\r\n                  key: map,\r\n                  onSelect: setSelection,\r\n                  selection: selection?.world,\r\n                })\r\n              }\r\n            </AutoSize>\r\n            <InfoPanel\r\n              position=\"absolute\"\r\n              right={0}\r\n              height=\"100%\"\r\n              width=\"25vw\"\r\n              minWidth={480}\r\n            />\r\n          </Flex>\r\n        ) : (\r\n          <Flex\r\n            justifyContent=\"center\"\r\n            alignItems=\"center\"\r\n            color=\"text.secondary\"\r\n            vertical\r\n          >\r\n            <DisabledIcon sx={{ mb: 2 }} fontSize=\"large\" />\r\n            Select a map to get started.\r\n          </Flex>\r\n        )}\r\n      </Flex>\r\n      <SelectionMenu\r\n        selection={selection}\r\n        onClose={() => setSelection(undefined)}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { Controls } from \"components/app-bar/Controls\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { SpecimenInspector } from \"components/specimen-inspector/SpecimenInspector\";\r\n\r\nfunction App() {\r\n  return (\r\n    <Flex vertical sx={{ bgcolor: \"background.default\" }}>\r\n      <Controls />\r\n      <SpecimenInspector flex={1} />\r\n    </Flex>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import { getTransport } from \"client\";\r\nimport { useSnackbar } from \"components/generic/Snackbar\";\r\nimport { delay, now } from \"lodash\";\r\nimport { useEffect } from \"react\";\r\nimport { Connection, useConnections } from \"slices/connections\";\r\nimport { useLoadingState } from \"slices/loading\";\r\nimport { useSettings } from \"slices/settings\";\r\n\r\nfunction wait(ms: number) {\r\n  return new Promise((res) => delay(res, ms));\r\n}\r\n\r\nasync function timed<T>(task: () => Promise<T>, ms: number = 5000) {\r\n  const from = now();\r\n  const result = (await Promise.any([task(), wait(ms)])) as T | undefined;\r\n  return { result, delta: now() - from };\r\n}\r\n\r\nexport function ConnectionsService() {\r\n  const notify = useSnackbar();\r\n  const [{ remote }] = useSettings();\r\n  const [, setConnections] = useConnections();\r\n  const usingLoadingState = useLoadingState(\"connections\");\r\n\r\n  useEffect(() => {\r\n    let aborted = false;\r\n    let cs: Connection[] = [];\r\n    usingLoadingState(async () => {\r\n      notify(\"Connecting...\");\r\n      for (const { transport: t, url, disabled } of remote ?? []) {\r\n        if (!disabled) {\r\n          const tp = new (getTransport(t))({ url });\r\n          await tp.connect();\r\n          const { result, delta } = await timed(() => tp.call(\"about\"));\r\n          if (result) {\r\n            cs = [\r\n              ...cs,\r\n              {\r\n                ...result,\r\n                url,\r\n                ping: delta,\r\n                call: tp.call.bind(tp),\r\n                disconnect: tp.disconnect.bind(tp),\r\n              },\r\n            ];\r\n          } else await tp.disconnect();\r\n        }\r\n        if (!aborted) setConnections(cs);\r\n      }\r\n      if (!aborted)\r\n        notify(`Connected to ${cs.length} of ${remote?.length} solvers.`);\r\n    });\r\n    return () => {\r\n      aborted = true;\r\n      cs.map((c) => c.disconnect());\r\n    };\r\n  }, [remote, setConnections, notify, usingLoadingState]);\r\n\r\n  return <></>;\r\n}\r\n","import { call } from \"components/script-editor/call\";\r\nimport { get, keyBy, lowerCase as lower, memoize, startCase } from \"lodash\";\r\nimport { useMemo } from \"react\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\n\r\nexport function useBreakpoints() {\r\n  const [{ specimen }] = useSpecimen();\r\n  const [{ code, breakpoints = [], monotonicF, monotonicG }] = useUIState();\r\n\r\n  return useMemo(() => {\r\n    const memo = keyBy(specimen?.eventList, \"id\");\r\n    return memoize((step: number) => {\r\n      const event = specimen?.eventList?.[step];\r\n      if (event) {\r\n        try {\r\n          // Check monotonic f or g values\r\n          if (step) {\r\n            for (const p of [monotonicF && \"f\", monotonicG && \"g\"]) {\r\n              if (p && get(memo[`${event.pId}`], p) > get(event, p)) {\r\n                return { result: `Monotonicity violation on ${p}` };\r\n              }\r\n            }\r\n          }\r\n          // Check breakpoints in the breakpoints section\r\n          for (const {\r\n            active,\r\n            condition,\r\n            type,\r\n            property = \"\",\r\n            reference = 0,\r\n          } of breakpoints) {\r\n            const isType = !type || type === event.type;\r\n            const match = condition?.apply?.(get(event, property), reference);\r\n            if (active && isType && match) {\r\n              return {\r\n                result: `${property} ${lower(\r\n                  startCase(condition?.key)\r\n                )} ${reference}`,\r\n              };\r\n            }\r\n          }\r\n          // Check breakpoints in the script editor section\r\n          if (\r\n            call(code ?? \"\", \"shouldBreak\", [\r\n              step,\r\n              event,\r\n              specimen?.eventList ?? [],\r\n            ])\r\n          ) {\r\n            return { result: \"Script editor\" };\r\n          }\r\n        } catch (e) {\r\n          return { error: `${e}` };\r\n        }\r\n      }\r\n      return { result: \"\" };\r\n    });\r\n  }, [code, specimen, breakpoints, monotonicF, monotonicG]);\r\n}\r\n","import { useSnackbar } from \"components/generic/Snackbar\";\r\nimport { Label } from \"components/generic/Label\";\r\nimport { usePlaybackState } from \"hooks/usePlaybackState\";\r\nimport { range, trimEnd } from \"lodash\";\r\nimport { ReactNode, useCallback, useEffect } from \"react\";\r\nimport { useRaf } from \"react-use\";\r\nimport { useBreakpoints } from \"../hooks/useBreakpoints\";\r\nimport { useSettings } from \"slices/settings\";\r\n\r\nfunction cancellable<T = void>(f: () => Promise<T>, g: (result: T) => void) {\r\n  let cancelled = false;\r\n  requestAnimationFrame(async () => {\r\n    const result = await f();\r\n    if (!cancelled) g(result);\r\n  });\r\n  return () => {\r\n    cancelled = true;\r\n  };\r\n}\r\n\r\nexport function PlaybackService() {\r\n  useRaf();\r\n\r\n  const notify = useSnackbar();\r\n  const [{ playbackRate = 1 }] = useSettings();\r\n  const { playing, end, step, pause, tick } = usePlaybackState();\r\n  const shouldBreak = useBreakpoints();\r\n\r\n  const renderLabel = useCallback(\r\n    (label: ReactNode, offset: number) => (\r\n      <Label primary={label} secondary={`Step ${step + offset}`} />\r\n    ),\r\n    [step]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (playing) {\r\n      return step < end\r\n        ? cancellable(\r\n            async () => {\r\n              for (const i of range(playbackRate)) {\r\n                const r = shouldBreak(step + i);\r\n                if (r.result || r.error) return { ...r, offset: i };\r\n              }\r\n              return { result: \"\", offset: 0 };\r\n            },\r\n            ({ result, offset, error }) => {\r\n              if (!error) {\r\n                if (result) {\r\n                  notify(renderLabel(`Breakpoint hit: ${result}.`, offset));\r\n                  pause(offset);\r\n                } else tick(playbackRate);\r\n              } else {\r\n                notify(renderLabel(`${trimEnd(error, \".\")}.`, offset));\r\n                pause();\r\n              }\r\n            }\r\n          )\r\n        : pause();\r\n    }\r\n  }, [\r\n    renderLabel,\r\n    playing,\r\n    end,\r\n    step,\r\n    pause,\r\n    tick,\r\n    notify,\r\n    shouldBreak,\r\n    playbackRate,\r\n  ]);\r\n\r\n  return <></>;\r\n}\r\n","import { map, uniqBy } from \"lodash\";\nimport { useAsyncAbortable as useAsync } from \"react-async-hook\";\nimport { useConnections } from \"slices/connections\";\nimport { Features, useFeatures } from \"slices/features\";\nimport { useLoadingState } from \"slices/loading\";\n\nconst withSource = (source: string) => (v: any) => ({ ...v, source });\n\nexport function FeaturesService() {\n  const [connections] = useConnections();\n  const [, setFeatures] = useFeatures();\n  const usingLoadingState = useLoadingState(\"features\");\n\n  useAsync(\n    (signal) =>\n      usingLoadingState(async () => {\n        const features: Features = { algorithms: [], formats: [], maps: [] };\n        for (const { call, url } of connections) {\n          for (const prop of [\"algorithms\", \"formats\", \"maps\"] as const) {\n            features[prop] = uniqBy(\n              [\n                ...features[prop],\n                ...map(await call(`features/${prop}`), withSource(url)),\n              ],\n              \"id\"\n            );\n          }\n        }\n        if (!signal.aborted) setFeatures(features);\n      }),\n    [connections, setFeatures]\n  );\n\n  return <></>;\n}\n","import { memoize as memo } from \"lodash\";\nimport { useMemo } from \"react\";\nimport { useAsync } from \"react-async-hook\";\nimport { useLoadingState } from \"slices/loading\";\nimport { Map, useUIState } from \"slices/UIState\";\nimport { useConnectionResolver } from \"./useConnectionResolver\";\n\nexport function useMapContent() {\n  const usingLoadingState = useLoadingState(\"map\");\n  const resolve = useConnectionResolver();\n  const [{ map }] = useUIState();\n\n  const getMap = useMemo(\n    () =>\n      memo(async ({ source, id }: Map = {}) => {\n        if (source && id) {\n          const connection = resolve({ url: source });\n          if (connection) {\n            const result = await connection.call(\"features/map\", { id });\n            return result?.content;\n          }\n        }\n      }, JSON.stringify),\n    [resolve]\n  );\n\n  return useAsync(\n    () =>\n      usingLoadingState(async () => {\n        if (map && map.id)\n          return {\n            ...map,\n            content: map.content ? map.content : await getMap(map),\n          };\n      }),\n    [getMap, map, usingLoadingState]\n  );\n}\n","type WorkerConstructor = new () => Worker;\n\nexport const usingWorker =\n  <R>(w: WorkerConstructor) =>\n  async (task: (w: Worker) => Promise<R>) => {\n    const worker = new w();\n    const out = await task(worker);\n    worker.terminate();\n    return out;\n  };\n\nexport const usingWorkerTask =\n  <T, R>(w: WorkerConstructor) =>\n  (inp: T) =>\n    usingWorker<R>(w)((worker) => {\n      worker.postMessage(inp);\n      return new Promise<R>((res) => {\n        worker.onmessage = (out) => {\n          res(out.data as R);\n        };\n      });\n    });\n","import { memoize as memo } from \"lodash\";\nimport { HashWorker } from \".\";\nimport { usingWorkerTask } from \"./usingWorker\";\n\nexport const hashAsync = memo(usingWorkerTask<string, string>(HashWorker));\n","import { Transport } from \"client/Transport\";\r\nimport { Label } from \"components/generic/Label\";\r\nimport { useSnackbar } from \"components/generic/Snackbar\";\r\nimport { getRenderer } from \"components/specimen-renderer/getRenderer\";\r\nimport { useConnectionResolver } from \"hooks/useConnectionResolver\";\r\nimport { useMapContent } from \"hooks/useMapContent\";\r\nimport { find } from \"lodash\";\r\nimport { ParamsOf } from \"protocol/Message\";\r\nimport { PathfindingTask } from \"protocol/SolveTask\";\r\nimport { useAsyncAbortable as useAsync } from \"react-async-hook\";\r\nimport { useFeatures } from \"slices/features\";\r\nimport { useLoadingState } from \"slices/loading\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { hashAsync as hash } from \"workers/async\";\r\n\r\nasync function solve(\r\n  map: string,\r\n  params: Omit<ParamsOf<PathfindingTask>, \"mapURI\">,\r\n  call: Transport[\"call\"]\r\n) {\r\n  if (map) {\r\n    for (const mapURI of [\r\n      `hash:${await hash(map)}`,\r\n      `map:${encodeURIComponent(map)}`,\r\n    ] as const) {\r\n      const p = { ...params, mapURI };\r\n      const specimen = await call(\"solve/pathfinding\", p);\r\n      if (specimen) return { ...p, specimen, map };\r\n    }\r\n  }\r\n}\r\n\r\nexport function SpecimenService() {\r\n  const usingLoadingState = useLoadingState(\"specimen\");\r\n  const notify = useSnackbar();\r\n  const [{ formats: format }] = useFeatures();\r\n  const [{ algorithm, start, end }, setUIState] = useUIState();\r\n  const resolve = useConnectionResolver();\r\n  const [, setSpecimen] = useSpecimen();\r\n\r\n  const { result: map } = useMapContent();\r\n\r\n  useAsync(\r\n    (signal) =>\r\n      usingLoadingState(async () => {\r\n        if (map?.format && map?.content) {\r\n          const [, defaults] = getRenderer(map.format);\r\n          const entry = find(format, { id: map.format });\r\n          if (entry) {\r\n            const connection = resolve({ url: entry.source });\r\n            if (connection) {\r\n              try {\r\n                const solution = await solve(\r\n                  map.content,\r\n                  {\r\n                    algorithm,\r\n                    format: map.format,\r\n                    instances: [\r\n                      {\r\n                        end: end ?? defaults(map.content)?.end,\r\n                        start: start ?? defaults(map.content)?.start,\r\n                      },\r\n                    ],\r\n                  },\r\n                  connection.call\r\n                );\r\n                if (solution && !signal.aborted) {\r\n                  setSpecimen(solution);\r\n                  setUIState({ step: 0, playback: \"paused\", breakpoints: [] });\r\n                  notify(\r\n                    <Label\r\n                      primary=\"Solution generated.\"\r\n                      secondary={`${solution.specimen.eventList?.length} steps`}\r\n                    />\r\n                  );\r\n                }\r\n              } catch (e: any) {\r\n                console.log(e);\r\n                notify(\r\n                  <Label primary={`${e.message}`} secondary={connection.name} />\r\n                );\r\n              }\r\n            } else\r\n              notify(\r\n                `No solver is available for the map format (${map.format}).`\r\n              );\r\n          }\r\n        }\r\n      }),\r\n    [\r\n      algorithm,\r\n      start,\r\n      end,\r\n      map,\r\n      notify,\r\n      usingLoadingState,\r\n      format,\r\n      resolve,\r\n      setSpecimen,\r\n    ]\r\n  );\r\n\r\n  return <></>;\r\n}\r\n","import { map, reduce } from \"lodash\";\r\nimport {\r\n  cloneElement,\r\n  createElement,\r\n  FunctionComponent,\r\n  ReactNode,\r\n} from \"react\";\r\n\r\ntype SliceProviderProps = {\r\n  slices?: FunctionComponent[];\r\n  services?: FunctionComponent[];\r\n  children?: ReactNode;\r\n};\r\n\r\nexport function SliceProvider({\r\n  slices,\r\n  children,\r\n  services,\r\n}: SliceProviderProps) {\r\n  return (\r\n    <>\r\n      {reduce(\r\n        map(slices, (s) => createElement(s)),\r\n        (prev, next) => cloneElement(next, {}, prev),\r\n        <>\r\n          {children}\r\n          {map(services, (s, i) => createElement(s, { key: i }))}\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n","import { CssBaseline, ThemeProvider } from \"@material-ui/core\";\r\nimport App from \"App\";\r\nimport { SnackbarProvider } from \"components/generic/Snackbar\";\r\nimport \"index.css\";\r\nimport { StrictMode } from \"react\";\r\nimport { render } from \"react-dom\";\r\nimport reportWebVitals from \"reportWebVitals\";\r\nimport { ConnectionsService } from \"services/ConnectionsService\";\r\nimport { PlaybackService } from \"services/PlaybackService\";\r\nimport { FeaturesService } from \"services/FeaturesService\";\r\nimport { SpecimenService } from \"services/SpecimenService\";\r\nimport { ConnectionsProvider } from \"slices/connections\";\r\nimport { FeaturesProvider } from \"slices/features\";\r\nimport { LoadingProvider } from \"slices/loading\";\r\nimport { SettingsProvider } from \"slices/settings\";\r\nimport { SliceProvider as EnvironmentProvider } from \"slices/SliceProvider\";\r\nimport { SpecimenProvider } from \"slices/specimen\";\r\nimport { UIStateProvider } from \"slices/UIState\";\r\nimport { theme } from \"theme\";\r\n\r\nconst slices = [\r\n  SettingsProvider,\r\n  ConnectionsProvider,\r\n  FeaturesProvider,\r\n  UIStateProvider,\r\n  SpecimenProvider,\r\n  LoadingProvider,\r\n];\r\n\r\nconst services = [\r\n  ConnectionsService,\r\n  PlaybackService,\r\n  SpecimenService,\r\n  FeaturesService,\r\n];\r\n\r\nrender(\r\n  <StrictMode>\r\n    <CssBaseline>\r\n      <ThemeProvider theme={theme}>\r\n        <SnackbarProvider>\r\n          <EnvironmentProvider slices={slices} services={services}>\r\n            <App />\r\n          </EnvironmentProvider>\r\n        </SnackbarProvider>\r\n      </ThemeProvider>\r\n    </CssBaseline>\r\n  </StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}
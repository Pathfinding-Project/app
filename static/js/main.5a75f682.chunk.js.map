{"version":3,"sources":["components/script-editor/transpile.tsx","../node_modules/@babel/standalone sync","components/script-editor/call.tsx","client/theme.tsx","components/generic/Flex.tsx","components/generic/Space.tsx","components/generic/Snackbar.tsx","slices/createSlice.tsx","client/RPCClient.ts","client/getClient.ts","slices/info.tsx","slices/specimen.tsx","components/script-editor/makeTemplate.tsx","components/script-editor/templates.tsx","slices/UIState.tsx","hooks/usePlaybackState.tsx","components/specimen-renderer/default-renderer/DefaultRenderer.tsx","components/specimen-renderer/default-renderer/getDefaults.tsx","components/specimen-renderer/grid-renderer/parseMap.tsx","components/specimen-renderer/grid-renderer/getDefaults.tsx","components/specimen-renderer/grid-renderer/colors.tsx","components/specimen-renderer/grid-renderer/config.tsx","components/specimen-renderer/grid-renderer/makeGraphic.tsx","components/specimen-renderer/grid-renderer/Guides.tsx","components/specimen-renderer/grid-renderer/Node.tsx","components/specimen-renderer/grid-renderer/NodeList.tsx","components/specimen-renderer/grid-renderer/Overlay.tsx","components/specimen-renderer/grid-renderer/Path.tsx","components/specimen-renderer/grid-renderer/Selection.tsx","components/specimen-renderer/grid-renderer/selectionInfo.tsx","components/specimen-renderer/grid-renderer/PixiViewport.tsx","components/specimen-renderer/grid-renderer/Viewport.tsx","components/specimen-renderer/grid-renderer/GridRenderer.tsx","components/specimen-renderer/getRenderer.tsx","slices/loading.tsx","services/SpecimenService.tsx","slices/features.tsx","slices/SliceProvider.tsx","hooks/useSmallDisplay.tsx","components/generic/Select.tsx","components/control-bar/FeaturePicker.tsx","components/control-bar/InputControls.tsx","components/generic/IconButtonWithTooltip.tsx","components/control-bar/PlaybackControls.tsx","components/generic/Switch.tsx","components/generic/ListEditor.tsx","components/breakpoint-editor/comparators.tsx","components/breakpoint-editor/intrinsicProperties.tsx","components/breakpoint-editor/eventTypes.tsx","components/breakpoint-editor/BreakpointEditor.tsx","components/breakpoint-editor/propertyPaths.tsx","components/breakpoint-editor/BreakpointListEditor.tsx","components/script-editor/ScriptEditor.tsx","components/DebugOptionsEditor.tsx","components/generic/ScrollPanel.tsx","components/generic/Modal.tsx","hooks/useScrollState.tsx","components/control-bar/UtilityControls.tsx","components/control-bar/Controls.tsx","components/generic/LazyList.tsx","components/generic/Overline.tsx","components/generic/Property.tsx","components/specimen-inspector/EventInspector.tsx","components/specimen-inspector/EventListInspector.tsx","components/specimen-inspector/SelectionMenu.tsx","components/specimen-inspector/SpecimenInspector.tsx","components/Title.tsx","App.tsx","reportWebVitals.ts","index.tsx","services/ConnectionStateService.tsx","services/PlaybackService.tsx","hooks/useBreakpoints.tsx"],"names":["transpile","script","transform","code","webpackEmptyContext","req","e","Error","keys","resolve","module","exports","id","TIMEOUT","call","method","params","a","es6","UNSTABLE_evaluate","interpret","eval","makeCallExpression","interpreter","Interpreter","appendCode","Promise","res","start","Date","now","step","requestAnimationFrame","value","map","JSON","stringify","join","theme","createTheme","palette","primary","colors","shadows","times","Flex","vertical","props","Box","position","height","width","display","flexDirection","Space","px","SnackbarContext","createContext","noop","useSnackbar","useContext","SnackbarProvider","children","useState","snackPack","setSnackPack","open","setOpen","undefined","current","setCurrent","useEffect","length","prev","slice","handleMessage","useCallback","message","key","getTime","handleClose","_","reason","Provider","Snackbar","autoHideDuration","onClose","TransitionProps","onExited","action","IconButton","color","sx","p","onClick","SnackbarLabel","secondary","opacity","defaultReducer","next","createSlice","initialState","initializer","reducer","Store","useReducer","dispatch","useMemo","then","RPCClient","options","rpc","socket","this","io","url","JSONRPCClient","request","listener","response","off","receive","emit","on","connect","disconnect","name","window","location","hostname","protocol","isLocalHost","getClient","once","fetch","json","servers","client","useInfo","InfoProvider","useSpecimen","SpecimenProvider","makeTypeString","returnType","type","makeComment","chunks","chunk","split","description","c","makeBody","defaultReturnValue","methods","templates","shouldRender","shouldBreak","values","m","useUIState","UIStateProvider","usePlaybackState","specimen","playback","setUIState","ready","playing","end","eventList","tick","startTime","setStartTime","startFrame","setStartFrame","round","useFrameTime","state","canPlay","canPause","canStop","canStepForward","canStepBackward","stepTo","n","clamp","stepBy","callbacks","play","pause","stop","stepForward","stepBackward","DefaultRenderer","justifyContent","alignItems","mb","fontSize","getDefaults","parseMap","wall","h","w","d","last","grid","x","y","filter","flat","row","tile","variables","valid","node","find","range","i","floor","convert","hex","parseInt","replace","colorsHex","source","teal","destination","pink","expanding","deepOrange","tint","generating","yellow","closing","blueGrey","mapValues","getColor","orange","getColorHex","scale","devicePixelRatio","makeGraphic","draw","g","Grid","alpha","clear","lineStyle","forEach","moveTo","WEIGHT","lineTo","Guides","ceil","box","left","top","resolution","r","beginFill","drawRect","endFill","radius","drawCircle","f","Node","Square","NodeList","nodes","variant","memo","keyBy","v","down","LazyNodeList","size","memoize","Overlay","Path","path","s","obj","out","push","pId","isUndefined","isNull","entries","Selected","animateScale","animateAlpha","t","useTween","Selection","hover","highlight","point","between","min","max","events","prop","event","PixiViewport","handler","global","data","input","clickedAvailable","world","toWorld","PixiViewportBase","applyProps","equal","apply","register","resize","Component","PixiComponent","create","viewport","interaction","app","renderer","plugins","ticker","stopPropagation","passiveWheel","drag","pinch","wheel","decelerate","friction","clampZoom","maxScale","minScale","Viewport","useApp","getPoint","renderers","onSelect","selection","ref","setRef","active","setActive","setHover","merge","bgNodes","bgNodeColor","handleClick","info","take","findLastIndex","entry","findIndex","index","selectionInfo","getBoundingClientRect","handleMouseEvent","timeout","clearTimeout","delay","cursor","backgroundColor","onMouseDown","onMouseOver","getGridDefaults","getRenderer","get","useLoading","LoadingProvider","getMap","content","solve","hash","encodeURIComponent","mapURI","algorithms","maps","useFeatures","FeaturesProvider","SliceProvider","slices","services","reduce","createElement","cloneElement","useSmallDisplay","useTheme","useMediaQuery","breakpoints","itemHeight","sm","Select","trigger","items","onChange","placeholder","Tooltip","title","bindTrigger","Menu","bindMenu","anchorOrigin","horizontal","transformOrigin","label","MenuItem","selected","close","SelectField","TextField","minWidth","select","target","item","FeaturePicker","startCase","Button","disabled","mapDefaults","InputControls","algorithm","IconButtonWithTooltip","icon","rest","PlaybackControls","Switch","FormControlLabel","control","defaultChecked","DefaultListEditorInput","forwardRef","InputBase","fullWidth","inputRef","ListEditorField","useSwitch","useDelete","useEdit","useEditButton","onChangeItem","onDeleteItem","enabled","element","extrasPlacement","autoFocus","style","cardStyle","field","setField","marginRight","spacing","marginTop","marginBottom","flexGrow","marginLeft","onDelete","onValueChange","edge","checked","focus","Card","borderColor","paddingRight","transition","transitions","Editor","addItemLabel","text","onAddItem","placeholderText","getCategory","getOrder","isInitialRender","useRef","useInitialRender","intermediateItems","setIntermediateItems","newIndex","setNewIndex","setTimeout","duration","standard","uniqBy","c2","render","Collapse","in","unmountOnExit","appear","mountOnEnter","sorted","sortBy","List","subheader","ListSubheader","disableSticky","Typography","gutterBottom","mt","arr","isNewCategory","some","pl","pb","pt","ml","disableElevation","startIcon","Add","ListEditor","editor","setState","handleChange","k","b","comparators","intrinsicProperties","eventTypes","BreakpointEditor","properties","Divider","flexItem","orientation","mx","textOverflow","whiteSpace","component","property","condition","reference","inputProps","inputMode","pattern","propertyPaths","BreakpointListEditor","uniq","paths","nodeStructure","overflow","debounce","ScriptEditor","loading","CircularProgress","language","defaultValue","minimap","DebugOptionsEditor","monotonicF","monotonicG","tab","setTab","renderHeading","TabContext","TabList","Tab","TabPanel","ScrollPanel","onTarget","onScroll","setTarget","addEventListener","passive","removeEventListener","PanelContext","AppBarTitle","ModalAppBar","elevatedStyle","transitionProperties","elevatedChildren","simple","panel","threshold","showControls","setShowControls","isAbsoluteTop","setIsAbsoluteTop","isTop","setIsTop","lastTop","newIsTop","scrollTop","Math","abs","useScrollState","styles","background","paper","boxShadow","AppBar","elevation","Toolbar","ArrowBack","gridColumn","gridRow","flex","Fade","Modal","actions","scrollable","setContent","contentRef","setContentRef","hasOverflowingChildren","setHasOverflowingChildren","childHeight","setChildHeight","callback","doesOverflow","innerHeight","offsetHeight","ob","ResizeSensor","detach","useVariant","Dialog","fullScreen","paddingTop","PaperProps","borderRadius","shape","default","maxWidth","ManagedModal","ModalProps","ModalAppBarProps","appBar","isOpen","UtilityControls","divider","Controls","LazyList","renderItem","listOptions","totalCount","itemContent","OverlineDot","Overline","my","Property","mr","EventInspector","cardStyles","bgcolor","CardActionArea","flexWrap","EventListInspector","defer","scrollToIndex","align","behavior","offset","SelectionMenu","notify","anchorReference","anchorPosition","ListItem","ListItemText","ListItemIcon","SpecimenInspector","mapType","setSelection","LinearProgress","zIndex","right","Title","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","version","es5","result","isType","match","lower","error","useBreakpoints","renderLabel","cancelled","cancellable","trimEnd","setLoading","setSpecimen","useAsync","signal","defaults","solution","aborted","CssBaseline","ThemeProvider","document","getElementById"],"mappings":"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","file":"static/js/main.5a75f682.chunk.js","sourcesContent":["import { transform } from \"@babel/standalone\";\r\n\r\nexport function transpile(script: string = \"\") {\r\n  try {\r\n    return transform(script, {}).code;\r\n  } catch {\r\n    return \"\";\r\n  }\r\n}\r\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 298;","import { transpile } from \"./transpile\";\r\nimport Interpreter from \"js-interpreter\";\r\nimport { map } from \"lodash\";\r\nimport { templates } from \"./templates\";\r\nimport { FunctionTemplate } from \"./FunctionTemplate\";\r\n\r\nconst TIMEOUT = 1000;\r\n\r\ntype TemplateMap = typeof templates;\r\n\r\ntype Key = keyof TemplateMap;\r\n\r\ntype ReturnTypeOf<T extends Key> = TemplateMap[T] extends FunctionTemplate<\r\n  [...any],\r\n  infer R\r\n>\r\n  ? R\r\n  : never;\r\n\r\ntype ParamsOf<T extends Key> = TemplateMap[T] extends FunctionTemplate<\r\n  infer R,\r\n  any\r\n>\r\n  ? R\r\n  : [];\r\n\r\nexport async function call<T extends Key>(\r\n  script: string,\r\n  method: T,\r\n  params: ParamsOf<T>,\r\n  es6: boolean = true,\r\n  fast: boolean = false\r\n): Promise<ReturnTypeOf<T> | undefined> {\r\n  return fast\r\n    ? UNSTABLE_evaluate(script, method, params)\r\n    : await interpret(script, method, params, es6);\r\n}\r\n\r\nexport function UNSTABLE_evaluate<T extends Key>(\r\n  script: string,\r\n  method: T,\r\n  params: ParamsOf<T>\r\n) {\r\n  /* eslint-disable no-eval */\r\n  return eval(`${script}\\n${makeCallExpression(method, params)}`);\r\n}\r\n\r\nexport async function interpret<T extends Key>(\r\n  script: string,\r\n  method: T,\r\n  params: ParamsOf<T>,\r\n  es6: boolean = true\r\n): Promise<ReturnTypeOf<T> | undefined> {\r\n  const code = es6 ? transpile(script) : script;\r\n  if (code) {\r\n    const interpreter = new Interpreter(code);\r\n    interpreter.appendCode(makeCallExpression(method, params));\r\n    return new Promise((res) => {\r\n      const start = Date.now();\r\n      const step = () => {\r\n        const active = Date.now() - start <= TIMEOUT;\r\n        if (active && interpreter.step()) {\r\n          requestAnimationFrame(step);\r\n        } else {\r\n          res(interpreter.value);\r\n        }\r\n      };\r\n      step();\r\n    });\r\n  }\r\n}\r\n\r\nfunction makeCallExpression<T extends Key>(method: T, params: ParamsOf<T>) {\r\n  return `${method}(${map(params, JSON.stringify).join(\", \")});`;\r\n}\r\n","import { colors, createTheme } from \"@material-ui/core\";\r\nimport { times } from \"lodash\";\r\n\r\nconst shadow = `\r\n    0px 8px 18px -1px rgb(0 0 0 / 8%), \r\n    0px 10px 48px 0px rgb(0 0 0 / 1%), \r\n    0px 20px 96px 0px rgb(0 0 0 / 0.5%)\r\n`;\r\n\r\nexport const theme = createTheme({\r\n  palette: {\r\n    primary: colors[\"blueGrey\"],\r\n  },\r\n  shadows: [\"\", ...times(24, () => shadow)] as any,\r\n});\r\n","import { Box, BoxProps } from \"@material-ui/core\";\r\n\r\nexport type FlexProps = {\r\n  vertical?: boolean;\r\n} & BoxProps;\r\n\r\nexport function Flex({ vertical, ...props }: FlexProps) {\r\n  return (\r\n    <Box\r\n      position=\"relative\"\r\n      height=\"100%\"\r\n      width=\"100%\"\r\n      display=\"flex\"\r\n      flexDirection={vertical ? \"column\" : \"row\"}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n","import { Box } from \"@material-ui/core\";\r\nimport { BoxProps } from \"@material-ui/system\";\r\n\r\nexport function Space(props: BoxProps) {\r\n  return <Box px={0.5} display=\"inline-block\" {...props} />;\r\n}\r\n","import { Box, IconButton, Snackbar } from \"@material-ui/core\";\r\nimport { CloseOutlined as CloseIcon } from \"@material-ui/icons\";\r\nimport { noop } from \"lodash\";\r\nimport {\r\n  createContext,\r\n  ReactNode,\r\n  useCallback,\r\n  useContext,\r\n  useEffect,\r\n  useState,\r\n} from \"react\";\r\nimport { Flex } from \"./Flex\";\r\nimport { Space } from \"./Space\";\r\n\r\nconst SnackbarContext = createContext<(message?: ReactNode) => void>(noop);\r\n\r\nexport interface SnackbarMessage {\r\n  message?: ReactNode;\r\n  key: number;\r\n}\r\n\r\nexport interface State {\r\n  open: boolean;\r\n  snackPack: readonly SnackbarMessage[];\r\n  messageInfo?: SnackbarMessage;\r\n}\r\n\r\nexport function useSnackbar() {\r\n  return useContext(SnackbarContext);\r\n}\r\n\r\nexport function SnackbarProvider({ children }: { children?: ReactNode }) {\r\n  const [snackPack, setSnackPack] = useState<readonly SnackbarMessage[]>([]);\r\n  const [open, setOpen] = useState(false);\r\n  const [current, setCurrent] = useState<SnackbarMessage | undefined>(\r\n    undefined\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (snackPack.length && !current) {\r\n      setCurrent({ ...snackPack[0] });\r\n      setSnackPack((prev) => prev.slice(1));\r\n      setOpen(true);\r\n    } else if (snackPack.length && current && open) {\r\n      setOpen(false);\r\n    }\r\n  }, [snackPack, current, open]);\r\n\r\n  const handleMessage = useCallback(\r\n    (message: ReactNode) => {\r\n      setSnackPack((prev) => [...prev, { message, key: new Date().getTime() }]);\r\n    },\r\n    [setSnackPack]\r\n  );\r\n\r\n  const handleClose = (_: any, reason?: string) => {\r\n    reason !== \"clickaway\" && setOpen(false);\r\n  };\r\n\r\n  const handleExited = () => setCurrent(undefined);\r\n\r\n  return (\r\n    <>\r\n      <SnackbarContext.Provider value={handleMessage}>\r\n        {children}\r\n      </SnackbarContext.Provider>\r\n      <Snackbar\r\n        key={current?.key}\r\n        open={open}\r\n        autoHideDuration={6000}\r\n        onClose={handleClose}\r\n        TransitionProps={{ onExited: handleExited }}\r\n        message={current?.message}\r\n        action={\r\n          <>\r\n            <IconButton\r\n              aria-label=\"close\"\r\n              color=\"inherit\"\r\n              sx={{ p: 0.5 }}\r\n              onClick={handleClose}\r\n            >\r\n              <CloseIcon />\r\n            </IconButton>\r\n          </>\r\n        }\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\ntype SnackbarLabelProps = {\r\n  primary?: ReactNode;\r\n  secondary?: ReactNode;\r\n};\r\n\r\nexport function SnackbarLabel({ primary, secondary }: SnackbarLabelProps) {\r\n  return (\r\n    <Flex>\r\n      <Box>{primary}</Box>\r\n      <Space />\r\n      <Box sx={{ opacity: 0.56 }}>{secondary}</Box>\r\n    </Flex>\r\n  );\r\n}\r\n","import { noop } from \"lodash\";\r\nimport {\r\n  createContext,\r\n  ReactNode,\r\n  useContext,\r\n  useEffect,\r\n  useMemo,\r\n  useReducer,\r\n} from \"react\";\r\n\r\ntype Slice<T, U = T> = [T, (next: U) => void];\r\n\r\ntype Reducer<T, U> = (prev: T, next: U) => T;\r\n\r\nconst defaultReducer = (_: any, next: any) => next;\r\n\r\nexport function createSlice<T, U = T>(\r\n  initialState: T,\r\n  initializer?: () => Promise<U>,\r\n  reducer: Reducer<T, U> = defaultReducer\r\n) {\r\n  const Store = createContext<Slice<T, U>>([initialState, noop]);\r\n  return [\r\n    // Hook\r\n    () => useContext(Store),\r\n    // Context\r\n    ({ children }: { children?: ReactNode }) => {\r\n      const [value, dispatch] = useReducer(reducer, initialState);\r\n      const slice = useMemo<Slice<T, U>>(\r\n        () => [value, dispatch],\r\n        [value, dispatch]\r\n      );\r\n      useEffect(() => void initializer?.().then?.(dispatch), [dispatch]);\r\n      return <Store.Provider value={slice}>{children}</Store.Provider>;\r\n    },\r\n  ] as const;\r\n}\r\n","import { JSONRPCClient, JSONRPCResponse as Response } from \"json-rpc-2.0\";\r\nimport { NameMethodMap } from \"protocol\";\r\nimport { Request, RequestOf, ResponseOf } from \"protocol/Message\";\r\nimport { io, Socket } from \"socket.io-client\";\r\n\r\nexport interface RPCClientOptions {\r\n  url: string;\r\n}\r\n\r\nexport class RPCClient {\r\n  rpc: JSONRPCClient;\r\n  socket: Socket;\r\n\r\n  constructor(readonly options: RPCClientOptions) {\r\n    this.socket = io(options.url);\r\n    this.rpc = new JSONRPCClient(async (request: Request) => {\r\n      const listener = (response: Response) => {\r\n        if (response.id === request.id) {\r\n          this.socket.off(\"response\", listener);\r\n          this.rpc.receive(response);\r\n        }\r\n      };\r\n      this.socket.emit(\"request\", request);\r\n      this.socket.on(\"response\", listener);\r\n    });\r\n  }\r\n\r\n  async connect() {\r\n    this.socket.connect();\r\n  }\r\n\r\n  async disconnect() {\r\n    this.socket.disconnect();\r\n  }\r\n\r\n  async call<T extends keyof NameMethodMap>(\r\n    name: T,\r\n    params?: RequestOf<NameMethodMap[T]>[\"params\"]\r\n  ): Promise<ResponseOf<NameMethodMap[T]>[\"result\"]> {\r\n    return await this.rpc.request(name, params);\r\n  }\r\n}\r\n","import { once } from \"lodash\";\r\nimport { RPCClient } from \"./RPCClient\";\r\n\r\nconst DEV_PORT = 8001;\r\n\r\nconst { hostname, protocol } = window.location;\r\nconst isLocalHost = hostname === \"localhost\";\r\n\r\nconst registry =\r\n  \"https://raw.githubusercontent.com/Pathfinding-Project/registry/master/index.json\";\r\n\r\ntype Registry = string[];\r\n\r\nexport const getClient = once(async () => {\r\n  if (isLocalHost) {\r\n    return new RPCClient({\r\n      url: `${protocol}//${hostname}:${DEV_PORT}/`,\r\n    });\r\n  } else {\r\n    const response = await fetch(registry);\r\n    const servers = (await response.json()) as Registry;\r\n    return new RPCClient({\r\n      url: servers[0],\r\n    });\r\n  }\r\n});\r\n","import { createSlice } from \"./createSlice\";\r\nimport { CheckConnectionResponse } from \"protocol/CheckConnection\";\r\nimport { getClient } from \"client/getClient\";\r\n\r\ntype Info = CheckConnectionResponse[\"result\"];\r\n\r\nexport const [useInfo, InfoProvider] = createSlice<Info | undefined>(\r\n  undefined,\r\n  async () => {\r\n    const client = await getClient();\r\n    return await client.call(\"about\");\r\n  }\r\n);\r\n","import { createSlice } from \"./createSlice\";\r\nimport { Trace } from \"protocol/Trace\";\r\nimport { PathfindingTask } from \"protocol/SolveTask\";\r\nimport { ParamsOf } from \"protocol/Message\";\r\n\r\ntype Specimen = {\r\n  specimen?: Trace;\r\n  map?: string;\r\n} & Partial<ParamsOf<PathfindingTask>>;\r\n\r\nexport const [useSpecimen, SpecimenProvider] = createSlice<Specimen>({});\r\n","import { chunk, join, map, split } from \"lodash\";\r\nimport { FunctionTemplate } from \"./FunctionTemplate\";\r\n\r\ntype GenericFunctionTemplate = FunctionTemplate<[...any], any>;\r\n\r\nfunction makeTypeString({ returnType, params }: GenericFunctionTemplate) {\r\n  return `@type {(${join(\r\n    map(params, (p) => `${p.name}: ${p.type}`),\r\n    \", \"\r\n  )}) => ${returnType}}`;\r\n}\r\n\r\nfunction makeComment(method: GenericFunctionTemplate) {\r\n  const [open, prefix, close] = [\"/**\", \" * \", \" */\"];\r\n  const chunks = map(chunk(split(method.description, \" \"), 9), (c) =>\r\n    join(c, \" \")\r\n  );\r\n  return join(\r\n    [\r\n      open,\r\n      ...map(chunks, (c) => `${prefix}${c}`),\r\n      `${prefix}${makeTypeString(method)}`,\r\n      close,\r\n    ],\r\n    \"\\n\"\r\n  );\r\n}\r\n\r\nfunction makeBody({\r\n  name,\r\n  params,\r\n  defaultReturnValue,\r\n}: GenericFunctionTemplate) {\r\n  return join(\r\n    [\r\n      `function ${name}(${join(map(params, \"name\"), \", \")}) {`,\r\n      `    return ${JSON.stringify(defaultReturnValue)};`,\r\n      `}`,\r\n    ],\r\n    \"\\n\"\r\n  );\r\n}\r\n\r\nexport function makeTemplate(methods?: GenericFunctionTemplate[]) {\r\n  return join(\r\n    map(methods, (m) => join([makeComment(m), makeBody(m)], \"\\n\")),\r\n    \"\\n\\n\"\r\n  );\r\n}\r\n","import { TraceEvent } from \"protocol/Trace\";\r\nimport { FunctionTemplate } from \"./FunctionTemplate\";\r\n\r\nexport type ShouldBreak = FunctionTemplate<[number, TraceEvent], boolean>;\r\n\r\nexport const shouldBreak: ShouldBreak = {\r\n  name: \"shouldBreak\",\r\n  description:\r\n    \"Define in what situations the debugger should break, in addition to the conditions defined in the standard options.\",\r\n  params: [\r\n    { name: \"step\", type: \"number\" },\r\n    { name: \"event\", type: \"any\" },\r\n  ],\r\n  defaultReturnValue: false,\r\n  returnType: \"boolean\",\r\n};\r\n\r\nexport type ShouldRender = FunctionTemplate<[number], boolean>;\r\n\r\nexport const shouldRender: ShouldRender = {\r\n  name: \"shouldRender\",\r\n  description:\r\n    \"Define which objects the renderer should display, in addition to the conditions defined in the standard options.\",\r\n  params: [{ name: \"step\", type: \"number\" }],\r\n  defaultReturnValue: true,\r\n  returnType: \"boolean\",\r\n};\r\n\r\nexport const templates = {\r\n  shouldRender,\r\n  shouldBreak,\r\n};\r\n","import { makeTemplate } from \"components/script-editor/makeTemplate\";\r\nimport { templates } from \"components/script-editor/templates\";\r\nimport { values } from \"lodash\";\r\nimport { Feature } from \"protocol/FeatureQuery\";\r\nimport { TraceEventType } from \"protocol/Trace\";\r\nimport { createSlice } from \"./createSlice\";\r\n\r\nexport type PlaybackStateType = \"playing\" | \"paused\" | undefined;\r\n\r\ntype PlaybackState = { playback?: PlaybackStateType; step?: number };\r\n\r\ntype InputState = {\r\n  algorithm?: string;\r\n  map?: Partial<Feature & { type: string }>;\r\n};\r\n\r\nexport type Comparator = {\r\n  key: string;\r\n  apply: (value: number, reference: number) => boolean;\r\n};\r\n\r\nexport type Breakpoint = {\r\n  key: string;\r\n  property?: string;\r\n  reference?: number;\r\n  condition?: Comparator;\r\n  active?: boolean;\r\n  type?: TraceEventType;\r\n};\r\n\r\ntype DebugOptionsState = {\r\n  code?: string;\r\n  monotonicF?: boolean;\r\n  monotonicG?: boolean;\r\n  breakpoints?: Breakpoint[];\r\n};\r\n\r\ntype SpecimenState = {\r\n  start?: number;\r\n  end?: number;\r\n};\r\n\r\nexport type UIState = InputState &\r\n  PlaybackState &\r\n  DebugOptionsState &\r\n  SpecimenState;\r\n\r\nexport const [useUIState, UIStateProvider] = createSlice<\r\n  UIState,\r\n  Partial<UIState>\r\n>(\r\n  {\r\n    code: makeTemplate(values(templates)),\r\n  },\r\n  undefined,\r\n  (prev, next) => ({ ...prev, ...next })\r\n);\r\n","import { clamp, round } from \"lodash\";\r\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\n\r\nconst TARGET_FRAME_TIME = 1000 / 120;\r\n\r\nfunction useFrameTime(playing: boolean, step: number) {\r\n  const [startTime, setStartTime] = useState(0);\r\n  const [startFrame, setStartFrame] = useState(0);\r\n\r\n  useEffect(() => {\r\n    if (playing) {\r\n      const now = Date.now();\r\n      if (!startTime) {\r\n        setStartTime(now);\r\n        setStartFrame(step);\r\n      }\r\n    } else setStartTime(0);\r\n  }, [setStartTime, startTime, setStartFrame, startFrame, playing, step]);\r\n\r\n  return useCallback(\r\n    () =>\r\n      playing\r\n        ? round((Date.now() - startTime) / TARGET_FRAME_TIME + startFrame)\r\n        : 0,\r\n    [startTime, startFrame, playing]\r\n  );\r\n}\r\n\r\nexport function usePlaybackState() {\r\n  const [{ specimen }] = useSpecimen();\r\n  const [{ playback, step = 0 }, setUIState] = useUIState();\r\n\r\n  const ready = !!specimen;\r\n  const playing = playback === \"playing\";\r\n  const [start, end] = [0, (specimen?.eventList?.length ?? 1) - 1];\r\n\r\n  const tick = useFrameTime(playing, step);\r\n\r\n  return useMemo(() => {\r\n    const state = {\r\n      start,\r\n      end,\r\n      step,\r\n      canPlay: ready && !playing && step < end,\r\n      canPause: ready && playing,\r\n      canStop: ready,\r\n      canStepForward: ready && !playing && step < end,\r\n      canStepBackward: ready && !playing && step > 0,\r\n    };\r\n\r\n    const stepTo = (n: number) => clamp(n, start, end);\r\n    const stepBy = (n: number) => stepTo(step + n);\r\n\r\n    const callbacks = {\r\n      play: () => setUIState({ playback: \"playing\", step: stepBy(1) }),\r\n      pause: () => setUIState({ playback: \"paused\" }),\r\n      stop: () => setUIState({ step: start, playback: \"paused\" }),\r\n      stepForward: () => setUIState({ step: stepBy(1) }),\r\n      stepBackward: () => setUIState({ step: stepBy(-1) }),\r\n      tick: () => {\r\n        setUIState({ playback: \"playing\", step: stepTo(tick()) });\r\n      },\r\n    };\r\n\r\n    return {\r\n      playing: playback === \"playing\",\r\n      ...state,\r\n      ...callbacks,\r\n    };\r\n  }, [end, playback, playing, ready, tick, setUIState, start, step]);\r\n}\r\n","import { BlurOffOutlined as DisabledIcon } from \"@material-ui/icons\";\nimport { Flex } from \"components/generic/Flex\";\nimport { RendererProps } from \"components/specimen-renderer/Renderer\";\n\nexport function DefaultRenderer({ width, height }: RendererProps) {\n  return (\n    <Flex\n      {...{ width, height }}\n      justifyContent=\"center\"\n      alignItems=\"center\"\n      color=\"text.secondary\"\n      vertical\n    >\n      <DisabledIcon sx={{ mb: 2 }} fontSize=\"large\" />\n      No renderer is installed for the current map style.\n    </Flex>\n  );\n}\n","export const getDefaults = () => ({\n  start: 0,\n  end: 0,\n});\n","import { Point } from \"components/specimen-renderer/Renderer\";\nimport { filter, flatMap as flat, last, map, split } from \"lodash\";\nimport { TraceEvent } from \"protocol/Trace\";\n\nexport function parseMap(m: string = \"\", wall: string = \"@\") {\n  const [, h, w] = split(m, \"\\n\");\n  const [width, height] = map([w, h], (d) => +last(split(d, \" \"))!);\n  const grid = split(m, \"\\n\").slice(4);\n  return [\n    { x: width, y: height },\n    filter(\n      flat(grid, (row, y) =>\n        map(row, (tile, x) =>\n          tile === wall ? { variables: { x, y } } : undefined\n        )\n      )\n    ) as TraceEvent[],\n    ({ x, y }: Point) => grid[y]?.[x] !== wall,\n  ] as const;\n}\n","import { find, floor, range } from \"lodash\";\nimport { parseMap } from \"./parseMap\";\n\nexport function getDefaults(m: string = \"\", wall: string = \"@\") {\n  const [{ x: w, y: h }, , valid] = parseMap(m, wall);\n  const node =\n    find(range(w * h), (i) => valid({ x: i % w, y: floor(i / w) })) ?? 0;\n  return {\n    start: node,\n    end: node,\n  };\n}\n","import {\n  blueGrey,\n  deepOrange,\n  orange,\n  pink,\n  teal,\n  yellow,\n} from \"@material-ui/core/colors\";\nimport { mapValues } from \"lodash\";\nimport { TraceEventType } from \"protocol/Trace\";\n\nconst tint = \"500\";\n\nexport function convert(hex: string) {\n  return parseInt(hex.replace(\"#\", \"0x\"));\n}\n\nexport const colorsHex = {\n  source: teal[\"A400\"],\n  destination: pink[\"A400\"],\n  expanding: deepOrange[tint],\n  generating: yellow[tint],\n  closing: blueGrey[\"200\"],\n};\n\nexport const colors: { [K in TraceEventType]: number } = mapValues(\n  colorsHex,\n  convert\n);\n\nexport function getColor(key?: TraceEventType) {\n  return (key && colors[key]) || convert(orange[tint]);\n}\n\nexport function getColorHex(key?: TraceEventType) {\n  return (key && colorsHex[key]) ?? orange[tint];\n}\n","export const scale = 10 * devicePixelRatio;\nexport const size = 1200;\n","import { Graphics } from \"@inlet/react-pixi\";\nimport { ComponentProps } from \"react\";\nimport { Graphics as PIXIGraphics } from \"@pixi/graphics\";\n\nexport function makeGraphic<T = any>(\n  draw: (g: PIXIGraphics, props: ComponentProps<typeof Graphics> & T) => void\n) {\n  return (props: ComponentProps<typeof Graphics> & T) => {\n    return <Graphics {...props} draw={(g) => draw(g, props)} />;\n  };\n}\n","import { ceil, forEach, range } from \"lodash\";\nimport { makeGraphic } from \"./makeGraphic\";\nimport { scale } from \"./config\";\nimport { ComponentProps } from \"react\";\n\nconst WEIGHT = 1;\n\nconst Grid = makeGraphic<{ alpha?: number; grid?: number }>(\n  (g, { width = 0, height = 0, alpha = 1, grid = 5 }) => {\n    g.clear();\n    g.lineStyle(WEIGHT, 0x000000, alpha);\n    forEach(range(scale * grid, height, scale * grid), (i) =>\n      g.moveTo(0, i + WEIGHT / 2).lineTo(width, i + WEIGHT / 2)\n    );\n    forEach(range(scale * grid, width, scale * grid), (i) =>\n      g.moveTo(i + WEIGHT / 2, 0).lineTo(i + WEIGHT / 2, height)\n    );\n  }\n);\n\ntype Props = ComponentProps<typeof Grid>;\n\nexport function Guides({\n  width = 0,\n  height = 0,\n  x = 0,\n  y = 0,\n  grid = 5,\n  ...params\n}: Props) {\n  return (\n    <Grid\n      width={ceil(width / grid) * grid * scale}\n      height={ceil(height / grid) * grid * scale}\n      grid={grid}\n      {...params}\n    />\n  );\n}\n","import { makeGraphic } from \"./makeGraphic\";\nimport { scale } from \"./config\";\nimport { Graphics } from \"@pixi/graphics\";\nimport { map } from \"lodash\";\n\nexport type NodeProps = {\n  color?: number;\n  left?: number;\n  top?: number;\n  radius?: number;\n  resolution?: number;\n};\n\nexport const node = (\n  g: Graphics,\n  { color, left = 0, top = 0, radius = 0.25, resolution: r = 1 }: NodeProps\n) =>\n  g\n    .beginFill(color ?? 0x000000)\n    .drawCircle(\n      r * (1.5 * scale + left),\n      r * (1.5 * scale + top),\n      r * radius * scale\n    )\n    .endFill();\n\nexport const square = (\n  g: Graphics,\n  { color, left = 0, top = 0, radius = 0.5, resolution: r = 1 }: NodeProps\n) =>\n  g\n    .beginFill(color ?? 0x000000)\n    .drawRect(\n      r * (scale + (radius * scale) / 2 + left),\n      r * (scale + (radius * scale) / 2 + top),\n      r * (radius * scale),\n      r * (radius * scale)\n    )\n    .endFill();\n\nexport const box = (\n  g: Graphics,\n  { color, left = 0, top = 0, resolution: r = 1 }: NodeProps\n) =>\n  g\n    .beginFill(color ?? 0x000000)\n    .drawRect(\n      r * (scale + left),\n      r * (scale + top),\n      r * (1 * scale),\n      r * (1 * scale)\n    )\n    .endFill();\n\nexport const [Node, Box, Square] = map([node, box, square], (f) =>\n  makeGraphic<NodeProps>((g, p) => {\n    g.clear();\n    f(g, p);\n  })\n);\n","import { Graphics } from \"@inlet/react-pixi\";\nimport { floor, keyBy, memoize, slice, values } from \"lodash\";\nimport * as PIXI from \"pixi.js\";\nimport { Trace, TraceEventType } from \"protocol/Trace\";\nimport { useCallback, useMemo } from \"react\";\nimport { scale } from \"./config\";\nimport { box, NodeProps } from \"./Node\";\n\ntype Props = {\n  nodes: Trace[\"eventList\"];\n  color?: (type?: TraceEventType) => number;\n  variant?: (g: PIXI.Graphics, options: NodeProps) => PIXI.Graphics;\n  resolution?: number;\n};\n\nexport function NodeList({\n  nodes,\n  color,\n  variant = box,\n  resolution = 0.15,\n}: Props) {\n  const memo = useMemo(\n    () =>\n      values(keyBy(nodes, ({ variables: v }) => `${v?.x ?? 0}::${v?.y ?? 0}`)),\n    [nodes]\n  );\n  const draw = useCallback(\n    (g: PIXI.Graphics) => {\n      g.clear();\n      for (const { variables: v, type } of memo) {\n        variant(g, {\n          color: color?.(type) ?? 0xf6f6f6,\n          left: (v?.x ?? 0) * scale,\n          top: (v?.y ?? 0) * scale,\n          radius: 0.25,\n          resolution,\n        });\n      }\n      return g;\n    },\n    [memo, color, resolution, variant]\n  );\n  return <Graphics draw={draw} scale={1 / resolution} />;\n}\n\nfunction down(n: number, a: number = 1) {\n  return floor(n / a) * a;\n}\n\nexport function LazyNodeList({\n  nodes,\n  step = 0,\n  size = 5000,\n  ...props\n}: {\n  step?: number;\n  size?: number;\n} & Props) {\n  const chunk = useCallback(\n    memoize((n: number) => slice(nodes, 0, n)),\n    [nodes]\n  );\n  return (\n    <>\n      <NodeList nodes={chunk(down(step, size))} {...props} />\n      <NodeList nodes={slice(nodes, down(step, size), step + 1)} {...props} />\n    </>\n  );\n}\n","import { Point } from \"components/specimen-renderer/Renderer\";\nimport { floor, map } from \"lodash\";\nimport { getColor } from \"./colors\";\nimport { scale } from \"./config\";\nimport { Square } from \"./Node\";\n\ntype OverlayProps = {\n  start?: number;\n  end?: number;\n  size?: Point;\n};\nexport function Overlay({\n  start = 0,\n  end = 0,\n  size = { x: 0, y: 0 },\n}: OverlayProps) {\n  return (\n    <>\n      {map(\n        [\n          { color: getColor(\"destination\"), node: end },\n          { color: getColor(\"source\"), node: start },\n        ],\n        ({ color, node }, i) => (\n          <Square\n            key={i}\n            x={scale * (node % size.x)}\n            y={scale * floor(node / size.x)}\n            color={color}\n          />\n        )\n      )}\n    </>\n  );\n}\n","import { Graphics } from \"@inlet/react-pixi\";\nimport { Graphics as PixiGraphics } from \"@pixi/graphics\";\nimport { isNull, isUndefined, keyBy } from \"lodash\";\nimport { TraceEvent } from \"protocol/Trace\";\nimport { useMemo } from \"react\";\nimport { getColor } from \"./colors\";\nimport { scale } from \"./config\";\nimport { Square } from \"./Node\";\n\nfunction defined<T>(obj: T): obj is Exclude<T, undefined | null> {\n  return !isUndefined(obj) && !isNull(obj);\n}\n\ntype PathProps = {\n  nodes?: TraceEvent[];\n  step?: number;\n};\n\nexport function Path({ nodes = [], step = 0 }: PathProps) {\n  const path = useMemo(() => {\n    const memo = keyBy(nodes, \"id\");\n    return (s: number) => {\n      const out = [];\n      let next: TraceEvent | undefined = nodes[s];\n      while (next) {\n        out.push(next);\n        next = defined(next.pId) ? memo[`${next.pId}`] : undefined;\n      }\n      return out;\n    };\n  }, [nodes]);\n\n  const draw = useMemo(() => {\n    const p = path(step);\n    return (g: PixiGraphics) => {\n      g.clear();\n      for (const [i, node] of p.entries()) {\n        const { x = 0, y = 0 } = node?.variables ?? {};\n        g.lineTo((x + 1.5) * scale, (y + 1.5) * scale);\n        if (!i) g.lineStyle(3, getColor(\"source\"));\n      }\n    };\n  }, [path, step]);\n\n  return (\n    <>\n      <Graphics draw={draw} />\n      <Square\n        x={scale * (nodes?.[step]?.variables?.x ?? 0)}\n        y={scale * (nodes?.[step]?.variables?.y ?? 0)}\n        color={getColor(\"source\")}\n      />\n    </>\n  );\n}\n","import { map } from \"lodash\";\nimport { Point } from \"components/specimen-renderer/Renderer\";\nimport { scale } from \"./config\";\nimport { useTween } from \"react-use\";\nimport { ComponentProps as PropsOf } from \"react\";\nimport { Node } from \"./Node\";\n\ntype SelectedProps = {\n  animateScale?: boolean;\n  animateAlpha?: boolean;\n} & PropsOf<typeof Node>;\n\ntype Props = {\n  hover?: Point;\n  highlight?: Point;\n};\n\nexport function Selected({\n  x = 0,\n  y = 0,\n  animateScale,\n  animateAlpha,\n  ...props\n}: SelectedProps) {\n  const t = useTween(\"outCirc\", 300);\n  return (\n    <Node\n      {...props}\n      scale={animateScale ? t : 1}\n      x={x + (animateScale ? 1.5 * scale - 1.5 * scale * t : 0)}\n      y={y + (animateScale ? 1.5 * scale - 1.5 * scale * t : 0)}\n      radius={1}\n      alpha={animateAlpha ? t : 1}\n    />\n  );\n}\n\nexport function Selection({ hover, highlight }: Props) {\n  return (\n    <>\n      {map(\n        [\n          { point: hover, color: 0xf9f9f9, animateAlpha: true },\n          { point: highlight, color: 0xf1f1f1, animateScale: true },\n        ],\n        ({ point, ...props }, i) =>\n          point && (\n            <Selected\n              key={`${i}::${point.x}::${point.y}`}\n              x={point.x * scale}\n              y={point.y * scale}\n              {...props}\n            />\n          )\n      )}\n    </>\n  );\n}\n","import { Point, SelectionInfo } from \"components/specimen-renderer/Renderer\";\nimport { findIndex, findLastIndex, take } from \"lodash\";\nimport { Trace } from \"protocol/Trace\";\nimport { parseMap } from \"./parseMap\";\n\nfunction between(v: number, min: number, max: number) {\n  return v >= min && v < max;\n}\n\nexport function selectionInfo(map: string = \"\", specimen: Trace = {}) {\n  const [{ x: w, y: h }, , valid] = parseMap(map);\n  return ({ x, y }: Point, step: number = 0) => {\n    const nodes = take(specimen?.eventList, step);\n    const node = findLastIndex(\n      nodes,\n      ({ variables: v }) => (v?.x ?? 0) === x && (v?.y ?? 0) === y\n    );\n    const entry = findIndex(\n      specimen?.eventList,\n      ({ variables: v, type }) =>\n        type === \"expanding\" && (v?.x ?? 0) === x && (v?.y ?? 0) === y\n    );\n    return {\n      current: node !== -1 ? { index: node, event: nodes[node] } : undefined,\n      entry: entry !== -1 ? { index: entry, event: nodes[entry] } : undefined,\n      node:\n        between(x, 0, w) && between(y, 0, h) && valid({ x, y })\n          ? { key: y * w + x }\n          : undefined,\n    } as SelectionInfo;\n  };\n}\n","import { find } from \"lodash\";\nimport { Viewport as PixiViewportBase } from \"pixi-viewport\";\nimport * as PIXI from \"pixi.js\";\n\nexport type ViewportEvent = {\n  global: PIXI.Point;\n  world: PIXI.Point;\n  event: PointerEvent;\n};\n\nexport type ViewportEventHandler = (e: ViewportEvent) => void;\n\nexport type PointerEvent = \"onMouseOver\" | \"onClick\" | \"onMouseDown\";\n\nexport type PropEventPair = {\n  prop: PointerEvent;\n  event: string;\n  filter?: boolean;\n};\n\nexport const events = [\n  { prop: \"onMouseOver\", event: \"mousemove\" },\n  { prop: \"onClick\", event: \"click\", filter: true },\n  { prop: \"onClick\", event: \"tap\", filter: true },\n  { prop: \"onMouseDown\", event: \"pointerdown\", filter: true },\n] as PropEventPair[];\n\nexport class PixiViewport extends PixiViewportBase {\n  events: {\n    [K in string]?: () => void;\n  } = {};\n  register(prop: PointerEvent, handler?: ViewportEventHandler) {\n    const { event, filter } = find(events, (c) => c.prop === prop)!;\n    this.events?.[event]?.();\n    if (handler) {\n      const f = (e: PIXI.InteractionEvent) => {\n        const { global } = e.data;\n        if (!filter || this.input.clickedAvailable) {\n          handler?.({\n            global,\n            world: this.toWorld(global),\n            event: prop,\n          });\n        }\n      };\n      this.on(event, f);\n      this.events[event] = () => this.off(event, f);\n    }\n  }\n}\n","/**\n * Adapted from https://codesandbox.io/s/react-pixi-viewport-9ngfd\n * @author roxgarage\n */\n\nimport { PixiComponent, useApp } from \"@inlet/react-pixi\";\nimport { map } from \"lodash\";\nimport * as PIXI from \"pixi.js\";\nimport React from \"react\";\nimport {\n  PointerEvent,\n  PixiViewport,\n  events,\n  ViewportEventHandler,\n} from \"./PixiViewport\";\n\nexport type ViewportProps = {\n  width?: number;\n  height?: number;\n  children?: React.ReactNode;\n  event?: PIXI.InteractionEvent;\n} & { [K in PointerEvent]?: ViewportEventHandler };\n\nexport type Props = {\n  app: PIXI.Application;\n} & ViewportProps;\n\nfunction create(props: Props) {\n  const viewport = new PixiViewport({\n    interaction: props.app.renderer.plugins.interaction,\n    ticker: props.app.ticker,\n    stopPropagation: true,\n    passiveWheel: false,\n  })\n    .drag()\n    .pinch()\n    .wheel()\n    .decelerate({ friction: 0.98 })\n    .clampZoom({ maxScale: 10, minScale: 0.1 });\n  return viewport as PixiViewport;\n}\n\nfunction applyProps(\n  v: PixiViewport,\n  prev: Props,\n  { width, height, ...next }: Props\n) {\n  for (const { equal, apply } of [\n    ...map(events, ({ prop }) => ({\n      equal: prev[prop] === next[prop],\n      apply: () => v.register(prop, next[prop]),\n    })),\n    {\n      prop: prev.width === width && prev.height === height,\n      apply: () => v.resize(width, height, (width ?? 0) * 2, (height ?? 0) * 2),\n    },\n  ]) {\n    !equal && apply();\n  }\n}\n\nconst Component = PixiComponent<Props, PixiViewport>(\"Viewport\", {\n  create: (props) => {\n    const viewport = create(props);\n    applyProps(viewport, props, props);\n    return viewport;\n  },\n  applyProps,\n});\n\nexport const Viewport = (props: ViewportProps) => {\n  const app = useApp();\n  return <Component app={app} {...props} />;\n};\n","import { Stage } from \"@inlet/react-pixi\";\nimport { Box } from \"@material-ui/core\";\nimport { blueGrey } from \"@material-ui/core/colors\";\nimport { Point, RendererProps } from \"components/specimen-renderer/Renderer\";\nimport { delay, floor, merge, once } from \"lodash\";\nimport { ComponentProps, useMemo, useState } from \"react\";\nimport { useSpecimen } from \"slices/specimen\";\nimport { useUIState } from \"slices/UIState\";\nimport { convert, getColor } from \"./colors\";\nimport { scale } from \"./config\";\nimport { getDefaults } from \"./getDefaults\";\nimport { Guides } from \"./Guides\";\nimport { LazyNodeList as LazyNodes, NodeList as Nodes } from \"./NodeList\";\nimport { Overlay } from \"./Overlay\";\nimport { parseMap } from \"./parseMap\";\nimport { Path } from \"./Path\";\nimport { ViewportEvent } from \"./PixiViewport\";\nimport { Selection } from \"./Selection\";\nimport { selectionInfo } from \"./selectionInfo\";\nimport { Viewport } from \"./Viewport\";\n\ntype GridRendererProps = RendererProps &\n  Omit<ComponentProps<typeof Stage>, \"onSelect\">;\n\nfunction getPoint({ x, y }: Point) {\n  return { x: floor(x / scale) - 1, y: floor(y / scale) - 1 };\n}\n\nexport function GridRenderer({\n  onSelect,\n  selection,\n  ...props\n}: GridRendererProps) {\n  const [ref, setRef] = useState<HTMLDivElement | null>(null);\n  const { width = 0, height = 0 } = props;\n  const [{ specimen, map: m }] = useSpecimen();\n  const [{ step = 0, ...state }] = useUIState();\n\n  const [active, setActive] = useState<Point | undefined>(undefined);\n  const [hover, setHover] = useState<Point | undefined>(undefined);\n\n  const [[size, bgNodes], bgNodeColor, { start, end }] = useMemo(\n    () =>\n      [\n        parseMap(m),\n        once(() => convert(blueGrey[\"500\"])),\n        merge(getDefaults(m), { start: state.start, end: state.end }),\n      ] as const,\n    [m, state.start, state.end]\n  );\n\n  const handleClick = useMemo(() => {\n    const info = selectionInfo(m, specimen);\n    return ({ global, world }: ViewportEvent, step: number = 0) => {\n      if (ref && specimen) {\n        const { top, left } = ref.getBoundingClientRect();\n        const point = getPoint(world);\n        onSelect?.({\n          global: { x: left + global.x, y: top + global.y },\n          world: point,\n          info: info(point),\n        });\n      }\n    };\n  }, [ref, onSelect, specimen, m]);\n\n  const handleMouseEvent = useMemo(() => {\n    let timeout = 0;\n    return ({ world, event }: ViewportEvent) => {\n      switch (event) {\n        case \"onMouseOver\":\n          setHover(getPoint(world));\n          setActive(undefined);\n          clearTimeout(timeout);\n          break;\n        case \"onMouseDown\":\n          timeout = delay(() => setActive(getPoint(world)), 100);\n          break;\n      }\n    };\n  }, [setHover]);\n\n  return (\n    <Box sx={{ cursor: \"pointer\" }} ref={setRef}>\n      <Stage options={{ backgroundColor: 0xffffff }} {...props}>\n        <Viewport\n          width={width}\n          height={height}\n          onClick={(e) => handleClick(e, step)}\n          onMouseDown={handleMouseEvent}\n          onMouseOver={handleMouseEvent}\n        >\n          <Selection hover={hover} highlight={selection || active} />\n          <Nodes nodes={specimen?.eventList} />\n          <Nodes nodes={bgNodes} color={bgNodeColor} />\n          <LazyNodes nodes={specimen?.eventList} step={step} color={getColor} />\n          <Overlay start={start} end={end} size={size} />\n          <Path nodes={specimen?.eventList} step={step} />\n          <Guides width={size.x} height={size.y} alpha={0.24} grid={1} />\n        </Viewport>\n      </Stage>\n    </Box>\n  );\n}\n","import { get } from \"lodash\";\nimport { DefaultRenderer } from \"./default-renderer/DefaultRenderer\";\nimport { getDefaults } from \"./default-renderer/getDefaults\";\nimport { getDefaults as getGridDefaults } from \"./grid-renderer/getDefaults\";\nimport { GridRenderer } from \"./grid-renderer/GridRenderer\";\nimport { RendererEntry, RendererMap } from \"./Renderer\";\n\nconst renderers: RendererMap = {\n  grid: [GridRenderer, getGridDefaults],\n};\n\nexport function getRenderer(key = \"\") {\n  return get(renderers, key, [DefaultRenderer, getDefaults] as RendererEntry);\n}\n","import { createSlice } from \"./createSlice\";\r\n\r\ntype Loading = {\r\n  specimen?: boolean;\r\n  map?: boolean;\r\n};\r\n\r\nexport const [useLoading, LoadingProvider] = createSlice<Loading>(\r\n  {},\r\n  undefined,\r\n  (prev, next) => ({\r\n    ...prev,\r\n    ...next,\r\n  })\r\n);\r\n","import { getClient } from \"client/getClient\";\r\nimport {\r\n  SnackbarLabel as Label,\r\n  useSnackbar,\r\n} from \"components/generic/Snackbar\";\r\nimport { getRenderer } from \"components/specimen-renderer/getRenderer\";\r\nimport { memoize as memo } from \"lodash\";\r\nimport { ParamsOf } from \"protocol/Message\";\r\nimport { PathfindingTask } from \"protocol/SolveTask\";\r\nimport { useAsyncAbortable as useAsync } from \"react-async-hook\";\r\nimport { useLoading } from \"slices/loading\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport hash from \"md5\";\r\n\r\nconst getMap = memo(async (map: string) => {\r\n  const client = await getClient();\r\n  return (await client.call(\"features/map\", { id: map }))?.content;\r\n});\r\n\r\nasync function solve(\r\n  map: string,\r\n  params: Omit<ParamsOf<PathfindingTask>, \"mapURI\">\r\n) {\r\n  const client = await getClient();\r\n  if (map) {\r\n    for (const mapURI of [\r\n      `hash:${hash(map)}`,\r\n      `map:${encodeURIComponent(map)}`,\r\n    ] as const) {\r\n      const p = { ...params, mapURI };\r\n      const specimen = await client.call(\"solve/pathfinding\", p);\r\n      if (specimen) return { ...p, specimen, map };\r\n    }\r\n  }\r\n}\r\n\r\nexport function SpecimenService() {\r\n  const notify = useSnackbar();\r\n  const [, setLoading] = useLoading();\r\n  const [, setSpecimen] = useSpecimen();\r\n  const [{ algorithm, map, start, end }, setUIState] = useUIState();\r\n\r\n  useAsync(\r\n    async (signal) => {\r\n      setLoading({ specimen: true });\r\n      if (algorithm && map?.id && map?.type) {\r\n        const m = await getMap(map.id);\r\n        if (m) {\r\n          const [, defaults] = getRenderer(map.type);\r\n          try {\r\n            const solution = await solve(m, {\r\n              algorithm,\r\n              end: end ?? defaults(m)?.end,\r\n              start: start ?? defaults(m)?.start,\r\n              mapType: map?.type,\r\n            });\r\n            if (solution && !signal.aborted) {\r\n              setSpecimen(solution);\r\n              setUIState({ step: 0, playback: \"paused\", breakpoints: [] });\r\n              notify(\r\n                <Label\r\n                  primary=\"Solution generated.\"\r\n                  secondary={`${solution.specimen.eventList?.length} steps`}\r\n                />\r\n              );\r\n            }\r\n          } catch (e) {\r\n            notify(`${e}`);\r\n          }\r\n        }\r\n      }\r\n      setLoading({ specimen: false });\r\n    },\r\n    [algorithm, start, end, map?.id, map?.type, getClient, setLoading, notify]\r\n  );\r\n\r\n  return <></>;\r\n}\r\n","import { getClient } from \"client/getClient\";\r\nimport { FeatureDescriptor } from \"protocol/FeatureQuery\";\r\nimport { createSlice } from \"./createSlice\";\r\n\r\ntype Features = {\r\n  algorithms: FeatureDescriptor[];\r\n  maps: (FeatureDescriptor & { type: string })[];\r\n};\r\n\r\nexport const [useFeatures, FeaturesProvider] = createSlice<Features>(\r\n  { algorithms: [], maps: [] },\r\n  async () => {\r\n    const client = await getClient();\r\n    return {\r\n      algorithms: (await client.call(\"features/algorithm\")) ?? [],\r\n      maps: (await client.call(\"features/maps\")) ?? [],\r\n    };\r\n  }\r\n);\r\n","import { map, reduce } from \"lodash\";\r\nimport {\r\n  cloneElement,\r\n  createElement,\r\n  FunctionComponent,\r\n  ReactNode,\r\n} from \"react\";\r\n\r\ntype SliceProviderProps = {\r\n  slices?: FunctionComponent[];\r\n  services?: FunctionComponent[];\r\n  children?: ReactNode;\r\n};\r\n\r\nexport function SliceProvider({\r\n  slices,\r\n  children,\r\n  services,\r\n}: SliceProviderProps) {\r\n  return (\r\n    <>\r\n      {reduce(\r\n        map(slices, (s) => createElement(s)),\r\n        (prev, next) => cloneElement(next, {}, prev),\r\n        <>\r\n          {children}\r\n          {map(services, (s, i) => createElement(s, { key: i }))}\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n","import { useMediaQuery, useTheme } from \"@material-ui/core\";\r\n\r\nexport function useSmallDisplay() {\r\n  const theme = useTheme();\r\n  return useMediaQuery(theme.breakpoints.down(\"sm\"));\r\n}\r\n","import {\r\n  Menu,\r\n  MenuItem,\r\n  TextField,\r\n  TextFieldProps,\r\n  Tooltip,\r\n} from \"@material-ui/core\";\r\nimport { useSmallDisplay } from \"hooks/useSmallDisplay\";\r\nimport { findIndex, map, max } from \"lodash\";\r\nimport State, { bindMenu, bindTrigger } from \"material-ui-popup-state\";\r\nimport { ReactElement, ReactNode } from \"react\";\r\n\r\ntype Key = string | number;\r\n\r\nexport type SelectProps<T extends Key> = {\r\n  trigger?: (props: ReturnType<typeof bindTrigger>) => ReactElement;\r\n  items?: { value: T; label?: ReactNode }[];\r\n  value?: T;\r\n  onChange?: (value: T) => void;\r\n  placeholder?: string;\r\n};\r\n\r\nconst itemHeight = (sm: boolean) => (sm ? 48 : 36);\r\nconst padding = 8;\r\n\r\nexport function Select<T extends string>({\r\n  trigger,\r\n  items,\r\n  value,\r\n  onChange,\r\n  placeholder = \"Select Option\",\r\n}: SelectProps<T>) {\r\n  const sm = useSmallDisplay();\r\n  const index = max([findIndex(items, { value: value as any }), 0]) ?? 0;\r\n  return (\r\n    <State variant=\"popover\">\r\n      {(state) => (\r\n        <>\r\n          <Tooltip title={placeholder}>\r\n            <span>{trigger?.(bindTrigger(state))}</span>\r\n          </Tooltip>\r\n          <Menu\r\n            {...bindMenu(state)}\r\n            anchorOrigin={{\r\n              horizontal: \"center\",\r\n              vertical: -itemHeight(sm) * index - padding,\r\n            }}\r\n            transformOrigin={{\r\n              vertical: \"top\",\r\n              horizontal: \"center\",\r\n            }}\r\n          >\r\n            {map(items, ({ value: v, label }) => (\r\n              <MenuItem\r\n                key={v}\r\n                value={v}\r\n                selected={v === value}\r\n                onClick={() => {\r\n                  state.close();\r\n                  onChange?.(v);\r\n                }}\r\n              >\r\n                {label}\r\n              </MenuItem>\r\n            ))}\r\n          </Menu>\r\n        </>\r\n      )}\r\n    </State>\r\n  );\r\n}\r\n\r\nexport type SelectFieldProps<T extends string> = Pick<\r\n  SelectProps<T>,\r\n  \"items\" | \"onChange\"\r\n> &\r\n  Omit<TextFieldProps, \"onChange\">;\r\n\r\nexport function SelectField<T extends string>(props: SelectFieldProps<T>) {\r\n  const { placeholder, value, items = [], onChange } = props;\r\n  return (\r\n    <TextField\r\n      sx={{ minWidth: 120 }}\r\n      select\r\n      label={placeholder}\r\n      value={value}\r\n      variant=\"filled\"\r\n      {...props}\r\n      onChange={(e) => onChange?.(e.target.value as T)}\r\n    >\r\n      {map(items, (item) => (\r\n        <MenuItem key={item.value} value={item.value}>\r\n          {item.label}\r\n        </MenuItem>\r\n      ))}\r\n    </TextField>\r\n  );\r\n}\r\n","import { Button, Typography as Type } from \"@material-ui/core\";\r\nimport { Select } from \"components/generic/Select\";\r\nimport { Space } from \"components/generic/Space\";\r\nimport { find, map, startCase } from \"lodash\";\r\nimport { FeatureDescriptor } from \"protocol/FeatureQuery\";\r\n\r\ntype Props = {\r\n  label?: string;\r\n  value?: string;\r\n  onChange?: (key: string) => void;\r\n  items?: FeatureDescriptor[];\r\n};\r\n\r\nexport function FeaturePicker({ label, value, onChange, items }: Props) {\r\n  const selected = find(items, { id: value });\r\n  return (\r\n    <Select\r\n      placeholder={startCase(label)}\r\n      trigger={(props) => (\r\n        <Button {...props} disabled={!items?.length}>\r\n          {selected?.name ?? label}\r\n        </Button>\r\n      )}\r\n      items={map(items, ({ id, name }) => ({\r\n        value: id,\r\n        label: (\r\n          <>\r\n            <Type>{name}</Type>\r\n            <Space />\r\n            <Type variant=\"body2\" color=\"textSecondary\">\r\n              {id}\r\n            </Type>\r\n          </>\r\n        ),\r\n      }))}\r\n      value={selected?.id}\r\n      onChange={onChange}\r\n    />\r\n  );\r\n}\r\n","import { find } from \"lodash\";\r\nimport { useFeatures } from \"slices/features\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { FeaturePicker } from \"./FeaturePicker\";\r\n\r\nconst mapDefaults = { start: undefined, end: undefined };\r\n\r\nexport function InputControls() {\r\n  const [{ algorithms, maps }] = useFeatures();\r\n  const [{ algorithm, map }, setUIState] = useUIState();\r\n  return (\r\n    <>\r\n      <FeaturePicker\r\n        label=\"map\"\r\n        value={map?.id}\r\n        items={maps}\r\n        onChange={(v) =>\r\n          setUIState({ ...mapDefaults, map: find(maps, { id: v }) })\r\n        }\r\n      />\r\n      <FeaturePicker\r\n        label=\"algorithm\"\r\n        value={algorithm}\r\n        items={algorithms}\r\n        onChange={(v) => setUIState({ algorithm: v })}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { IconButton, IconButtonProps, Tooltip } from \"@material-ui/core\";\r\nimport { startCase } from \"lodash\";\r\nimport { ReactNode } from \"react\";\r\n\r\ntype IconButtonWithTooltipProps = {\r\n  label: string;\r\n  icon: ReactNode;\r\n} & IconButtonProps;\r\n\r\nexport function IconButtonWithTooltip({\r\n  label,\r\n  icon,\r\n  ...rest\r\n}: IconButtonWithTooltipProps) {\r\n  return (\r\n    <Tooltip title={startCase(label)} key={label}>\r\n      <span>\r\n        <IconButton {...rest}>{icon}</IconButton>\r\n      </span>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import {\r\n  PauseOutlined as PauseIcon,\r\n  PlayArrowOutlined as PlayIcon,\r\n  SkipNextOutlined as ForwardIcon,\r\n  SkipPreviousOutlined as PreviousIcon,\r\n  StopOutlined as StopIcon,\r\n} from \"@material-ui/icons\";\r\nimport { IconButtonWithTooltip as Button } from \"components/generic/IconButtonWithTooltip\";\r\nimport { usePlaybackState } from \"hooks/usePlaybackState\";\r\n\r\nexport function PlaybackControls() {\r\n  const {\r\n    playing,\r\n    canPause,\r\n    canPlay,\r\n    canStepBackward,\r\n    canStepForward,\r\n    canStop,\r\n    pause,\r\n    play,\r\n    stepBackward,\r\n    stepForward,\r\n    stop,\r\n  } = usePlaybackState();\r\n  return (\r\n    <>\r\n      <Button\r\n        label=\"step-backward\"\r\n        icon={<PreviousIcon />}\r\n        onClick={stepBackward}\r\n        disabled={!canStepBackward}\r\n      />\r\n      <Button\r\n        {...(playing\r\n          ? {\r\n              label: \"pause\",\r\n              icon: <PauseIcon />,\r\n              onClick: pause,\r\n              disabled: !canPause,\r\n            }\r\n          : {\r\n              label: \"play\",\r\n              icon: <PlayIcon />,\r\n              onClick: play,\r\n              disabled: !canPlay,\r\n              color: \"primary\",\r\n            })}\r\n      />\r\n      <Button\r\n        label=\"step-forward\"\r\n        icon={<ForwardIcon />}\r\n        onClick={stepForward}\r\n        disabled={!canStepForward}\r\n      />\r\n      <Button\r\n        label=\"stop\"\r\n        icon={<StopIcon />}\r\n        onClick={stop}\r\n        disabled={!canStop}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import {\r\n  FormControlLabel,\r\n  Switch as MuiSwitch,\r\n  SwitchProps as MuiSwitchProps,\r\n} from \"@material-ui/core\";\r\nimport { ReactNode } from \"react\";\r\n\r\ntype SwitchProps = { label?: ReactNode } & MuiSwitchProps;\r\n\r\nexport function Switch({ label = <></>, ...props }: SwitchProps) {\r\n  return (\r\n    <FormControlLabel\r\n      control={<MuiSwitch defaultChecked {...props} />}\r\n      {...{ label }}\r\n    />\r\n  );\r\n}\r\n","import {\r\n  Box,\r\n  Button,\r\n  Card,\r\n  Collapse,\r\n  IconButton,\r\n  InputBase,\r\n  List,\r\n  ListSubheader,\r\n  Switch,\r\n  Typography,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport {\r\n  Add,\r\n  DeleteOutlined as DeleteIcon,\r\n  EditOutlined as EditIcon,\r\n  LabelOutlined as LabelIcon,\r\n} from \"@material-ui/icons\";\r\nimport { filter, map, sortBy, uniqBy } from \"lodash\";\r\nimport { nanoid as id } from \"nanoid\";\r\nimport {\r\n  cloneElement,\r\n  ComponentProps,\r\n  CSSProperties,\r\n  forwardRef,\r\n  ReactElement,\r\n  ReactNode,\r\n  useEffect,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\n\r\nexport const DefaultListEditorInput = forwardRef(function StyledInputBase(\r\n  props: ComponentProps<typeof InputBase>,\r\n  ref\r\n) {\r\n  return (\r\n    <InputBase\r\n      fullWidth\r\n      {...props}\r\n      placeholder=\"Untitled item\"\r\n      inputRef={ref}\r\n    />\r\n  );\r\n});\r\n\r\ntype Key = string | number;\r\n\r\ntype Item<T = any> = {\r\n  element?: ReactElement;\r\n  enabled?: boolean;\r\n  value?: T;\r\n  id: Key;\r\n};\r\n\r\ntype Props<T = any> = {\r\n  addItemLabel?: ReactNode;\r\n  label?: ReactNode;\r\n  text?: ReactNode;\r\n  items?: Item<T>[];\r\n  useSwitch?: boolean;\r\n  useDelete?: boolean;\r\n  onChangeItem?: (key: Key, value: T, enabled: boolean) => void;\r\n  onAddItem?: () => void;\r\n  onDeleteItem?: (key: Key) => void;\r\n  icon?: ReactElement | null;\r\n  useEdit?: boolean;\r\n  variant?: \"outlined\" | \"default\";\r\n  extrasPlacement?: \"flex-start\" | \"center\" | \"flex-end\";\r\n  placeholderText?: ReactNode;\r\n  cardStyle?: CSSProperties;\r\n  autoFocus?: boolean;\r\n  getCategory?: (value?: T) => string;\r\n  getOrder?: (value?: T) => string | number;\r\n};\r\n\r\ntype ListEditorFieldProps = {\r\n  isPlaceholder?: boolean;\r\n  i?: number;\r\n};\r\n\r\nfunction useInitialRender() {\r\n  const ref = useRef(false);\r\n  const current = ref.current;\r\n  ref.current = true;\r\n  return !current;\r\n}\r\n\r\nexport function ListEditorField({\r\n  icon = <LabelIcon />,\r\n  useSwitch,\r\n  useDelete,\r\n  useEdit: useEditButton = true,\r\n  onChangeItem = () => {},\r\n  onDeleteItem = () => {},\r\n  enabled = false,\r\n  element = <DefaultListEditorInput />,\r\n  value,\r\n  id,\r\n  i = 0,\r\n  variant = \"default\",\r\n  extrasPlacement = \"center\",\r\n  autoFocus,\r\n  cardStyle: style,\r\n}: Props & ListEditorFieldProps & Item) {\r\n  const [field, setField] = useState<HTMLElement | null>(null);\r\n  const theme = useTheme();\r\n  const content = (\r\n    <Box display=\"flex\" alignItems={extrasPlacement}>\r\n      {icon !== null &&\r\n        cloneElement(icon, {\r\n          style: {\r\n            marginRight: theme.spacing(1),\r\n            marginTop: theme.spacing(0.5),\r\n            marginBottom: theme.spacing(0.5),\r\n          },\r\n          color: \"action\",\r\n        })}\r\n      <Box\r\n        flexGrow={1}\r\n        style={{\r\n          marginLeft: -theme.spacing(icon === null ? 2 : 0),\r\n        }}\r\n      >\r\n        {cloneElement(element, {\r\n          onDelete: () => onDeleteItem(id ?? i),\r\n          autoFocus,\r\n          value,\r\n          key: id ?? i,\r\n          onValueChange: (e: any) => onChangeItem(id ?? i, e, enabled),\r\n          onChange: (e: any) => onChangeItem(id ?? i, e.target.value, enabled),\r\n          ref: (e: HTMLElement | null) => setField(e),\r\n        })}\r\n      </Box>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        {useSwitch && (\r\n          <Switch\r\n            color=\"primary\"\r\n            edge=\"end\"\r\n            onChange={(_, v) => onChangeItem(id ?? i, value, v)}\r\n            checked={enabled}\r\n          />\r\n        )}\r\n        {useEditButton && (\r\n          <IconButton\r\n            edge=\"end\"\r\n            onClick={() => {\r\n              if (field?.focus) {\r\n                field.focus();\r\n              }\r\n            }}\r\n          >\r\n            <EditIcon />\r\n          </IconButton>\r\n        )}\r\n        {useDelete && (\r\n          <IconButton onClick={() => onDeleteItem(id ?? i)}>\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        )}\r\n      </Box>\r\n    </Box>\r\n  );\r\n  return (\r\n    <Box\r\n      style={{\r\n        marginBottom: theme.spacing(1),\r\n        marginLeft: theme.spacing(2),\r\n      }}\r\n    >\r\n      {variant === \"outlined\" ? (\r\n        <Card\r\n          variant=\"outlined\"\r\n          style={{\r\n            borderColor: \"transparent\",\r\n            paddingRight: theme.spacing(2),\r\n            transition: theme.transitions.create([\r\n              \"box-shadow\",\r\n              \"border-color\",\r\n            ]),\r\n            ...style,\r\n          }}\r\n        >\r\n          {content}\r\n        </Card>\r\n      ) : (\r\n        content\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default function Editor<T>(props: Props<T>) {\r\n  const {\r\n    addItemLabel = \"Add Item\",\r\n    label,\r\n    text,\r\n    onAddItem = () => {},\r\n    onDeleteItem = () => {},\r\n    items = [],\r\n    placeholderText,\r\n    autoFocus,\r\n    getCategory,\r\n    getOrder,\r\n  } = props;\r\n  const isInitialRender = useInitialRender();\r\n  const theme = useTheme();\r\n  const [intermediateItems, setIntermediateItems] = useState(items);\r\n  const [newIndex, setNewIndex] = useState(-1);\r\n  useEffect(() => {\r\n    const timeout = setTimeout(() => {\r\n      setIntermediateItems(items);\r\n    }, theme.transitions.duration.standard);\r\n    return () => {\r\n      clearTimeout(timeout);\r\n    };\r\n  }, [items, setIntermediateItems, theme.transitions.duration.standard]);\r\n  const children = uniqBy([...intermediateItems, ...items], (c) => c.id)\r\n    .map((c) => items.find((c2) => c.id === c2.id) ?? c)\r\n    .map((x, i) => {\r\n      const { enabled, element, value, id } = x ?? {};\r\n      return {\r\n        value,\r\n        render: (p?: ComponentProps<typeof ListEditorField>) => (\r\n          <Collapse\r\n            in={!!items.find((p) => p.id === x.id)}\r\n            unmountOnExit\r\n            appear={!isInitialRender}\r\n            mountOnEnter\r\n          >\r\n            <ListEditorField\r\n              {...props}\r\n              onDeleteItem={(e) => {\r\n                onDeleteItem(e);\r\n                setNewIndex(-1);\r\n              }}\r\n              enabled={enabled}\r\n              element={element}\r\n              value={value}\r\n              id={id}\r\n              i={i}\r\n              autoFocus={autoFocus || i === newIndex}\r\n              {...p}\r\n            />\r\n          </Collapse>\r\n        ),\r\n        key: id,\r\n        in: !!items.find((p) => p.id === x.id),\r\n      };\r\n    });\r\n  const sorted = sortBy(\r\n    children,\r\n    (c) => getCategory?.(c.value),\r\n    (c) => getOrder?.(c.value)\r\n  ).map((c) => ({\r\n    ...c,\r\n    render: (p?: ComponentProps<typeof ListEditorField>) => (\r\n      <Box key={c.key}>{c.render(p)}</Box>\r\n    ),\r\n  }));\r\n  return (\r\n    <List\r\n      subheader={\r\n        label || text ? (\r\n          <>\r\n            <ListSubheader disableSticky>\r\n              {label && (\r\n                <Typography variant=\"body1\" gutterBottom color=\"textPrimary\">\r\n                  {label}\r\n                </Typography>\r\n              )}\r\n              {text && (\r\n                <Typography\r\n                  variant=\"body2\"\r\n                  color=\"textSecondary\"\r\n                  gutterBottom\r\n                  style={{ marginBottom: theme.spacing(3) }}\r\n                >\r\n                  {text}\r\n                </Typography>\r\n              )}\r\n            </ListSubheader>\r\n          </>\r\n        ) : undefined\r\n      }\r\n    >\r\n      <Box mt={getCategory ? -1 : 0}>\r\n        {(() => {\r\n          const out: ReactNode[] = [];\r\n          sorted.forEach((c, i) => {\r\n            if (getCategory && isNewCategory(sorted, i, c)) {\r\n              out.push(\r\n                <Collapse\r\n                  in={items.some(\r\n                    (c2) => getCategory(c2.value) === getCategory(c.value)\r\n                  )}\r\n                  appear\r\n                  key={getCategory(c.value)}\r\n                >\r\n                  <Box pl={2} pb={2} pt={1}>\r\n                    <Typography variant=\"overline\" color=\"textSecondary\">\r\n                      {getCategory(c.value)}\r\n                    </Typography>\r\n                  </Box>\r\n                </Collapse>\r\n              );\r\n            }\r\n            out.push(c.render());\r\n          });\r\n          return out;\r\n        })()}\r\n      </Box>\r\n      <Collapse in={!items?.length}>\r\n        <Box ml={2} mb={1} pt={getCategory ? 1 : 0}>\r\n          <Typography color=\"textSecondary\">\r\n            {placeholderText ?? \"No items\"}\r\n          </Typography>\r\n        </Box>\r\n      </Collapse>\r\n      <Box p={2} mb={-3}>\r\n        <Button\r\n          disableElevation\r\n          variant=\"contained\"\r\n          startIcon={<Add />}\r\n          color=\"primary\"\r\n          onClick={() => {\r\n            onAddItem();\r\n            setNewIndex(items.length);\r\n          }}\r\n        >\r\n          {addItemLabel}\r\n        </Button>\r\n      </Box>\r\n    </List>\r\n  );\r\n\r\n  function isNewCategory(\r\n    arr: {\r\n      value: T | undefined;\r\n      render: (\r\n        p?: (Props<any> & ListEditorFieldProps & Item<any>) | undefined\r\n      ) => JSX.Element;\r\n      key: Key;\r\n    }[],\r\n    i: number,\r\n    c: {\r\n      value: T | undefined;\r\n      render: (\r\n        p?: (Props<any> & ListEditorFieldProps & Item<any>) | undefined\r\n      ) => JSX.Element;\r\n      key: Key;\r\n    }\r\n  ) {\r\n    return !!(\r\n      getCategory &&\r\n      (arr[i - 1] === undefined ||\r\n        getCategory(arr[i - 1].value) !== getCategory(c.value))\r\n    );\r\n  }\r\n}\r\n\r\nexport function ListEditor<T extends { key: string }>({\r\n  onChange,\r\n  value,\r\n  editor,\r\n  create,\r\n  ...props\r\n}: Omit<Props<T>, \"items\"> & {\r\n  items?: T[];\r\n  onChange?: (value: T[]) => void;\r\n  value?: T[];\r\n  editor?: (item: T) => ReactElement;\r\n  create?: () => Omit<T, \"key\">;\r\n}) {\r\n  const [state, setState] = useState(value ?? []);\r\n  function handleChange(next: T[]) {\r\n    setState(next);\r\n    onChange?.(next);\r\n  }\r\n  return (\r\n    <Box sx={{ ml: -2 }}>\r\n      <Editor\r\n        {...props}\r\n        items={state.map((c) => ({\r\n          id: c.key,\r\n          value: c,\r\n          element: editor?.(c),\r\n        }))}\r\n        useDelete\r\n        useEdit={false}\r\n        onAddItem={() =>\r\n          handleChange([...state, { key: id(), ...create?.() } as T])\r\n        }\r\n        onDeleteItem={(k) => {\r\n          return handleChange(filter(state, (b) => b.key !== k));\r\n        }}\r\n        onChangeItem={(k, v) =>\r\n          handleChange(map(state, (b) => (b.key === k ? v : b)))\r\n        }\r\n      />\r\n    </Box>\r\n  );\r\n}\r\n","import { Comparator } from \"slices/UIState\";\r\n\r\nexport const comparators: Comparator[] = [\r\n  {\r\n    key: \"equal\",\r\n    apply: (a, b) => a === b,\r\n  },\r\n  {\r\n    key: \"less-than\",\r\n    apply: (a, b) => a < b,\r\n  },\r\n  {\r\n    key: \"greater-than\",\r\n    apply: (a, b) => a > b,\r\n  },\r\n];\r\n","export const intrinsicProperties = [\"f\", \"g\"];\r\n","import { TraceEventType } from \"protocol/Trace\";\r\n\r\nexport const eventTypes: (TraceEventType | \"any\")[] = [\r\n  \"any\",\r\n  \"source\",\r\n  \"destination\",\r\n  \"expanding\",\r\n  \"generating\",\r\n  \"closing\",\r\n];\r\n","import { Divider, TextField, Typography as Type } from \"@material-ui/core\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { SelectField as Select } from \"components/generic/Select\";\r\nimport { Space } from \"components/generic/Space\";\r\nimport { Switch } from \"components/generic/Switch\";\r\nimport { find, last, map, startCase } from \"lodash\";\r\nimport { Breakpoint } from \"slices/UIState\";\r\nimport { comparators } from \"./comparators\";\r\nimport { eventTypes } from \"./eventTypes\";\r\n\r\ntype BreakpointEditorProps = {\r\n  value: Breakpoint;\r\n  onValueChange?: (v: Breakpoint) => void;\r\n  properties?: string[];\r\n};\r\n\r\nexport function BreakpointEditor({\r\n  value,\r\n  onValueChange: onChange,\r\n  properties,\r\n}: BreakpointEditorProps) {\r\n  function handleChange(next: Partial<Breakpoint>) {\r\n    onChange?.({ ...value, ...next });\r\n  }\r\n  return (\r\n    <Flex>\r\n      <Select\r\n        placeholder=\"Event\"\r\n        sx={{ minWidth: 160 }}\r\n        items={map(eventTypes, (c) => ({ value: c, label: startCase(c) }))}\r\n        onChange={(v) => handleChange({ type: v === \"any\" ? undefined : v })}\r\n        value={value.type ?? \"any\"}\r\n      />\r\n      <Divider flexItem orientation=\"vertical\" sx={{ mx: 2 }} />\r\n      <Select\r\n        placeholder=\"Property\"\r\n        sx={{\r\n          minWidth: 140,\r\n          textOverflow: \"ellipsis\",\r\n          whiteSpace: \"nowrap\",\r\n        }}\r\n        items={map(properties, (c) => ({\r\n          value: c,\r\n          label: (\r\n            <>\r\n              {last(c.split(\".\"))}\r\n              <Space />\r\n              <Type\r\n                color=\"textSecondary\"\r\n                variant=\"body2\"\r\n                component=\"span\"\r\n              >{`event.${c}`}</Type>\r\n            </>\r\n          ),\r\n        }))}\r\n        onChange={(v) => handleChange({ property: v })}\r\n        value={value.property}\r\n      />\r\n      <Space />\r\n      <Select\r\n        placeholder=\"Condition\"\r\n        items={comparators.map((c) => ({\r\n          value: c.key,\r\n          label: startCase(c.key),\r\n        }))}\r\n        value={value?.condition?.key ?? comparators?.[0]?.key}\r\n        onChange={(v) =>\r\n          handleChange({ condition: find(comparators, { key: v }) })\r\n        }\r\n      />\r\n      <Space />\r\n      <TextField\r\n        label=\"Reference\"\r\n        fullWidth\r\n        value={`${value.reference ?? 0}`}\r\n        variant=\"filled\"\r\n        inputProps={{ inputMode: \"numeric\", pattern: \"[0-9]*\" }}\r\n        onChange={(v) => handleChange({ reference: +v.target.value })}\r\n        type=\"number\"\r\n      />\r\n      <Space sx={{ px: 2 }} />\r\n      <Switch\r\n        checked={!!value.active}\r\n        onChange={(_, v) => handleChange({ active: v })}\r\n      />\r\n    </Flex>\r\n  );\r\n}\r\n","export const propertyPaths = [\"variables\"];\r\n","import { ListEditor } from \"components/generic/ListEditor\";\r\nimport { debounce, flatMap as flat, get, keys, map, uniq } from \"lodash\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { Breakpoint, useUIState } from \"slices/UIState\";\r\nimport { comparators } from \"./comparators\";\r\nimport { intrinsicProperties } from \"./intrinsicProperties\";\r\nimport { BreakpointEditor } from \"./BreakpointEditor\";\r\nimport { Box } from \"@material-ui/system\";\r\nimport { propertyPaths as paths } from \"./propertyPaths\";\r\n\r\nexport function BreakpointListEditor() {\r\n  const [{ breakpoints = [] }, setUIState] = useUIState();\r\n  const [{ specimen }] = useSpecimen();\r\n\r\n  const properties = uniq([\r\n    ...intrinsicProperties,\r\n    ...flat(paths, (p) =>\r\n      flat(specimen?.nodeStructure, (v) =>\r\n        map(keys(get(v, p)), (k) => `${p}.${k}`)\r\n      )\r\n    ),\r\n  ]);\r\n\r\n  return (\r\n    <Box sx={{ overflow: \"auto hidden\", width: \"100%\" }}>\r\n      <Box sx={{ minWidth: 720, mb: 2 }}>\r\n        <ListEditor<Breakpoint>\r\n          icon={null}\r\n          value={breakpoints}\r\n          useDelete\r\n          useEdit={false}\r\n          editor={(v) => <BreakpointEditor value={v} properties={properties} />}\r\n          create={() => ({\r\n            active: true,\r\n            property: properties?.[0],\r\n            condition: comparators?.[0],\r\n            type: undefined,\r\n            reference: 0,\r\n          })}\r\n          onChange={debounce((v) => setUIState({ breakpoints: v }), 1000)}\r\n          addItemLabel=\"Breakpoint\"\r\n          placeholderText=\"Click the button below to add a breakpoint.\"\r\n        />\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { CircularProgress } from \"@material-ui/core\";\r\nimport Editor from \"@monaco-editor/react\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { debounce } from \"lodash\";\r\nimport AutoSize from \"react-virtualized-auto-sizer\";\r\nimport { useUIState } from \"slices/UIState\";\r\n\r\nexport function ScriptEditor() {\r\n  const [{ code }, setUIState] = useUIState();\r\n  return (\r\n    <Flex height=\"70vh\" overflow=\"hidden\">\r\n      <AutoSize>\r\n        {({ width, height }) => (\r\n          <Editor\r\n            width={width}\r\n            loading={<CircularProgress variant=\"indeterminate\" />}\r\n            height={height}\r\n            language=\"javascript\"\r\n            defaultValue={code}\r\n            onChange={debounce((v) => setUIState({ code: v }), 1000)}\r\n            options={{\r\n              minimap: {\r\n                enabled: false,\r\n              },\r\n            }}\r\n          />\r\n        )}\r\n      </AutoSize>\r\n    </Flex>\r\n  );\r\n}\r\n","import { Box, Divider, Tab, Typography as Type } from \"@material-ui/core\";\r\nimport { TabContext, TabList, TabPanel } from \"@material-ui/lab\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { Space } from \"components/generic/Space\";\r\nimport { Switch } from \"components/generic/Switch\";\r\nimport { ReactNode, useState } from \"react\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { BreakpointListEditor } from \"./breakpoint-editor/BreakpointListEditor\";\r\nimport { ScriptEditor } from \"./script-editor/ScriptEditor\";\r\n\r\nexport function DebugOptionsEditor() {\r\n  const [{ monotonicF, monotonicG }, setUIState] = useUIState();\r\n  const [tab, setTab] = useState(\"standard\");\r\n  function renderHeading(label: ReactNode) {\r\n    return (\r\n      <Type variant=\"overline\" color=\"textSecondary\">\r\n        {label}\r\n      </Type>\r\n    );\r\n  }\r\n  return (\r\n    <TabContext value={tab}>\r\n      <TabList onChange={(_, v) => setTab(v)}>\r\n        <Tab label=\"Standard\" value=\"standard\" />\r\n        <Tab label=\"Advanced\" value=\"advanced\" />\r\n      </TabList>\r\n      <Divider />\r\n      <TabPanel value=\"standard\">\r\n        <Box>\r\n          {renderHeading(\"General\")}\r\n          <Flex>\r\n            <Switch\r\n              label=\"Monotonic f value\"\r\n              checked={!!monotonicF}\r\n              onChange={(_, v) => setUIState({ monotonicF: v })}\r\n            />\r\n            <Space />\r\n            <Switch\r\n              label=\"Monotonic g value\"\r\n              checked={!!monotonicG}\r\n              onChange={(_, v) => setUIState({ monotonicG: v })}\r\n            />\r\n          </Flex>\r\n        </Box>\r\n        <Space />\r\n        <Box>\r\n          {renderHeading(\"Breakpoints\")}\r\n          <BreakpointListEditor />\r\n        </Box>\r\n      </TabPanel>\r\n      <TabPanel value=\"advanced\" sx={{ p: 0 }}>\r\n        <ScriptEditor />\r\n      </TabPanel>\r\n    </TabContext>\r\n  );\r\n}\r\n","import { noop } from \"lodash\";\r\nimport {\r\n  ComponentProps,\r\n  createContext,\r\n  useContext,\r\n  useEffect,\r\n  useState,\r\n} from \"react\";\r\n\r\ntype ScrollPanelProps = {\r\n  onTarget?: (e: HTMLDivElement | null) => void;\r\n} & ComponentProps<\"div\">;\r\n\r\nexport function ScrollPanel({\r\n  onTarget = noop,\r\n  onScroll,\r\n  ...props\r\n}: ScrollPanelProps) {\r\n  const [target, setTarget] = useState<HTMLDivElement | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (target && onScroll) {\r\n      target.addEventListener(\"scroll\", onScroll as any, { passive: true });\r\n      return () => target.removeEventListener(\"scroll\", onScroll as any);\r\n    }\r\n  }, [target, onScroll]);\r\n\r\n  return (\r\n    <div\r\n      {...props}\r\n      style={{\r\n        height: \"100%\",\r\n        width: \"100%\",\r\n        overflow: \"hidden scroll\",\r\n        ...props.style,\r\n      }}\r\n      ref={(e) => {\r\n        setTarget(e);\r\n        onTarget?.(e);\r\n      }}\r\n    >\r\n      <PanelContext.Provider value={target}>\r\n        <div\r\n          style={{\r\n            width: \"100%\",\r\n          }}\r\n        >\r\n          {props.children}\r\n        </div>\r\n      </PanelContext.Provider>\r\n    </div>\r\n  );\r\n}\r\nconst PanelContext = createContext<HTMLDivElement | null>(null);\r\n\r\nexport function usePanel() {\r\n  return useContext(PanelContext);\r\n}\r\n","import {\r\n  AppBar,\r\n  Box,\r\n  Dialog,\r\n  Fade,\r\n  IconButton,\r\n  Toolbar,\r\n  Typography,\r\n  useTheme,\r\n} from \"@material-ui/core\";\r\nimport { ArrowBack } from \"@material-ui/icons\";\r\nimport { ResizeSensor } from \"css-element-queries\";\r\nimport PopupState from \"material-ui-popup-state\";\r\nimport {\r\n  cloneElement,\r\n  ComponentProps,\r\n  CSSProperties,\r\n  ReactElement,\r\n  ReactNode,\r\n  SyntheticEvent,\r\n  useEffect,\r\n  useState,\r\n} from \"react\";\r\nimport { useScrollState } from \"hooks/useScrollState\";\r\nimport { useSmallDisplay } from \"hooks/useSmallDisplay\";\r\nimport { ScrollPanel, usePanel } from \"./ScrollPanel\";\r\n\r\nexport function AppBarTitle({ children }: { children?: ReactNode }) {\r\n  return <Typography variant=\"h6\">{children}</Typography>;\r\n}\r\n\r\nexport type Props = {\r\n  children?: ReactNode;\r\n  actions?: ReactNode;\r\n  width?: number;\r\n  height?: string | number;\r\n  onTarget?: (target: HTMLDivElement | null) => void;\r\n  variant?: \"default\" | \"submodal\";\r\n  scrollable?: boolean;\r\n};\r\n\r\ntype ModalAppBarProps = {\r\n  onClose?: () => void;\r\n  style?: CSSProperties;\r\n  elevatedStyle?: CSSProperties;\r\n  transitionProperties?: string[];\r\n  children?: ReactNode;\r\n  elevatedChildren?: ReactNode;\r\n  simple?: boolean;\r\n  position?: \"fixed\" | \"absolute\" | \"sticky\" | \"static\";\r\n};\r\n\r\nexport function ModalAppBar({\r\n  onClose = () => {},\r\n  style,\r\n  elevatedStyle,\r\n  children,\r\n  transitionProperties = [\"box-shadow\", \"background\", \"border-bottom\"],\r\n  elevatedChildren,\r\n  simple,\r\n  position = \"sticky\",\r\n}: ModalAppBarProps) {\r\n  const panel = usePanel();\r\n  const theme = useTheme();\r\n  const [, , isAbsoluteTop, , setTarget] = useScrollState();\r\n  useEffect(() => {\r\n    setTarget(panel);\r\n  }, [panel, setTarget]);\r\n\r\n  const styles = isAbsoluteTop\r\n    ? {\r\n        background: theme.palette.background.paper,\r\n        ...(!simple && {\r\n          boxShadow: theme.shadows[0],\r\n        }),\r\n        ...style,\r\n      }\r\n    : {\r\n        background: theme.palette.background.paper,\r\n        ...(!simple && {\r\n          boxShadow: theme.shadows[4],\r\n        }),\r\n        ...elevatedStyle,\r\n      };\r\n\r\n  return (\r\n    <AppBar\r\n      elevation={0}\r\n      position={position}\r\n      style={{\r\n        color: theme.palette.text.primary,\r\n        transition: theme.transitions.create(transitionProperties),\r\n        ...styles,\r\n      }}\r\n    >\r\n      <Toolbar>\r\n        <IconButton\r\n          style={{\r\n            marginRight: theme.spacing(1),\r\n          }}\r\n          aria-label=\"open drawer\"\r\n          edge=\"start\"\r\n          onClick={() => onClose()}\r\n        >\r\n          <ArrowBack />\r\n        </IconButton>\r\n\r\n        {children && (\r\n          <div\r\n            style={{\r\n              gridColumn: 1,\r\n              gridRow: 1,\r\n              flex: 1,\r\n              overflow: \"auto\",\r\n            }}\r\n          >\r\n            <Fade\r\n              in={!!(!elevatedChildren || isAbsoluteTop)}\r\n              mountOnEnter\r\n              unmountOnExit\r\n            >\r\n              <Box style={{ width: \"100%\" }}>{children}</Box>\r\n            </Fade>\r\n          </div>\r\n        )}\r\n        {elevatedChildren && (\r\n          <div\r\n            style={{\r\n              gridColumn: 1,\r\n              gridRow: 1,\r\n              flex: 1,\r\n              overflow: \"auto\",\r\n            }}\r\n          >\r\n            <Fade\r\n              in={!!(elevatedChildren && !isAbsoluteTop)}\r\n              mountOnEnter\r\n              unmountOnExit\r\n            >\r\n              <Box style={{ width: \"100%\" }}>{elevatedChildren}</Box>\r\n            </Fade>\r\n          </div>\r\n        )}\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n\r\nexport default function Modal({\r\n  children,\r\n  actions,\r\n  width = 480,\r\n  height,\r\n  onTarget,\r\n  variant = \"default\",\r\n  scrollable = true,\r\n  ...props\r\n}: Props & ComponentProps<typeof Dialog>) {\r\n  const [content, setContent] = useState<ReactNode | undefined>(undefined);\r\n  useEffect(() => {\r\n    if (children) setContent(children);\r\n  }, [children]);\r\n  const theme = useTheme();\r\n  const sm = useSmallDisplay();\r\n\r\n  const [target, setTarget] = useState<HTMLElement | null>(null);\r\n  const [contentRef, setContentRef] = useState<HTMLElement | null>(null);\r\n  const [hasOverflowingChildren, setHasOverflowingChildren] = useState(false);\r\n  const [childHeight, setChildHeight] = useState(0);\r\n\r\n  useEffect(() => {\r\n    if (target && contentRef && !sm && !height) {\r\n      const callback = () => {\r\n        const doesOverflow = window.innerHeight - 64 < contentRef.offsetHeight;\r\n        setHasOverflowingChildren(doesOverflow);\r\n        setChildHeight(\r\n          contentRef.offsetHeight <= 1 ? 0 : Math.ceil(contentRef.offsetHeight)\r\n        );\r\n      };\r\n      window.addEventListener(\"resize\", callback);\r\n      const ob = new ResizeSensor(contentRef, callback);\r\n      callback();\r\n      return () => {\r\n        window.removeEventListener(\"resize\", callback);\r\n        ob.detach();\r\n      };\r\n    }\r\n  }, [target, contentRef, sm, height]);\r\n\r\n  const useVariant = variant === \"submodal\" && sm;\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={sm}\r\n      {...props}\r\n      style={{\r\n        ...(useVariant && {\r\n          paddingTop: theme.spacing(8),\r\n        }),\r\n        ...props.style,\r\n      }}\r\n      PaperProps={{\r\n        ref: (e: HTMLElement | null) => setTarget(e),\r\n        style: {\r\n          ...(useVariant && {\r\n            borderRadius: `${theme.shape.borderRadius}px ${theme.shape.borderRadius}px 0 0`,\r\n          }),\r\n          background: theme.palette.background.default,\r\n          overflow: \"hidden\",\r\n          height:\r\n            height && !sm\r\n              ? height\r\n              : hasOverflowingChildren || sm\r\n              ? \"100%\"\r\n              : childHeight || \"fit-content\",\r\n          position: \"relative\",\r\n          maxWidth: \"none\",\r\n          ...props.PaperProps?.style,\r\n        },\r\n        ...props.PaperProps,\r\n      }}\r\n    >\r\n      <ScrollPanel\r\n        style={{\r\n          height: \"100%\",\r\n          width: sm ? undefined : width,\r\n          maxWidth: \"100%\",\r\n          overflow: scrollable ? undefined : \"hidden\",\r\n        }}\r\n        onTarget={onTarget}\r\n      >\r\n        <div\r\n          ref={(e) => setContentRef(e)}\r\n          style={{ width: \"100%\", height: \"100%\" }}\r\n        >\r\n          {content}\r\n        </div>\r\n      </ScrollPanel>\r\n      {actions}\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport function ManagedModal({\r\n  options: ModalProps,\r\n  appBar: ModalAppBarProps,\r\n  trigger = () => <></>,\r\n  children,\r\n}: {\r\n  options?: Props;\r\n  trigger?: (onClick: (e: SyntheticEvent<any, Event>) => void) => ReactElement;\r\n  appBar?: ModalAppBarProps;\r\n  children?: ReactNode;\r\n}) {\r\n  return (\r\n    <PopupState variant=\"popover\">\r\n      {({ open, close, isOpen }) => {\r\n        return (\r\n          <>\r\n            {cloneElement(trigger(open))}\r\n            <Modal open={isOpen} onClose={close} {...ModalProps}>\r\n              <ModalAppBar onClose={close} {...ModalAppBarProps} />\r\n              {children ?? ModalProps?.children}\r\n            </Modal>\r\n          </>\r\n        );\r\n      }}\r\n    </PopupState>\r\n  );\r\n}\r\n","import { useEffect, useRef, useState } from \"react\";\r\n\r\nexport function useScrollState(threshold: number = 128) {\r\n  const [showControls, setShowControls] = useState(true);\r\n  const [isAbsoluteTop, setIsAbsoluteTop] = useState(true);\r\n  const [isTop, setIsTop] = useState(true);\r\n  const [target, setTarget] = useState<HTMLElement | null>(null);\r\n  const lastTop = useRef(0);\r\n  useEffect(() => {\r\n    if (target) {\r\n      const listener = () => {\r\n        {\r\n          const newIsTop = target.scrollTop <= threshold;\r\n          if (newIsTop !== isTop) {\r\n            setIsTop(newIsTop);\r\n          }\r\n        }\r\n        {\r\n          const newIsTop = target.scrollTop <= 1;\r\n          if (newIsTop !== isAbsoluteTop) {\r\n            setIsAbsoluteTop(newIsTop);\r\n          }\r\n        }\r\n        if (lastTop.current - target.scrollTop) {\r\n          if (\r\n            Math.abs(lastTop.current - target.scrollTop) > 2 &&\r\n            lastTop.current >= 0\r\n          ) {\r\n            setShowControls(lastTop.current > target.scrollTop);\r\n          }\r\n          lastTop.current = target.scrollTop;\r\n        }\r\n      };\r\n      target.addEventListener(\"scroll\", listener, { passive: true });\r\n      return () => {\r\n        target.removeEventListener(\"scroll\", listener);\r\n      };\r\n    }\r\n  }, [target, isTop, isAbsoluteTop, lastTop, threshold]);\r\n  return [\r\n    showControls || isTop,\r\n    isTop,\r\n    isAbsoluteTop,\r\n    target,\r\n    setTarget,\r\n  ] as const;\r\n}\r\n","import { Button } from \"@material-ui/core\";\r\nimport { BugReport as BugIcon } from \"@material-ui/icons\";\r\nimport { DebugOptionsEditor } from \"components/DebugOptionsEditor\";\r\nimport {\r\n  AppBarTitle as Title,\r\n  ManagedModal as Dialog,\r\n} from \"components/generic/Modal\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\n\r\nexport function UtilityControls() {\r\n  const [{ specimen }] = useSpecimen();\r\n  // const INTEROP_compare = useCompatibilityLayer(\"#comparator button\");\r\n  // const INTEROP_timeTravel = useCompatibilityLayer(\"#time-travel button\");\r\n  return (\r\n    <>\r\n      <Dialog\r\n        trigger={(onClick) => (\r\n          <Button {...{ onClick }} disabled={!specimen} startIcon={<BugIcon />}>\r\n            Debug\r\n          </Button>\r\n        )}\r\n        options={{ width: 960, scrollable: false }}\r\n        appBar={{ children: <Title>Debug Options</Title> }}\r\n      >\r\n        <DebugOptionsEditor />\r\n      </Dialog>\r\n      {/* <Button disabled={!specimen} onClick={INTEROP_compare}>\r\n        Compare...\r\n      </Button> */}\r\n      {/* <Button disabled={!specimen} onClick={INTEROP_timeTravel}>\r\n        Jump...\r\n      </Button> */}\r\n    </>\r\n  );\r\n}\r\n","import { AppBar, Box, Divider, Toolbar } from \"@material-ui/core\";\r\nimport { InputControls } from \"./InputControls\";\r\nimport { PlaybackControls } from \"./PlaybackControls\";\r\nimport { UtilityControls } from \"./UtilityControls\";\r\n\r\nconst divider = <Divider orientation=\"vertical\" flexItem sx={{ m: 1 }} />;\r\n\r\nexport function Controls() {\r\n  return (\r\n    <AppBar position=\"static\" color=\"transparent\" elevation={0}>\r\n      <Toolbar>\r\n        <Box m={-1} display=\"flex\" alignItems=\"center\">\r\n          <InputControls />\r\n          {divider}\r\n          <PlaybackControls />\r\n          {divider}\r\n          <UtilityControls />\r\n        </Box>\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n","import { Box, BoxProps } from \"@material-ui/core\";\r\nimport { ReactElement } from \"react\";\r\nimport {\r\n  Virtuoso as List,\r\n  VirtuosoHandle as Handle,\r\n  VirtuosoProps as ListProps,\r\n} from \"react-virtuoso\";\r\n\r\nexport type LazyListHandle = Handle;\r\n\r\nexport type LazyListProps<T> = {\r\n  items?: T[];\r\n  renderItem?: (item: T, index: number) => ReactElement;\r\n  listOptions?: Partial<ListProps<T>>;\r\n} & BoxProps;\r\n\r\nexport function LazyList<T>({\r\n  items = [],\r\n  renderItem,\r\n  listOptions: options,\r\n  ...props\r\n}: LazyListProps<T>) {\r\n  return (\r\n    <Box {...props}>\r\n      <List\r\n        totalCount={items.length}\r\n        itemContent={(i) => renderItem?.(items[i], i)}\r\n        {...options}\r\n      />\r\n    </Box>\r\n  );\r\n}\r\n","import { Typography as Type } from \"@material-ui/core\";\r\nimport { FiberManualRecord as Dot } from \"@material-ui/icons\";\r\nimport { ComponentProps, ReactNode } from \"react\";\r\n\r\nexport function OverlineDot(props: ComponentProps<typeof Dot>) {\r\n  return (\r\n    <Dot\r\n      {...props}\r\n      sx={{\r\n        fontSize: 12,\r\n        transform: \"translateY(1.75px) translateX(-2px)\",\r\n        ...props.sx,\r\n      }}\r\n    />\r\n  );\r\n}\r\n\r\ntype Props = {\r\n  children?: ReactNode;\r\n};\r\n\r\nexport function Overline({ children }: Props) {\r\n  return (\r\n    <Type variant=\"overline\" sx={{ my: -0.75, display: \"block\" }}>\r\n      {children}\r\n    </Type>\r\n  );\r\n}\r\n","import { Flex } from \"./Flex\";\r\nimport {\r\n  Typography as Type,\r\n  TypographyProps as TypeProps,\r\n} from \"@material-ui/core\";\r\nimport { Space } from \"./Space\";\r\nimport { ReactNode } from \"react\";\r\n\r\ntype Props = {\r\n  label?: ReactNode;\r\n  value?: ReactNode;\r\n  type?: TypeProps;\r\n};\r\n\r\nexport function Property({ label, value, type }: Props) {\r\n  return (\r\n    <Flex width=\"auto\" mr={3} mt={0.5} key={`${label}::${value}`}>\r\n      <Type sx={{ opacity: 0.54 }} {...type}>\r\n        {label}\r\n      </Type>\r\n      <Space />\r\n      <Type {...type}>{value}</Type>\r\n    </Flex>\r\n  );\r\n}\r\n","import {\r\n  Box,\r\n  Card,\r\n  CardActionArea,\r\n  CardProps,\r\n  Divider,\r\n  Typography as Type,\r\n} from \"@material-ui/core\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { Overline, OverlineDot as Dot } from \"components/generic/Overline\";\r\nimport { Property } from \"components/generic/Property\";\r\nimport { getColorHex } from \"components/specimen-renderer/grid-renderer/colors\";\r\nimport { entries, filter, map } from \"lodash\";\r\nimport { TraceEvent } from \"protocol/Trace\";\r\nimport { useUIState } from \"slices/UIState\";\r\n\r\nexport function getHeight(event: TraceEvent) {}\r\n\r\ntype EventInspectorProps = {\r\n  event?: TraceEvent;\r\n  index?: number;\r\n  selected?: boolean;\r\n} & CardProps;\r\n\r\nexport function EventInspector({\r\n  event,\r\n  index,\r\n  selected,\r\n  ...props\r\n}: EventInspectorProps) {\r\n  const [, setUIState] = useUIState();\r\n\r\n  const cardStyles = selected\r\n    ? {\r\n        color: \"primary.contrastText\",\r\n        bgcolor: \"primary.main\",\r\n      }\r\n    : {};\r\n\r\n  return (\r\n    <Card\r\n      {...props}\r\n      sx={{\r\n        ...cardStyles,\r\n        ...props.sx,\r\n      }}\r\n    >\r\n      <CardActionArea\r\n        sx={{ p: 2, height: \"100%\" }}\r\n        onClick={() => setUIState({ step: index })}\r\n      >\r\n        <Flex alignItems=\"center\">\r\n          <Type>{index}</Type>\r\n          <Divider sx={{ mx: 2 }} flexItem orientation=\"vertical\" />\r\n          <Box>\r\n            <Overline>\r\n              <Dot\r\n                sx={{\r\n                  color: getColorHex(event?.type),\r\n                  mr: 1,\r\n                }}\r\n              />\r\n              {`${event?.type ?? \"unsupported\"} #${event?.id ?? \"-\"}`}\r\n            </Overline>\r\n            <Flex flexWrap=\"wrap\">\r\n              {map(\r\n                filter(\r\n                  [\r\n                    [\"f\", event?.f],\r\n                    [\"g\", event?.g],\r\n                    ...entries(event?.variables),\r\n                  ],\r\n                  ([, v]) => v !== undefined\r\n                ),\r\n                ([k, v]) => (\r\n                  <Property label={k} value={v} type={{ variant: \"body2\" }} />\r\n                )\r\n              )}\r\n            </Flex>\r\n          </Box>\r\n        </Flex>\r\n      </CardActionArea>\r\n    </Card>\r\n  );\r\n}\r\n","import { Fade } from \"@material-ui/core\";\r\nimport { Box } from \"@material-ui/system\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport {\r\n  LazyList as List,\r\n  LazyListHandle as ListHandle,\r\n  LazyListProps as ListProps,\r\n} from \"components/generic/LazyList\";\r\nimport { defer } from \"lodash\";\r\nimport { TraceEvent } from \"protocol/Trace\";\r\nimport { useEffect, useRef } from \"react\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { EventInspector } from \"./EventInspector\";\r\n\r\nexport function EventListInspector(props: ListProps<TraceEvent>) {\r\n  const [{ step = 0, playback }] = useUIState();\r\n  const [{ specimen }] = useSpecimen();\r\n  const ref = useRef<ListHandle | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (playback === \"paused\") {\r\n      defer(() =>\r\n        ref?.current?.scrollToIndex?.({\r\n          index: step,\r\n          align: \"start\",\r\n          behavior: \"smooth\",\r\n          offset: -16,\r\n        })\r\n      );\r\n    }\r\n  }, [ref, step, playback]);\r\n\r\n  return (\r\n    <Fade unmountOnExit mountOnEnter in={playback === \"paused\"}>\r\n      <Box>\r\n        <List\r\n          {...props}\r\n          items={specimen?.eventList}\r\n          listOptions={{ ref }}\r\n          renderItem={(item, i) => (\r\n            <Flex p={2} pt={i ? 0 : 2}>\r\n              <EventInspector\r\n                sx={{ flex: 1 }}\r\n                event={item}\r\n                index={i}\r\n                selected={i === step}\r\n              />\r\n            </Flex>\r\n          )}\r\n        />\r\n      </Box>\r\n    </Fade>\r\n  );\r\n}\r\n","import {\r\n  Divider,\r\n  ListItem,\r\n  ListItemIcon,\r\n  ListItemText,\r\n  Menu,\r\n  MenuItem,\r\n} from \"@material-ui/core\";\r\nimport {\r\n  PlaceOutlined as DestinationIcon,\r\n  TripOriginOutlined as StartIcon,\r\n} from \"@material-ui/icons\";\r\nimport { Overline } from \"components/generic/Overline\";\r\nimport { Property } from \"components/generic/Property\";\r\nimport { map } from \"lodash\";\r\nimport { useUIState } from \"slices/UIState\";\r\nimport { SelectEvent as RendererSelectEvent } from \"components/specimen-renderer/Renderer\";\r\nimport { useSnackbar } from \"components/generic/Snackbar\";\r\n\r\ntype Props = {\r\n  selection?: RendererSelectEvent;\r\n  onClose?: () => void;\r\n};\r\n\r\nexport function SelectionMenu({ selection, onClose }: Props) {\r\n  const notify = useSnackbar();\r\n  const [, setUIState] = useUIState();\r\n  const { global, world, info } = selection ?? {};\r\n  const { current, entry, node } = info ?? {};\r\n\r\n  return (\r\n    <Menu\r\n      open={!!selection}\r\n      anchorReference=\"anchorPosition\"\r\n      anchorPosition={{\r\n        top: global?.y ?? 0,\r\n        left: global?.x ?? 0,\r\n      }}\r\n      onClose={onClose}\r\n    >\r\n      <ListItem>\r\n        <ListItemText>\r\n          <Overline>Point</Overline>\r\n          <Property label=\"x\" value={world?.x ?? \"-\"} />\r\n          <Property label=\"y\" value={world?.y ?? \"-\"} />\r\n        </ListItemText>\r\n      </ListItem>\r\n      <Divider sx={{ my: 1 }} />\r\n      {map(\r\n        [\r\n          {\r\n            label: \"Set Origin\",\r\n            icon: <StartIcon sx={{ transform: \"scale(0.5)\" }} />,\r\n            action: () => {\r\n              notify(\"Origin set.\");\r\n              setUIState({ start: node?.key });\r\n            },\r\n            disabled: !node,\r\n          },\r\n          {\r\n            label: \"Set Destination\",\r\n            icon: <DestinationIcon />,\r\n            action: () => {\r\n              notify(\"Destination set.\");\r\n              setUIState({ end: node?.key });\r\n            },\r\n            disabled: !node,\r\n          },\r\n          {\r\n            label: \"Go to Expansion Step\",\r\n            action: () =>\r\n              setUIState({ step: entry?.index ?? 0, playback: \"paused\" }),\r\n            disabled: !entry,\r\n          },\r\n          {\r\n            label: \"Rewind to This Step\",\r\n            action: () =>\r\n              setUIState({ step: current?.index ?? 0, playback: \"paused\" }),\r\n            disabled: !current,\r\n          },\r\n        ],\r\n        ({ label, icon, action, disabled }) => (\r\n          <MenuItem\r\n            disabled={disabled}\r\n            onClick={() => {\r\n              action();\r\n              onClose?.();\r\n            }}\r\n          >\r\n            <ListItemIcon>{icon}</ListItemIcon>\r\n            <ListItemText>{label}</ListItemText>\r\n          </MenuItem>\r\n        )\r\n      )}\r\n    </Menu>\r\n  );\r\n}\r\n","import { Fade, LinearProgress } from \"@material-ui/core\";\r\nimport { Flex, FlexProps } from \"components/generic/Flex\";\r\nimport { getRenderer } from \"components/specimen-renderer/getRenderer\";\r\nimport { SelectEvent as RendererSelectEvent } from \"components/specimen-renderer/Renderer\";\r\nimport { some, values } from \"lodash\";\r\nimport { createElement, useState } from \"react\";\r\nimport AutoSize from \"react-virtualized-auto-sizer\";\r\nimport { useLoading } from \"slices/loading\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { EventListInspector } from \"./EventListInspector\";\r\nimport { SelectionMenu } from \"./SelectionMenu\";\r\n\r\ntype SpecimenInspectorProps = {} & FlexProps;\r\n\r\nexport function SpecimenInspector(props: SpecimenInspectorProps) {\r\n  const [loading] = useLoading();\r\n  const [{ specimen, mapType }] = useSpecimen();\r\n  const [renderer] = getRenderer(mapType);\r\n  const [selection, setSelection] = useState<RendererSelectEvent | undefined>(\r\n    undefined\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <Fade in={some(values(loading))}>\r\n        <LinearProgress variant=\"indeterminate\" sx={{ mb: -0.5, zIndex: 1 }} />\r\n      </Fade>\r\n      <Flex {...props}>\r\n        {specimen ? (\r\n          <Flex>\r\n            <AutoSize>\r\n              {(size) =>\r\n                createElement(renderer, {\r\n                  ...size,\r\n                  onSelect: setSelection,\r\n                  selection: selection?.world,\r\n                })\r\n              }\r\n            </AutoSize>\r\n            <EventListInspector\r\n              position=\"absolute\"\r\n              right={0}\r\n              height=\"100%\"\r\n              maxWidth={480}\r\n              minWidth=\"30vw\"\r\n            />\r\n          </Flex>\r\n        ) : (\r\n          <Flex\r\n            justifyContent=\"center\"\r\n            alignItems=\"center\"\r\n            color=\"text.secondary\"\r\n          >\r\n            Select a map and an algorithm to get started.\r\n          </Flex>\r\n        )}\r\n      </Flex>\r\n      <SelectionMenu\r\n        selection={selection}\r\n        onClose={() => setSelection(undefined)}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { AppBar, Toolbar, Typography } from \"@material-ui/core\";\r\n\r\nexport function Title() {\r\n  return (\r\n    <AppBar position=\"static\" elevation={0}>\r\n      <Toolbar>\r\n        <Typography variant=\"h6\">Path Search Visualiser</Typography>\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n","import { Controls } from \"components/control-bar/Controls\";\r\nimport { Flex } from \"components/generic/Flex\";\r\nimport { SpecimenInspector } from \"components/specimen-inspector/SpecimenInspector\";\r\nimport { Title } from \"components/Title\";\r\n\r\nfunction App() {\r\n  return (\r\n    <Flex vertical>\r\n      <Flex vertical boxShadow={4} height=\"auto\" zIndex={1}>\r\n        <Title />\r\n        <Controls />\r\n      </Flex>\r\n      <SpecimenInspector flex={1} />\r\n    </Flex>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import { CssBaseline, ThemeProvider } from \"@material-ui/core\";\r\nimport { theme } from \"client/theme\";\r\nimport { SnackbarProvider } from \"components/generic/Snackbar\";\r\nimport { StrictMode } from \"react\";\r\nimport { render } from \"react-dom\";\r\nimport { ConnectionStateService } from \"services/ConnectionStateService\";\r\nimport { PlaybackService } from \"services/PlaybackService\";\r\nimport { SpecimenService } from \"services/SpecimenService\";\r\nimport { FeaturesProvider } from \"slices/features\";\r\nimport { InfoProvider } from \"slices/info\";\r\nimport { LoadingProvider } from \"slices/loading\";\r\nimport { SliceProvider as AppStateProvider } from \"slices/SliceProvider\";\r\nimport { SpecimenProvider } from \"slices/specimen\";\r\nimport { UIStateProvider } from \"slices/UIState\";\r\nimport App from \"./App\";\r\nimport \"./index.css\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\n\r\nconst slices = [\r\n  InfoProvider,\r\n  FeaturesProvider,\r\n  UIStateProvider,\r\n  SpecimenProvider,\r\n  LoadingProvider,\r\n];\r\n\r\nconst services = [ConnectionStateService, PlaybackService, SpecimenService];\r\n\r\nrender(\r\n  <StrictMode>\r\n    <CssBaseline>\r\n      <ThemeProvider theme={theme}>\r\n        <SnackbarProvider>\r\n          <AppStateProvider slices={slices} services={services}>\r\n            <App />\r\n          </AppStateProvider>\r\n        </SnackbarProvider>\r\n      </ThemeProvider>\r\n    </CssBaseline>\r\n  </StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","import { useSnackbar } from \"components/generic/Snackbar\";\r\nimport { useEffect } from \"react\";\r\nimport { useInfo } from \"slices/info\";\r\n\r\nexport function ConnectionStateService() {\r\n  const notify = useSnackbar();\r\n  const [info] = useInfo();\r\n\r\n  useEffect(\r\n    () =>\r\n      notify(\r\n        info\r\n          ? `Connected: ${info.name} ${info.version}`\r\n          : \"Connecting to the solver...\"\r\n      ),\r\n    [notify, info]\r\n  );\r\n\r\n  return <></>;\r\n}\r\n","import {\r\n  SnackbarLabel as Label,\r\n  useSnackbar,\r\n} from \"components/generic/Snackbar\";\r\nimport { usePlaybackState } from \"hooks/usePlaybackState\";\r\nimport { trimEnd } from \"lodash\";\r\nimport { ReactNode, useCallback, useEffect } from \"react\";\r\nimport { useBreakpoints } from \"../hooks/useBreakpoints\";\r\n\r\nfunction cancellable<T = void>(f: () => Promise<T>, g: (result: T) => void) {\r\n  let cancelled = false;\r\n  requestAnimationFrame(async () => {\r\n    const result = await f();\r\n    if (!cancelled) g(result);\r\n  });\r\n  return () => {\r\n    cancelled = true;\r\n  };\r\n}\r\n\r\nexport function PlaybackService() {\r\n  const notify = useSnackbar();\r\n  const { playing, end, step, pause, tick } = usePlaybackState();\r\n  const shouldBreak = useBreakpoints();\r\n\r\n  const renderLabel = useCallback(\r\n    (label: ReactNode) => <Label primary={label} secondary={`Step ${step}`} />,\r\n    [step]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (playing) {\r\n      return step < end\r\n        ? cancellable(\r\n            () => shouldBreak(step),\r\n            ({ result, error }) => {\r\n              if (!error) {\r\n                if (result) {\r\n                  notify(renderLabel(`Breakpoint hit: ${result}.`));\r\n                  pause();\r\n                } else tick();\r\n              } else {\r\n                notify(renderLabel(`${trimEnd(error, \".\")}.`));\r\n                pause();\r\n              }\r\n            }\r\n          )\r\n        : pause();\r\n    }\r\n  }, [renderLabel, playing, end, step, pause, tick, notify, shouldBreak]);\r\n\r\n  return <></>;\r\n}\r\n","import { call } from \"components/script-editor/call\";\r\nimport { transpile } from \"components/script-editor/transpile\";\r\nimport { get, lowerCase as lower, memoize, startCase } from \"lodash\";\r\nimport { useMemo } from \"react\";\r\nimport { useSpecimen } from \"slices/specimen\";\r\nimport { useUIState } from \"slices/UIState\";\r\n\r\nconst EVAL = true;\r\n\r\nexport function useBreakpoints() {\r\n  const [{ specimen }] = useSpecimen();\r\n  const [{ code, breakpoints = [], monotonicF, monotonicG }] = useUIState();\r\n  const es5 = useMemo(() => transpile(code), [code]) ?? \"\";\r\n\r\n  return useMemo(\r\n    () =>\r\n      memoize(async (step: number) => {\r\n        const event = specimen?.eventList?.[step];\r\n        if (event) {\r\n          try {\r\n            // Check monotonic f or g values\r\n            // TODO Fix definition of a monotonic f or g value\r\n            if (step) {\r\n              for (const p of [monotonicF && \"f\", monotonicG && \"g\"]) {\r\n                const prev = specimen?.eventList?.[step - 1];\r\n                if (p && get(prev, p) > get(event, p)) {\r\n                  return { result: `Monotonicity violation on ${p}` };\r\n                }\r\n              }\r\n            }\r\n            // Check breakpoints in the breakpoints section\r\n            for (const {\r\n              active,\r\n              condition,\r\n              type,\r\n              property = \"\",\r\n              reference = 0,\r\n            } of breakpoints) {\r\n              const isType = !type || type === event.type;\r\n              const match = condition?.apply?.(get(event, property), reference);\r\n              if (active && isType && match) {\r\n                return {\r\n                  result: `${property} ${lower(\r\n                    startCase(condition?.key)\r\n                  )} ${reference}`,\r\n                };\r\n              }\r\n            }\r\n            // Check breakpoints in the script editor section\r\n            if (await call(es5, \"shouldBreak\", [step, event], false, EVAL)) {\r\n              return { result: `Script editor` };\r\n            }\r\n          } catch (e) {\r\n            return { error: `${e}` };\r\n          }\r\n        }\r\n        return { result: \"\" };\r\n      }),\r\n    [es5, specimen, breakpoints, monotonicF, monotonicG]\r\n  );\r\n}\r\n"],"sourceRoot":""}